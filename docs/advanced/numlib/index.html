<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ikelaiah.github.io/free-pascal-cookbook/docs/advanced/numlib/">
      
      
        <link rel="prev" href="../numlib-summary/">
      
      
        <link rel="next" href="../conditional-compilation/">
      
      
      <link rel="icon" href="../../../assets/logo-new-rounded-min.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Numerical - NumLib | Examples - Free Pascal Cookbook</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#numerical-with-numlib-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Free Pascal Cookbook" class="md-header__button md-logo" aria-label="Free Pascal Cookbook" data-md-component="logo">
      
  <img src="../../../assets/logo-new-rounded-min.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Free Pascal Cookbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Numerical - NumLib | Examples
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="orange" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="orange" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../basics/intro-objpas-fpc/" class="md-tabs__link">
          
  
  
  Basics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../core-tasks/overview/" class="md-tabs__link">
          
  
  
  Core Tasks

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  
  Advanced Topics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../external-systems/overview/" class="md-tabs__link">
          
  
  
  External Systems

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../community/" class="md-tabs__link">
        
  
  
    
  
  Community

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../resources/docs-sites/" class="md-tabs__link">
          
  
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Free Pascal Cookbook" class="md-nav__button md-logo" aria-label="Free Pascal Cookbook" data-md-component="logo">
      
  <img src="../../../assets/logo-new-rounded-min.png" alt="logo">

    </a>
    Free Pascal Cookbook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1">
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/intro-objpas-fpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to Free Pascal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/common-data-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup FPC &amp; Lazarus IDE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/basic-hello-world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running a 'Hello, World!'
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Core Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/lazarus-ide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lazarus IDE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/code-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/cmd-line-params/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Line Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/funcs-procs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions &amp; Procedures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/immutability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Immutability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/loops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loops
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/arrays/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arrays
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/lists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/strings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/numbers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numbers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/dates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dates &amp; Times
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/regex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regular Expressions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/dir-path-filename/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Directories, Paths and Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/exception-try-blocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/file-handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Handling I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/file-handling-ii/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Handling II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core-tasks/zip-and-unzip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zip and Unzip
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Advanced Topics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lmath/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Math with LMath
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../numlib-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numerical - NumLib | Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Numerical - NumLib | Examples
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Numerical - NumLib | Examples
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#unit-omv-operations-with-matrices-and-vectors" class="md-nav__link">
    <span class="md-ellipsis">
      Unit omv - Operations with Matrices and Vectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit omv - Operations with Matrices and Vectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inner-product-of-two-vectors" class="md-nav__link">
    <span class="md-ellipsis">
      Inner Product of Two Vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#product-of-a-matrix-with-a-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Product of a Matrix with a Vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Transpose Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norm-of-vectors-and-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Norm of Vectors and Matrices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#determinant-of-a-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Determinant of a Matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inverse-of-a-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Inverse of a Matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inverse of a Matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-numlib-to-find-the-inverse" class="md-nav__link">
    <span class="md-ellipsis">
      Using NumLib to Find the Inverse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-sle-solving-systems-of-linear-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Unit sle - Solving Systems of Linear Equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit sle - Solving Systems of Linear Equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#square-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Square Matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#band-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Band Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric-positive-definite-band-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric Positive Definite Band Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tridiagonal-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Tridiagonal Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overdetermined-systems-least-squares" class="md-nav__link">
    <span class="md-ellipsis">
      Overdetermined Systems (Least Squares)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overdetermined Systems (Least Squares)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-calculate-the-sum-of-squared-residuals-and-why-modify-the-solution-to-increase-the-sum-of-squared-residuals" class="md-nav__link">
    <span class="md-ellipsis">
      Why Calculate the Sum of Squared Residuals and Why Modify the Solution to Increase the Sum of Squared Residuals?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-eig-eigenvalues-and-eigenvectors" class="md-nav__link">
    <span class="md-ellipsis">
      Unit eig - Eigenvalues and eigenvectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit eig - Eigenvalues and eigenvectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matrices-with-general-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Matrices with General Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric-band-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric Band Matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric-tridiagonal-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric Tridiagonal Matrices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-roo-finding-the-roots-of-a-function" class="md-nav__link">
    <span class="md-ellipsis">
      Unit roo - Finding the roots of a function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit roo - Finding the roots of a function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#roots-of-a-polynomial" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of a Polynomial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roots-of-a-quadratic-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of a Quadratic Equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roots-of-the-binomial-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of the Binomial Equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bisection-method" class="md-nav__link">
    <span class="md-ellipsis">
      Bisection Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roots-of-a-system-of-nonlinear-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of a System of Nonlinear Equations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-int-numerical-integration-of-a-function" class="md-nav__link">
    <span class="md-ellipsis">
      Unit int - Numerical integration of a function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-ode-ordinary-differential-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Unit ode - Ordinary differential equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit ode - Ordinary differential equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solving-a-single-first-order-differential-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Solving a Single First-Order Differential Equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solving-a-system-of-first-order-differential-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Solving a System of First-Order Differential Equations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-ipf-interpolation-and-fitting" class="md-nav__link">
    <span class="md-ellipsis">
      Unit ipf - Interpolation and fitting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit ipf - Interpolation and fitting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fitting-with-a-polynomial" class="md-nav__link">
    <span class="md-ellipsis">
      Fitting with a Polynomial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interpolation-with-a-natural-cubic-spline" class="md-nav__link">
    <span class="md-ellipsis">
      Interpolation with a Natural Cubic Spline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-spe-special-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Unit spe - Special functions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conditional-compilation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conditional Compilation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Debugging with Lazarus IDE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../find-heap-memory-leaks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Find Heap Memory Leaks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-threading-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-threading - Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-threading-tthread-i-intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TThread - Pt 1. Intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-threading-tthread-ii-cs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TThread - Pt 2. Critical Section
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-threading-tthread-iii-snippets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TThread - Pt 3. Snippets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ezthreads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using ezthreads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fpc-switches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FPC Switches
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    External Systems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            External Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external-systems/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external-systems/parsing-json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parsing JSON
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external-systems/webserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Server
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7">
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/docs-sites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documents &amp; Sites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/fpc-laz-packages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FPC &amp; Lazarus Packages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/videos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Videos
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#unit-omv-operations-with-matrices-and-vectors" class="md-nav__link">
    <span class="md-ellipsis">
      Unit omv - Operations with Matrices and Vectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit omv - Operations with Matrices and Vectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inner-product-of-two-vectors" class="md-nav__link">
    <span class="md-ellipsis">
      Inner Product of Two Vectors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#product-of-a-matrix-with-a-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Product of a Matrix with a Vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transpose-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Transpose Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norm-of-vectors-and-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Norm of Vectors and Matrices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#determinant-of-a-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Determinant of a Matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inverse-of-a-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Inverse of a Matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inverse of a Matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-numlib-to-find-the-inverse" class="md-nav__link">
    <span class="md-ellipsis">
      Using NumLib to Find the Inverse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-sle-solving-systems-of-linear-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Unit sle - Solving Systems of Linear Equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit sle - Solving Systems of Linear Equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#square-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Square Matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#band-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Band Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric-positive-definite-band-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric Positive Definite Band Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tridiagonal-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Tridiagonal Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overdetermined-systems-least-squares" class="md-nav__link">
    <span class="md-ellipsis">
      Overdetermined Systems (Least Squares)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overdetermined Systems (Least Squares)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-calculate-the-sum-of-squared-residuals-and-why-modify-the-solution-to-increase-the-sum-of-squared-residuals" class="md-nav__link">
    <span class="md-ellipsis">
      Why Calculate the Sum of Squared Residuals and Why Modify the Solution to Increase the Sum of Squared Residuals?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-eig-eigenvalues-and-eigenvectors" class="md-nav__link">
    <span class="md-ellipsis">
      Unit eig - Eigenvalues and eigenvectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit eig - Eigenvalues and eigenvectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matrices-with-general-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Matrices with General Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric-band-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric Band Matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric-tridiagonal-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric Tridiagonal Matrices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-roo-finding-the-roots-of-a-function" class="md-nav__link">
    <span class="md-ellipsis">
      Unit roo - Finding the roots of a function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit roo - Finding the roots of a function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#roots-of-a-polynomial" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of a Polynomial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roots-of-a-quadratic-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of a Quadratic Equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roots-of-the-binomial-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of the Binomial Equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bisection-method" class="md-nav__link">
    <span class="md-ellipsis">
      Bisection Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roots-of-a-system-of-nonlinear-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Roots of a System of Nonlinear Equations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-int-numerical-integration-of-a-function" class="md-nav__link">
    <span class="md-ellipsis">
      Unit int - Numerical integration of a function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-ode-ordinary-differential-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Unit ode - Ordinary differential equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit ode - Ordinary differential equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solving-a-single-first-order-differential-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Solving a Single First-Order Differential Equation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solving-a-system-of-first-order-differential-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Solving a System of First-Order Differential Equations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-ipf-interpolation-and-fitting" class="md-nav__link">
    <span class="md-ellipsis">
      Unit ipf - Interpolation and fitting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unit ipf - Interpolation and fitting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fitting-with-a-polynomial" class="md-nav__link">
    <span class="md-ellipsis">
      Fitting with a Polynomial
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interpolation-with-a-natural-cubic-spline" class="md-nav__link">
    <span class="md-ellipsis">
      Interpolation with a Natural Cubic Spline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unit-spe-special-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Unit spe - Special functions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="numerical-with-numlib-examples">Numerical with NumLib | Examples<a class="headerlink" href="#numerical-with-numlib-examples" title="Permanent link">¶</a></h1>
<p>The notes and examples on this page are based on the <a href="https://wiki.freepascal.org/NumLib_Documentation">Free Pascal NumLib official doc</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Credits</p>
<p>Thanks to Kees van Ginneken, Wil Kortsmit and Loek van Reij of the Computational centre of the Eindhoven University of Technology for making it available for the Free Pascal project.</p>
<p>Thanks to Marco van de Voort (<a href="mailto:marco@freepascal.org">marco@freepascal.org</a>) and Michael van Canneyt (<a href="mailto:michael@freepascal.org">michael@freepascal.org</a>) for porting to FPC and documenting NumLib.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code snippets are not exactly the same as the ones in the <a href="https://wiki.freepascal.org/NumLib_Documentation">Free Pascal NumLib official doc</a>. I modified them for my learning.</p>
</div>
<p><strong>Routines in NumLib</strong></p>
<ul>
<li>Basic operations with matrices and vectors - unit <code>omv</code></li>
<li>Calculation of determinants - unit <code>det</code></li>
<li>Matrix inversion - unit <code>inv</code></li>
<li>Solution of systems of linear equations - unit <code>sle</code></li>
<li>Calculation of eigenvalues - unit <code>eig</code></li>
<li>Finding roots of equations - unit <code>roo</code></li>
<li>Calculates integrals - unit <code>int</code></li>
<li>Oridnary differential equations - unit <code>ode</code></li>
<li>Fitting routines - unit <code>ipf</code></li>
<li>Calculation of special functions - unit <code>spe</code></li>
</ul>
<h2 id="unit-omv-operations-with-matrices-and-vectors">Unit <code>omv</code> - Operations with Matrices and Vectors<a class="headerlink" href="#unit-omv-operations-with-matrices-and-vectors" title="Permanent link">¶</a></h2>
<h3 id="inner-product-of-two-vectors">Inner Product of Two Vectors<a class="headerlink" href="#inner-product-of-two-vectors" title="Permanent link">¶</a></h3>
<div class="arithmatex">\[
\mathbf{a} \cdot \mathbf{b} = \sum_{i=1}^n a_i b_i = a_1 b_1 + a_2 b_2 + \dots + a_n b_n
\]</div>
<p>NumLib provides the function <code>omvinp</code> for calculation of the inner product:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvinp</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>a</code> and <code>b</code> are the first elements of 1-dimensional arrays representing the vectors <span class="arithmatex">\(a\)</span> and <span class="arithmatex">\(b\)</span>, respectively.</li>
<li><code>n</code> defines the dimension of the vectors (count of array elements). Both vectors must have the same number of elements.</li>
</ul>
<p><strong>Example</strong></p>
<p>Calculate the dot product of these vectors.</p>
<div class="arithmatex">\[
a = \begin{pmatrix} 0 \\ 1  \\ 2  \\ 2 \\ -1 \end{pmatrix}, \quad
b = \begin{pmatrix} 3 \\ -1 \\ -2 \\ 2 \\ -1 \end{pmatrix}
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">program</span><span class="w"> </span><span class="n">omvinp_demo</span><span class="o">;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="k">uses</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">  </span><span class="cm">{$IFDEF UNIX}</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">  </span><span class="n">cthreads</span><span class="o">,</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">  </span><span class="cm">{$ENDIF}</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">  </span><span class="n">Classes</span><span class="o">,</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">  </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="k">var</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">  </span><span class="n">vector_a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">  </span><span class="n">vector_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Arbfloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">  </span><span class="n">product_ab</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="k">begin</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="w">  </span><span class="c1">// Perform dot product</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="hll"><span class="w">  </span><span class="n">product_ab</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">omvinp</span><span class="p">(</span><span class="n">vector_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vector_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="nb">high</span><span class="p">(</span><span class="n">vector_a</span><span class="p">))</span><span class="o">;</span>
</span></span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="w">  </span><span class="c1">// Print vector vector_a</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Vector a = ['</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">vector_a</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">vector_a</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">vector_a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  ]'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29"></a>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="w">  </span><span class="c1">// Print vector vector_b</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Vector b = ['</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">vector_b</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">vector_b</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">vector_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  ]'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35"></a>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="w">  </span><span class="c1">// Print vector_a . b</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Dot product a . b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">product_ab</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39"></a>
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter key to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="product-of-a-matrix-with-a-vector">Product of a Matrix with a Vector<a class="headerlink" href="#product-of-a-matrix-with-a-vector" title="Permanent link">¶</a></h3>
<p><strong>Example</strong></p>
<p>Calculate the product of the following.</p>
<div class="arithmatex">\[
\displaystyle{ \begin{align*}
  \mathbf{c} = A\ \mathbf{b}=
  \left[
    \begin{array}{cccc}
      3 &amp; 5 &amp; 4 &amp; 1 &amp; -4\\
      -2 &amp; 3 &amp; 4 &amp; 1 &amp; 0\\
      0 &amp; 1 &amp; -1 &amp; -2 &amp; 5
    \end{array}
  \right]
  \ \ 
  \left[
    \begin{array}{c}
      3\\
      0\\
      -1\\
      -2\\
      1
    \end{array}
  \right]
\end{align*} }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span>
<span class="normal"><a href="#__codelineno-2-38">38</a></span>
<span class="normal"><a href="#__codelineno-2-39">39</a></span>
<span class="normal"><a href="#__codelineno-2-40">40</a></span>
<span class="normal"><a href="#__codelineno-2-41">41</a></span>
<span class="normal"><a href="#__codelineno-2-42">42</a></span>
<span class="normal"><a href="#__codelineno-2-43">43</a></span>
<span class="normal"><a href="#__codelineno-2-44">44</a></span>
<span class="normal"><a href="#__codelineno-2-45">45</a></span>
<span class="normal"><a href="#__codelineno-2-46">46</a></span>
<span class="normal"><a href="#__codelineno-2-47">47</a></span>
<span class="normal"><a href="#__codelineno-2-48">48</a></span>
<span class="normal"><a href="#__codelineno-2-49">49</a></span>
<span class="normal"><a href="#__codelineno-2-50">50</a></span>
<span class="normal"><a href="#__codelineno-2-51">51</a></span>
<span class="normal"><a href="#__codelineno-2-52">52</a></span>
<span class="normal"><a href="#__codelineno-2-53">53</a></span>
<span class="normal"><a href="#__codelineno-2-54">54</a></span>
<span class="normal"><a href="#__codelineno-2-55">55</a></span>
<span class="normal"><a href="#__codelineno-2-56">56</a></span>
<span class="normal"><a href="#__codelineno-2-57">57</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">program</span><span class="w"> </span><span class="n">omvmmv_demo</span><span class="o">;</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="k">uses</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">  </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="k">var</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">  </span><span class="n">matrix_A</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">    </span><span class="p">(</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">    </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">    </span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">  </span><span class="n">vector_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">  </span><span class="n">vector_c</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">  </span><span class="n">m_row</span><span class="o">,</span><span class="w"> </span><span class="n">n_column</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="k">begin</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">  </span><span class="n">m_row</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">  </span><span class="n">n_column</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22"></a>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">  </span><span class="c1">// Calculate product vector_c = matrix_A vector_b</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="hll"><span class="w">  </span><span class="n">omvmmv</span><span class="p">(</span>
</span></span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="hll"><span class="w">    </span><span class="n">matrix_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row</span><span class="o">,</span><span class="w"> </span><span class="n">n_column</span><span class="o">,</span><span class="w"> </span><span class="n">n_column</span><span class="o">,</span>
</span></span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="hll"><span class="w">    </span><span class="n">vector_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span>
</span></span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27"></a><span class="hll"><span class="w">    </span><span class="n">vector_c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="hll"><span class="w">    </span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29"></a>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="w">  </span><span class="c1">// Print matrix_A</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_column</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39"></a>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">  </span><span class="c1">// Print vector vector_b</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_column</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">vector_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46"></a>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47"></a><span class="w">  </span><span class="c1">// Print result vector vector_c</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'c = A b'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'c = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">vector_c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53"></a>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54"></a><span class="w">  </span><span class="c1">// Pause console</span>
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter key to exit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="transpose-matrix">Transpose Matrix<a class="headerlink" href="#transpose-matrix" title="Permanent link">¶</a></h3>
<p>The transpose matrix <span class="arithmatex">\(A^{T}\)</span> of matrix <span class="arithmatex">\(A\)</span> is obtained by flipping rows and columns:</p>
<div class="arithmatex">\[
\displaystyle{ \begin{align*}
  {A} = \left[
    \begin{array}{cccc}
      a_{11} &amp; a_{12} &amp; a_{13} &amp; \ldots &amp; a_{1n}\\
      a_{21} &amp; a_{22} &amp; a_{23} &amp; \ldots &amp; a_{2n}\\
      \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
      a_{m1} &amp; a_{m2} &amp; a_{m3} &amp; \ldots &amp; a_{mn}
    \end{array}
  \right]
  \ \ \
  {A^T} = 
  \left[
    \begin{array}{cccc}
      a_{11} &amp; a_{21} &amp; \ldots &amp; a_{m1}\\
      a_{12} &amp; a_{22} &amp; \ldots &amp; a_{m2}\\
      a_{13} &amp; a_{23} &amp; \ldots &amp; a_{m3} \\
      \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
      a_{1n} &amp; a_{2n} &amp; \ldots &amp; a{mn}
    \end{array}
  \right]
\end{align*} }
\]</div>
<p>Use the procedure omvtrm to perform this operation with NumLib:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">omvtrm</span><span class="p">(</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwa</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">c</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">rwc</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>a</code> is the first element of the input matrix <span class="arithmatex">\(A\)</span>. The elements of this array <strong>are not</strong> changed by the procedure.</li>
<li><code>m</code> is the number of rows of matrix <span class="arithmatex">\(A\)</span>.</li>
<li><code>n</code> is the number of columns of matrix <span class="arithmatex">\(A\)</span>.</li>
<li><code>rwa</code> is the number of allocated columns of <span class="arithmatex">\(A\)</span>. This way the array of <span class="arithmatex">\(A\)</span> can be larger than acutally needed.</li>
<li><code>c</code> is the first element of the transposed matrix <span class="arithmatex">\(A^{T}\)</span>. It has <span class="arithmatex">\(n\)</span> rows and <span class="arithmatex">\(m\)</span> columns.</li>
<li><code>rwc</code> is the number of allocated columns for the transposed matrix.</li>
</ul>
<p><strong>Example</strong></p>
<p>Transpose the following 2 x 4 matrix.</p>
<div class="arithmatex">\[
\displaystyle{ {A} = \left[
    \begin{array}{cccc}
      1  &amp; 2  &amp; 3  &amp; 4 \\
      11 &amp; 22 &amp; 33 &amp; 44
    \end{array}
  \right]
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span>
<span class="normal"><a href="#__codelineno-4-46">46</a></span>
<span class="normal"><a href="#__codelineno-4-47">47</a></span>
<span class="normal"><a href="#__codelineno-4-48">48</a></span>
<span class="normal"><a href="#__codelineno-4-49">49</a></span>
<span class="normal"><a href="#__codelineno-4-50">50</a></span>
<span class="normal"><a href="#__codelineno-4-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">program</span><span class="w"> </span><span class="n">omvtrm_demo</span><span class="o">;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="k">uses</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">  </span><span class="cm">{$IFDEF UNIX}</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">  </span><span class="n">cthreads</span><span class="o">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">  </span><span class="cm">{$ENDIF}</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">  </span><span class="n">Classes</span><span class="o">,</span><span class="w"> </span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">  </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="k">var</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">  </span><span class="n">matrix_A</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w">  </span><span class="mi">2</span><span class="o">,</span><span class="w">  </span><span class="mi">3</span><span class="o">,</span><span class="w">  </span><span class="mi">4</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">    </span><span class="p">(</span><span class="mi">11</span><span class="o">,</span><span class="w"> </span><span class="mi">22</span><span class="o">,</span><span class="w"> </span><span class="mi">33</span><span class="o">,</span><span class="w"> </span><span class="mi">44</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">  </span><span class="n">transposed_A</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">  </span><span class="n">m_row_matrix_A</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix_A</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="k">begin</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">  </span><span class="n">m_row_matrix_A</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">  </span><span class="n">n_col_matrix_A</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">  </span><span class="c1">// Transpose matrix_A</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="hll"><span class="w">  </span><span class="n">omvtrm</span><span class="p">(</span>
</span></span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="hll"><span class="w">    </span><span class="n">matrix_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row_matrix_A</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix_A</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix_A</span><span class="o">,</span>
</span></span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="hll"><span class="w">    </span><span class="n">transposed_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row_matrix_A</span>
</span></span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="hll"><span class="w">  </span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30"></a>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="w">  </span><span class="c1">// Print matrix_A</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row_matrix_A</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col_matrix_A</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">matrix_A</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">8</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39"></a>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40"></a><span class="w">  </span><span class="c1">// Print transposed_A</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Aᵀ = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col_matrix_A</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row_matrix_A</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">transposed_A</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">8</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47"></a>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter key to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="norm-of-vectors-and-matrices">Norm of Vectors and Matrices<a class="headerlink" href="#norm-of-vectors-and-matrices" title="Permanent link">¶</a></h3>
<p>A norm assigns a positive "length" to a vector or matrix.</p>
<p>For vectors, <code>NumLib</code> supports these norms:</p>
<ul>
<li>The 1-norm is the sum of the absolute values of vector components, also known as the "Taxicab" or "Manhattan" norm because it represents the distance a taxi drives in a grid.</li>
</ul>
<div class="arithmatex">\[
\displaystyle{ \|a\|_1 = \sum_{i=1}^n |{a_i}| }
\]</div>
<ul>
<li>The 2-norm (Euclidean norm) is the distance from point a to the origin.</li>
</ul>
<div class="arithmatex">\[
\displaystyle{ \|a\|_2 = \sqrt{\sum_{i=1}^n {a_i}^2}  }
\]</div>
<ul>
<li>The infinity norm is the largest absolute value of the vector components.</li>
</ul>
<div class="arithmatex">\[
\displaystyle{ \|a\|_\infty = \max({a_1}, {a_2}, ... {a_n}) }
\]</div>
<p>For matrices, <code>NumLib</code> defines norms based on rows or columns:</p>
<ul>
<li>The 1-norm is the largest absolute column sum.</li>
</ul>
<div class="arithmatex">\[
\displaystyle{ \|M\|_1 = \max_{1 \le j \le {n}} \sum_{i=1}^m|M_{ij}| }
\]</div>
<ul>
<li>The infinity norm is the largest absolute row sum.</li>
</ul>
<div class="arithmatex">\[
\displaystyle{ \|M\|_\infty = \max_{1 \le i \le\ m} \sum_{j=1}^n |M_{ij}|  }
\]</div>
<ul>
<li>The Frobenius norm sums the squares of all matrix elements, similar to the vector 2-norm.</li>
</ul>
<div class="arithmatex">\[
\displaystyle{ \|M\|_F = \sqrt{\sum_{i=1}^m \sum_{j=1}^n {M_{ij}}^2}  }
\]</div>
<p>These are the NumLib routines for calculating norms:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvn1v</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">               </span><span class="c1">// 1-norm of a vector</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvn1m</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">    </span><span class="c1">// 1-norm of a matrix</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvn2v</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">               </span><span class="c1">// 2-norm of a vector</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvnfm</span><span class="p">(</span><span class="k">Var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">    </span><span class="c1">// Frobenius norm of a matrix</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvnmv</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">               </span><span class="c1">// Maximum infinite norm of a vector</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="k">function</span><span class="w"> </span><span class="nf">omvnmm</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">    </span><span class="c1">// Maximum infinite norm of a matrix</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>a</code>: First element of the vector or matrix for norm calculation.</li>
<li><code>m</code>: Number of rows (for matrix norms).</li>
<li><code>n</code>: Number of elements (for vector norms) or columns (for matrix norms).</li>
<li><code>rwidth</code>: Allocated column count, allowing for a larger matrix than required.</li>
</ul>
<p><strong>Example</strong></p>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span>
<span class="normal"><a href="#__codelineno-6-29">29</a></span>
<span class="normal"><a href="#__codelineno-6-30">30</a></span>
<span class="normal"><a href="#__codelineno-6-31">31</a></span>
<span class="normal"><a href="#__codelineno-6-32">32</a></span>
<span class="normal"><a href="#__codelineno-6-33">33</a></span>
<span class="normal"><a href="#__codelineno-6-34">34</a></span>
<span class="normal"><a href="#__codelineno-6-35">35</a></span>
<span class="normal"><a href="#__codelineno-6-36">36</a></span>
<span class="normal"><a href="#__codelineno-6-37">37</a></span>
<span class="normal"><a href="#__codelineno-6-38">38</a></span>
<span class="normal"><a href="#__codelineno-6-39">39</a></span>
<span class="normal"><a href="#__codelineno-6-40">40</a></span>
<span class="normal"><a href="#__codelineno-6-41">41</a></span>
<span class="normal"><a href="#__codelineno-6-42">42</a></span>
<span class="normal"><a href="#__codelineno-6-43">43</a></span>
<span class="normal"><a href="#__codelineno-6-44">44</a></span>
<span class="normal"><a href="#__codelineno-6-45">45</a></span>
<span class="normal"><a href="#__codelineno-6-46">46</a></span>
<span class="normal"><a href="#__codelineno-6-47">47</a></span>
<span class="normal"><a href="#__codelineno-6-48">48</a></span>
<span class="normal"><a href="#__codelineno-6-49">49</a></span>
<span class="normal"><a href="#__codelineno-6-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">program</span><span class="w"> </span><span class="n">omv_norm_demo</span><span class="o">;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="k">uses</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">  </span><span class="cm">{$IFDEF UNIX}</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">  </span><span class="n">cthreads</span><span class="o">,</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">  </span><span class="cm">{$ENDIF}</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">  </span><span class="n">Classes</span><span class="o">,</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">  </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="k">var</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">  </span><span class="n">vector_a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">  </span><span class="n">matrix_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">..</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Arbfloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">                                             </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">                                             </span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">                                             </span><span class="p">(</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">  </span><span class="n">n_vec</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">m_row_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20"></a>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="k">begin</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="w">  </span><span class="c1">// Get length of vector and the size of the matrix</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="w">  </span><span class="n">n_vec</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">vector_a</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">vector_a</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">  </span><span class="n">m_row_matrix</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="w">  </span><span class="n">n_col_matrix</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26"></a>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Vector a = ['</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">Low</span><span class="p">(</span><span class="n">vector_a</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">High</span><span class="p">(</span><span class="n">vector_a</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">vector_a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  ]'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="hll"><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'        1-norm of vector a: '</span><span class="o">,</span><span class="w"> </span><span class="n">omvn1v</span><span class="p">(</span><span class="n">vector_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_vec</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="hll"><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'        2-norm of vector a: '</span><span class="o">,</span><span class="w"> </span><span class="n">omvn2v</span><span class="p">(</span><span class="n">vector_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_vec</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33"></a><span class="hll"><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  maximum norm of vector a: '</span><span class="o">,</span><span class="w"> </span><span class="n">omvnmv</span><span class="p">(</span><span class="n">vector_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_vec</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35"></a>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row_matrix</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43"></a><span class="hll"><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'        1-norm of matrix b: '</span><span class="o">,</span><span class="w"> </span><span class="n">omvn1m</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">[</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44"></a><span class="hll"><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Forbenius norm of matrix b: '</span><span class="o">,</span><span class="w"> </span><span class="n">omvnfm</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">[</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45"></a><span class="hll"><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  maximum norm of matrix b: '</span><span class="o">,</span><span class="w"> </span><span class="n">omvnmm</span><span class="p">(</span><span class="n">matrix_b</span><span class="p">[</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="o">,</span><span class="w"> </span><span class="n">n_col_matrix</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46"></a>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter key to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h2 id="determinant-of-a-matrix">Determinant of a Matrix<a class="headerlink" href="#determinant-of-a-matrix" title="Permanent link">¶</a></h2>
<p>Coming soon.</p>
<h2 id="inverse-of-a-matrix">Inverse of a Matrix<a class="headerlink" href="#inverse-of-a-matrix" title="Permanent link">¶</a></h2>
<p>Let's say we have a square matrix <span class="arithmatex">\( A \)</span>. The matrix <span class="arithmatex">\( A^{-1} \)</span> is called the <strong>inverse</strong> of <span class="arithmatex">\( A \)</span> if, when you multiply <span class="arithmatex">\( A^{-1} \)</span> by <span class="arithmatex">\( A \)</span>, you get the <strong>identity matrix</strong> <span class="arithmatex">\( I \)</span>. The identity matrix is special because it has 1s on the diagonal (from the top left to bottom right) and 0s everywhere else.</p>
<div class="arithmatex">\[
\displaystyle{  A^{-1} A = I = 
     \begin{bmatrix}
       1  &amp;         &amp; 0 \\
          &amp; \ddots  &amp;   \\
       0  &amp;         &amp; 1
     \end{bmatrix}
 }
\]</div>
<p>The inverse of a matrix only exists if the <strong>determinant</strong> of <span class="arithmatex">\( A \)</span> is not zero. If the determinant is zero, <span class="arithmatex">\( A \)</span> doesn't have an inverse.</p>
<h3 id="using-numlib-to-find-the-inverse">Using NumLib to Find the Inverse<a class="headerlink" href="#using-numlib-to-find-the-inverse" title="Permanent link">¶</a></h3>
<p>NumLib is a tool that has several ways (called routines) to calculate the inverse of a matrix. Which method it uses depends on what kind of matrix you have. All the routines expect the matrix to be stored in a common way—as a 2D array of real numbers, or a 1D array of numbers arranged in rows and columns.</p>
<p>Here are some routines that NumLib uses:</p>
<ul>
<li><strong>invgen</strong>: This routine works for any square matrix.</li>
<li><strong>invgsy</strong>: This routine works for matrices that are <strong>symmetric</strong> (meaning the left side mirrors the right side).</li>
<li><strong>invgpd</strong>: This routine works for <strong>symmetric positive definite</strong> matrices (a special kind of symmetric matrix).</li>
</ul>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">invgen</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">ai</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">   </span><span class="c1">// generic matrix</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">invgsy</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">ai</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">   </span><span class="c1">// symmetric matrix</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">invgpd</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">ai</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">   </span><span class="c1">// symmetric positive definite matrix</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><span class="arithmatex">\( n \)</span>: The size of the matrix.</li>
<li><span class="arithmatex">\( rwidth \)</span>: The width of the rows (usually, this is the same as <span class="arithmatex">\( n \)</span>).</li>
<li><span class="arithmatex">\( ai \)</span>: The first element of the matrix (the top-left corner).</li>
<li><span class="arithmatex">\( term \)</span>: A number that tells if the calculation was successful:</li>
<li>1: Success! The inverse was found.</li>
<li>2: The inverse couldn't be found because the matrix is too close to being singular (meaning its determinant is almost zero).</li>
<li>3: There was a mistake with the input data (like if <span class="arithmatex">\( n \)</span> was less than 1). </li>
</ul>
<p><strong>Example</strong></p>
<p>Calculate the inverse of the symmetric matrix.</p>
<div class="arithmatex">\[
\displaystyle{ A = 
 \left[
 \begin{array}{rrrr}
   5 &amp; 7 &amp; 6 &amp; 5  \\
   7 &amp; 10 &amp; 8 &amp; 7 \\
   6 &amp; 8 &amp; 10 &amp; 9 \\
   5 &amp; 7 &amp; 9 &amp; 10
 \end{array}
 \right]
 }
\]</div>
<p>Note, this matrix is <strong>symmetric</strong> and <strong>positive definite</strong> (the product <span class="arithmatex">\(b^{T} A b\)</span> with any vector <span class="arithmatex">\(b = [b1, b2, b3]^{T}\)</span> cannot become zero or negative since all elements of this matrix are positive). Therefore, <code>invgpd</code> is best-suited for this task although the other routines can be used as well (uncomment their calls below).</p>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span>
<span class="normal"><a href="#__codelineno-8-30">30</a></span>
<span class="normal"><a href="#__codelineno-8-31">31</a></span>
<span class="normal"><a href="#__codelineno-8-32">32</a></span>
<span class="normal"><a href="#__codelineno-8-33">33</a></span>
<span class="normal"><a href="#__codelineno-8-34">34</a></span>
<span class="normal"><a href="#__codelineno-8-35">35</a></span>
<span class="normal"><a href="#__codelineno-8-36">36</a></span>
<span class="normal"><a href="#__codelineno-8-37">37</a></span>
<span class="normal"><a href="#__codelineno-8-38">38</a></span>
<span class="normal"><a href="#__codelineno-8-39">39</a></span>
<span class="normal"><a href="#__codelineno-8-40">40</a></span>
<span class="normal"><a href="#__codelineno-8-41">41</a></span>
<span class="normal"><a href="#__codelineno-8-42">42</a></span>
<span class="normal"><a href="#__codelineno-8-43">43</a></span>
<span class="normal"><a href="#__codelineno-8-44">44</a></span>
<span class="normal"><a href="#__codelineno-8-45">45</a></span>
<span class="normal"><a href="#__codelineno-8-46">46</a></span>
<span class="normal"><a href="#__codelineno-8-47">47</a></span>
<span class="normal"><a href="#__codelineno-8-48">48</a></span>
<span class="normal"><a href="#__codelineno-8-49">49</a></span>
<span class="normal"><a href="#__codelineno-8-50">50</a></span>
<span class="normal"><a href="#__codelineno-8-51">51</a></span>
<span class="normal"><a href="#__codelineno-8-52">52</a></span>
<span class="normal"><a href="#__codelineno-8-53">53</a></span>
<span class="normal"><a href="#__codelineno-8-54">54</a></span>
<span class="normal"><a href="#__codelineno-8-55">55</a></span>
<span class="normal"><a href="#__codelineno-8-56">56</a></span>
<span class="normal"><a href="#__codelineno-8-57">57</a></span>
<span class="normal"><a href="#__codelineno-8-58">58</a></span>
<span class="normal"><a href="#__codelineno-8-59">59</a></span>
<span class="normal"><a href="#__codelineno-8-60">60</a></span>
<span class="normal"><a href="#__codelineno-8-61">61</a></span>
<span class="normal"><a href="#__codelineno-8-62">62</a></span>
<span class="normal"><a href="#__codelineno-8-63">63</a></span>
<span class="normal"><a href="#__codelineno-8-64">64</a></span>
<span class="normal"><a href="#__codelineno-8-65">65</a></span>
<span class="normal"><a href="#__codelineno-8-66">66</a></span>
<span class="normal"><a href="#__codelineno-8-67">67</a></span>
<span class="normal"><a href="#__codelineno-8-68">68</a></span>
<span class="normal"><a href="#__codelineno-8-69">69</a></span>
<span class="normal"><a href="#__codelineno-8-70">70</a></span>
<span class="normal"><a href="#__codelineno-8-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="k">program</span><span class="w"> </span><span class="n">inverse_matrix</span><span class="o">;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="k">uses</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">inv</span><span class="o">,</span><span class="w"> </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="k">const</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">  </span><span class="n">n_mat_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">;</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">  </span><span class="n">decimals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="o">;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="k">var</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">  </span><span class="c1">// a is the input matrix to be inverted</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">  </span><span class="c1">// Note that this is matrix must be symmetric positive definite.</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">  </span><span class="n">mat_a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">    </span><span class="p">(</span><span class="mi">5</span><span class="o">,</span><span class="w">  </span><span class="mi">7</span><span class="o">,</span><span class="w">  </span><span class="mi">6</span><span class="o">,</span><span class="w">  </span><span class="mi">5</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="w">    </span><span class="p">(</span><span class="mi">7</span><span class="o">,</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w">  </span><span class="mi">8</span><span class="o">,</span><span class="w">  </span><span class="mi">7</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="w">    </span><span class="p">(</span><span class="mi">6</span><span class="o">,</span><span class="w">  </span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w">  </span><span class="mi">9</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="w">    </span><span class="p">(</span><span class="mi">5</span><span class="o">,</span><span class="w">  </span><span class="mi">7</span><span class="o">,</span><span class="w">  </span><span class="mi">9</span><span class="o">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="w">  </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="w">  </span><span class="n">mat_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Arbfloat</span><span class="o">;</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="w">  </span><span class="n">mat_c</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25"></a>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="k">begin</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="w">  </span><span class="c1">// Write input matrix</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'a = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="n">decimals</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35"></a>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36"></a><span class="w">  </span><span class="c1">// Store input matrix because it will be overwritten by the inverse of mat_a</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39"></a><span class="w">      </span><span class="n">mat_b</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mat_a</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40"></a>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41"></a><span class="hll"><span class="w">  </span><span class="c1">// Calculate inverse  -- uncomment the procedure to be used.</span>
</span></span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42"></a><span class="hll"><span class="w">  </span><span class="c1">//invgen(n_mat_size, n_mat_size, mat_a[1, 1], term);</span>
</span></span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43"></a><span class="hll"><span class="w">  </span><span class="c1">//invgsy(n_mat_size, n_mat_size, mat_a[1, 1], term);</span>
</span></span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44"></a><span class="hll"><span class="w">  </span><span class="n">invgpd</span><span class="p">(</span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">mat_a</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45"></a>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46"></a><span class="w">  </span><span class="c1">// Write inverse</span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'a^(-1) = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="n">decimals</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54"></a>
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55"></a><span class="w">  </span><span class="c1">// Check validity of result by multiplying inverse with saved input matrix</span>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56"></a><span class="w">  </span><span class="n">omvmmm</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57"></a><span class="w">         </span><span class="n">mat_b</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58"></a><span class="w">         </span><span class="n">mat_c</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59"></a>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60"></a><span class="w">  </span><span class="c1">// Write inverse</span>
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'a^(-1) x a = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_c</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="n">decimals</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67"></a>
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68"></a><span class="w">  </span><span class="c1">// Pause console</span>
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h2 id="unit-sle-solving-systems-of-linear-equations">Unit <code>sle</code> - Solving Systems of Linear Equations<a class="headerlink" href="#unit-sle-solving-systems-of-linear-equations" title="Permanent link">¶</a></h2>
<p>A system of linear equations (or linear system) is a collection of two or more linear equations involving the same set of variables, <span class="arithmatex">\(x_1 ... x_n\)</span>.</p>
<div class="arithmatex">\[
\displaystyle{  \begin{cases}
    a_{11} x_1 + a_{12} x_2 + \dots + a_{1n} x_n = b_1 \\
    a_{21} x_1 + a_{22} x_2 + \dots + a_{2n} x_n = b_n \\
    \ \ \ \vdots \\
    a_{m1} x_1 + a_{m2} x_2 + \dots + a_{mn} x_n = b_m
  \end{cases} 
 }
\]</div>
<p>In order to find a solution which satisfies all equations simultaneously the system of equations is usually converted to a matrix equation <span class="arithmatex">\(A x = b\)</span>, where</p>
<div class="arithmatex">\[
\displaystyle{  
    A = \left [ \begin{array}{ccc}
                  a_{11} &amp; a_{12} &amp; \dots  &amp; a_{1n} \\
                  a_{21} &amp; a_{22} &amp; \dots  &amp; a_{2n} \\
                  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
                  a_{m1} &amp; a_{m2} &amp; \dots  &amp; a_{mn}
                \end{array}
        \right ],
   \
   \mathbf{x} = \left [ \begin{array}{c}
                  x_1    \\
                  x_2    \\
                  \vdots \\
                  x_n
               \end{array}
       \right ],
   \
   \mathbf{b} = \left [ \begin{array}{c}
                  b_1    \\
                  b_2    \\
                  \vdots \\
                  b_m
               \end{array}
       \right ]
 }
\]</div>
<p>NumLib has several procedures to solve the matrix equation depending on the properties of the matrix.</p>
<h3 id="square-matrices">Square Matrices<a class="headerlink" href="#square-matrices" title="Permanent link">¶</a></h3>
<p>Pass the matrix to the procedures in the standard NumLib way as the first element of a 2D or 1D array. The 2D array must be dimensioned to contain at least <span class="arithmatex">\(n\)</span> rows and <span class="arithmatex">\(n\)</span> columns, the 1D array must contain at least <span class="arithmatex">\(n^2\)</span> elements.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">slegen</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">   </span><span class="c1">// generic matrix</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">slegsy</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">   </span><span class="c1">// symmetric matrix</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">slegpd</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">   </span><span class="c1">// symmetric positive definite matrix</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<p><code>slegen</code> is the General-purpose for any square matrix (Gaussian elimination with partial pivoting).</p>
<p><code>slegsy</code> is specialised for symmetric matrices (more stable reduction to tridiagonal form).</p>
<p><code>slegpd</code> is optimisedfor symmetric positive definite matrices (Cholesky decomposition).</p>
<ul>
<li><code>n</code> is the matrix size.</li>
<li><code>rwidth</code> is the number of allocated columns (must be <code>n &lt;= rwidth</code>). </li>
<li><code>a</code> is the first element of the coefficient matrix (unchanged during calculation). </li>
<li><code>b</code> is the constant vector (also unchanged).</li>
<li><code>x</code> is where the solution vector will be stored. </li>
<li><code>ca</code> indicates solution accuracy.</li>
<li><code>term</code> returns an error code:<ul>
<li><code>1</code>: Success, solution in <code>x</code>.</li>
<li><code>2</code>: Matrix is nearly singular, no solution.</li>
<li><code>3</code>: Invalid input, <code>n &lt; 1</code>.</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>Solve this system of linear equations:</p>
<div class="arithmatex">\[
\displaystyle{  \begin{cases}
    5 x_1 +  7 x_2 +  6 x_3 +  5 x_4 = 57  \\
    7 x_1 + 10 x_2 +  8 x_3 +  7 x_4 = 79  \\
    6 x_1 +  8 x_2 + 10 x_3 +  9 x_4 = 88  \\
    5 x_1 +  7 x_2 +  9 x_3 + 10 x_4 = 86
  \end{cases}
  \qquad \Rightarrow \qquad
  A=
  \left[
    \begin{array}{rrrr}
       5 &amp;  7 &amp;  6 &amp;  5    \\
       7 &amp; 10 &amp;  8 &amp;  7 \\
       6 &amp;  8 &amp; 10 &amp;  9 \\
       5 &amp;  7 &amp;  9 &amp; 10
    \end{array}
  \right]
  , \;
  \mathbf{b} =
  \left[
    \begin{array}{r}
      57 \\
      79 \\
      88 \\
      86
    \end{array}
  \right]
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span>
<span class="normal"><a href="#__codelineno-10-29">29</a></span>
<span class="normal"><a href="#__codelineno-10-30">30</a></span>
<span class="normal"><a href="#__codelineno-10-31">31</a></span>
<span class="normal"><a href="#__codelineno-10-32">32</a></span>
<span class="normal"><a href="#__codelineno-10-33">33</a></span>
<span class="normal"><a href="#__codelineno-10-34">34</a></span>
<span class="normal"><a href="#__codelineno-10-35">35</a></span>
<span class="normal"><a href="#__codelineno-10-36">36</a></span>
<span class="normal"><a href="#__codelineno-10-37">37</a></span>
<span class="normal"><a href="#__codelineno-10-38">38</a></span>
<span class="normal"><a href="#__codelineno-10-39">39</a></span>
<span class="normal"><a href="#__codelineno-10-40">40</a></span>
<span class="normal"><a href="#__codelineno-10-41">41</a></span>
<span class="normal"><a href="#__codelineno-10-42">42</a></span>
<span class="normal"><a href="#__codelineno-10-43">43</a></span>
<span class="normal"><a href="#__codelineno-10-44">44</a></span>
<span class="normal"><a href="#__codelineno-10-45">45</a></span>
<span class="normal"><a href="#__codelineno-10-46">46</a></span>
<span class="normal"><a href="#__codelineno-10-47">47</a></span>
<span class="normal"><a href="#__codelineno-10-48">48</a></span>
<span class="normal"><a href="#__codelineno-10-49">49</a></span>
<span class="normal"><a href="#__codelineno-10-50">50</a></span>
<span class="normal"><a href="#__codelineno-10-51">51</a></span>
<span class="normal"><a href="#__codelineno-10-52">52</a></span>
<span class="normal"><a href="#__codelineno-10-53">53</a></span>
<span class="normal"><a href="#__codelineno-10-54">54</a></span>
<span class="normal"><a href="#__codelineno-10-55">55</a></span>
<span class="normal"><a href="#__codelineno-10-56">56</a></span>
<span class="normal"><a href="#__codelineno-10-57">57</a></span>
<span class="normal"><a href="#__codelineno-10-58">58</a></span>
<span class="normal"><a href="#__codelineno-10-59">59</a></span>
<span class="normal"><a href="#__codelineno-10-60">60</a></span>
<span class="normal"><a href="#__codelineno-10-61">61</a></span>
<span class="normal"><a href="#__codelineno-10-62">62</a></span>
<span class="normal"><a href="#__codelineno-10-63">63</a></span>
<span class="normal"><a href="#__codelineno-10-64">64</a></span>
<span class="normal"><a href="#__codelineno-10-65">65</a></span>
<span class="normal"><a href="#__codelineno-10-66">66</a></span>
<span class="normal"><a href="#__codelineno-10-67">67</a></span>
<span class="normal"><a href="#__codelineno-10-68">68</a></span>
<span class="normal"><a href="#__codelineno-10-69">69</a></span>
<span class="normal"><a href="#__codelineno-10-70">70</a></span>
<span class="normal"><a href="#__codelineno-10-71">71</a></span>
<span class="normal"><a href="#__codelineno-10-72">72</a></span>
<span class="normal"><a href="#__codelineno-10-73">73</a></span>
<span class="normal"><a href="#__codelineno-10-74">74</a></span>
<span class="normal"><a href="#__codelineno-10-75">75</a></span>
<span class="normal"><a href="#__codelineno-10-76">76</a></span>
<span class="normal"><a href="#__codelineno-10-77">77</a></span>
<span class="normal"><a href="#__codelineno-10-78">78</a></span>
<span class="normal"><a href="#__codelineno-10-79">79</a></span>
<span class="normal"><a href="#__codelineno-10-80">80</a></span>
<span class="normal"><a href="#__codelineno-10-81">81</a></span>
<span class="normal"><a href="#__codelineno-10-82">82</a></span>
<span class="normal"><a href="#__codelineno-10-83">83</a></span>
<span class="normal"><a href="#__codelineno-10-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_linear_eq</span><span class="o">;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="cm">{</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="cm">  This is an example for solving linear equations; A x = b, using slgen in numlib.</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="cm">  5 x_1 +  7 x_2 +  6 x_3 +  5 x_4 = 57         |5  7 6 5|      |57|</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="cm">  7 x_1 + 10 x_2 +  8 x_3 +  7 x_4 = 79  =&gt; A = |7 10 8 7|, b = |79|</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="cm">  6 x_1 +  8 x_2 + 10 x_3 +  9 x_4 = 88         |6 8 10 9|      |88|</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="cm">  5 x_1 +  7 x_2 +  9 x_3 + 10 x_4 = 86         |5 7 9 10|      |86|</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="cm">  Lastly, it tests the result, x, by multiplying A x (from slgen's output) and</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="cm">  the result must be equal to b.</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="cm">  }</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="k">uses</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="w">  </span><span class="n">NumLib</span><span class="o">,</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="w">  </span><span class="n">sle</span><span class="o">,</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="w">  </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22"></a>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="k">const</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="w">  </span><span class="n">n_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">;</span><span class="w"> </span><span class="c1">// n (col) = m (row) for square matrice</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25"></a>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26"></a><span class="k">var</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27"></a><span class="w">  </span><span class="n">mat_A</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28"></a><span class="w">  </span><span class="p">(</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="mi">7</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w">  </span><span class="mi">5</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29"></a><span class="w">  </span><span class="p">(</span><span class="mi">7</span><span class="o">,</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30"></a><span class="w">  </span><span class="p">(</span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31"></a><span class="w">  </span><span class="p">(</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="mi">7</span><span class="o">,</span><span class="w"> </span><span class="mi">9</span><span class="o">,</span><span class="w"> </span><span class="mi">10</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32"></a><span class="w">  </span><span class="n">vec_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">57</span><span class="o">,</span><span class="w"> </span><span class="mi">79</span><span class="o">,</span><span class="w"> </span><span class="mi">88</span><span class="o">,</span><span class="w"> </span><span class="mi">86</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34"></a><span class="w">  </span><span class="n">vec_b_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35"></a><span class="w">  </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38"></a>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39"></a><span class="k">begin</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40"></a>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solve matrix system A x = b'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43"></a>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44"></a><span class="w">    </span><span class="c1">// Print mat_A</span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_A</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52"></a>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53"></a><span class="w">    </span><span class="c1">// Print vec_b</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Vector b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59"></a>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60"></a><span class="hll"><span class="w">    </span><span class="c1">// Solve - select one of these methods</span>
</span></span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61"></a><span class="hll"><span class="w">    </span><span class="n">slegen</span><span class="p">(</span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">mat_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62"></a><span class="hll"><span class="w">    </span><span class="c1">//slegsy(n_col, n_col, mat_A[1, 1], vec_b[1], soln_vec_x[1], ca, term);</span>
</span></span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63"></a><span class="hll"><span class="w">    </span><span class="c1">//slegpd(n_col, n_col, mat_A[1, 1], vec_b[1], soln_vec_x[1], ca, term);</span>
</span></span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64"></a>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solution vector x = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71"></a>
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72"></a><span class="w">      </span><span class="n">omvmmv</span><span class="p">(</span><span class="n">mat_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73"></a>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Check result: A x = (must be equal to b)'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-10-78"><a id="__codelineno-10-78" name="__codelineno-10-78"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-10-79"><a id="__codelineno-10-79" name="__codelineno-10-79"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-10-80"><a id="__codelineno-10-80" name="__codelineno-10-80"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Error'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-81"><a id="__codelineno-10-81" name="__codelineno-10-81"></a>
</span><span id="__span-10-82"><a id="__codelineno-10-82" name="__codelineno-10-82"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter key to exit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-10-83"><a id="__codelineno-10-83" name="__codelineno-10-83"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span><span class="w"> </span><span class="c1">// Wait for user input before closing</span>
</span><span id="__span-10-84"><a id="__codelineno-10-84" name="__codelineno-10-84"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="band-matrix">Band Matrix<a class="headerlink" href="#band-matrix" title="Permanent link">¶</a></h3>
<p><code>slegba</code> is the optimised solution for band matrices, i.e. matrices in which all elements are zero outside a band of width <code>l</code> below and of width <code>r</code> above the main diagonal.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">slegba</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="o">,</span><span class="w"> </span><span class="n">r</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that this routine cannot work with a 2D array.</p>
</div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>n</code> is the number of columns and rows of the matrix (it must be a square matrix).</li>
<li><code>l</code> is the left bandwidth, i.e. the number of diagonals the band extends below (or to the left of) the main diagonal.</li>
<li><code>r</code> is the right bandwidth, i.e. the number of diagonals the band extends above (or to the right of) the main diagonsl.</li>
<li><code>a</code> is the first element of a 1D array which contains the elements of the diagonal band, see this.<ul>
<li>This array <strong>contains only the band elements and is obtained by running across the rows of the band matrix from left to right and top to bottom, starting at</strong> <span class="arithmatex">\(A_11\)</span>. </li>
<li>It must be dimensioned to contain at least <code>n*(l+1+r) - (r*(r+1)+l*(l+1)) div 2</code> elements. </li>
<li><strong>Note that a 2D array cannot be used for this routine</strong>.</li>
</ul>
</li>
<li><code>b</code> is the first element of the array containing the constant vector <span class="arithmatex">\(b\)</span>. The array length at least must be equal to <span class="arithmatex">\(n\)</span>. The vector will not be changed during the calculation.</li>
<li><code>x</code> is the first element of the array to receive the solution vector <span class="arithmatex">\(x\)</span>. It must be allocated to contain at least <span class="arithmatex">\(n\)</span> values.</li>
<li><code>ca</code> is a parameter to describe the accuracy of the solution.</li>
<li><code>term</code> returns an error code:<ul>
<li>1 - successful completion, the solution vector <span class="arithmatex">\(x\)</span> is valid</li>
<li>2 - the solution could not have been determined because the matrix is (almost) singular.</li>
<li>3 - error in input values: n &lt; 1, l &lt; 0, l &gt;= n, r &lt; 0, or r &gt;= n</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>Solve this system of linear equations:</p>
<div class="arithmatex">\[
\displaystyle{  \begin{array}{ccccccc}
    5 x_1 &amp; - &amp; 4 x_2 &amp; + &amp;   x_3 &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp; = 0  \\
   -4 x_1 &amp; + &amp; 6 x_2 &amp; - &amp; 4 x_3 &amp; + &amp;   x_4 &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp; = 0  \\
      x_1 &amp; - &amp; 4 x_2 &amp; + &amp; 6 x_3 &amp; - &amp; 4 x_4 &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp; = 0  \\
          &amp;   &amp;   x_2 &amp; - &amp; 4 x_3 &amp; + &amp; 6 x_4 &amp; - &amp; 4 x_5 &amp;   &amp;       &amp;   &amp;       &amp; = 1  \\
          &amp;   &amp;       &amp;   &amp;   x_3 &amp; - &amp; 4 x_4 &amp; + &amp; 6 x_5 &amp; - &amp; 4 x_6 &amp; + &amp;   x_7 &amp; = 0  \\
          &amp;   &amp;       &amp;   &amp;       &amp;   &amp;   x_4 &amp; - &amp; 4 x_5 &amp; + &amp; 6 x_6 &amp; - &amp; 4 x_7 &amp; = 0  \\
          &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp;   &amp;   x_5 &amp; - &amp; 4 x_6 &amp; + &amp; 5 x_7 &amp; = 0  \\
  \end{array}
  \qquad \Rightarrow \qquad
  A=
  \left[
    \begin{array}{rrrr}
       5 &amp; -4 &amp;  1 &amp;  0 &amp;  0 &amp;  0 &amp;  0  \\
      -4 &amp;  6 &amp; -4 &amp;  1 &amp;  0 &amp;  0 &amp;  0  \\
       1 &amp; -4 &amp;  6 &amp; -4 &amp;  1 &amp;  0 &amp;  0  \\
       0 &amp;  1 &amp; -4 &amp;  6 &amp; -4 &amp;  1 &amp;  0  \\
       0 &amp;  0 &amp;  1 &amp; -4 &amp;  6 &amp; -4 &amp;  1  \\
       0 &amp;  0 &amp;  0 &amp;  1 &amp; -4 &amp;  6 &amp; -4  \\
       0 &amp;  0 &amp;  0 &amp;  0 &amp;  1 &amp; -4 &amp;  5
    \end{array}
  \right]
  , \;
  \mathbf{b} =
  \left[
    \begin{array}{r}
      0 \\
      0 \\
      0 \\
      1 \\
      0 \\
      0 \\
      0
    \end{array}
  \right]
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">  1</a></span>
<span class="normal"><a href="#__codelineno-12-2">  2</a></span>
<span class="normal"><a href="#__codelineno-12-3">  3</a></span>
<span class="normal"><a href="#__codelineno-12-4">  4</a></span>
<span class="normal"><a href="#__codelineno-12-5">  5</a></span>
<span class="normal"><a href="#__codelineno-12-6">  6</a></span>
<span class="normal"><a href="#__codelineno-12-7">  7</a></span>
<span class="normal"><a href="#__codelineno-12-8">  8</a></span>
<span class="normal"><a href="#__codelineno-12-9">  9</a></span>
<span class="normal"><a href="#__codelineno-12-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-12-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-12-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-12-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-12-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-12-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-12-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-12-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-12-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-12-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-12-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-12-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-12-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-12-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-12-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-12-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-12-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-12-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-12-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-12-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-12-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-12-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-12-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-12-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-12-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-12-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-12-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-12-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-12-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-12-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-12-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-12-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-12-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-12-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-12-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-12-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-12-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-12-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-12-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-12-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-12-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-12-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-12-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-12-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-12-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-12-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-12-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-12-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-12-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-12-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-12-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-12-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-12-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-12-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-12-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-12-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-12-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-12-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-12-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-12-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-12-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-12-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-12-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-12-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-12-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-12-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-12-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-12-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-12-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-12-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-12-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-12-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-12-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-12-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-12-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-12-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-12-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-12-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-12-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-12-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-12-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-12-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-12-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-12-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-12-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-12-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-12-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-12-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-12-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-12-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-12-100">100</a></span>
<span class="normal"><a href="#__codelineno-12-101">101</a></span>
<span class="normal"><a href="#__codelineno-12-102">102</a></span>
<span class="normal"><a href="#__codelineno-12-103">103</a></span>
<span class="normal"><a href="#__codelineno-12-104">104</a></span>
<span class="normal"><a href="#__codelineno-12-105">105</a></span>
<span class="normal"><a href="#__codelineno-12-106">106</a></span>
<span class="normal"><a href="#__codelineno-12-107">107</a></span>
<span class="normal"><a href="#__codelineno-12-108">108</a></span>
<span class="normal"><a href="#__codelineno-12-109">109</a></span>
<span class="normal"><a href="#__codelineno-12-110">110</a></span>
<span class="normal"><a href="#__codelineno-12-111">111</a></span>
<span class="normal"><a href="#__codelineno-12-112">112</a></span>
<span class="normal"><a href="#__codelineno-12-113">113</a></span>
<span class="normal"><a href="#__codelineno-12-114">114</a></span>
<span class="normal"><a href="#__codelineno-12-115">115</a></span>
<span class="normal"><a href="#__codelineno-12-116">116</a></span>
<span class="normal"><a href="#__codelineno-12-117">117</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_band</span><span class="o">;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="k">uses</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">sle</span><span class="o">,</span><span class="w"> </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="k">const</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">;</span><span class="w">  </span><span class="c1">// For Square matrices, n_col = m_row</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">  </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span><span class="w">  </span><span class="c1">// Number of diagonals the band extends below (or to the left of) the main diagonal.</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">  </span><span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L</span><span class="o">;</span><span class="w">  </span><span class="c1">// Number of diagonals the band extends above (or to the right of) the main diagonal.</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">  </span><span class="n">n_band_elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">L</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">R</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">div</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13"></a>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="k">var</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">  </span><span class="c1">// Band elements arranged in rows, elements outside of the band omitted!</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">  </span><span class="n">mat_a_band_elements</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_band_elements</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Arbfloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">             </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">         </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">      </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w">      </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="w">      </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w">      </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="w">      </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="w">    </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="w">  </span><span class="n">vec_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="w">    </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="w">  </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="w">  </span><span class="n">mat_a_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30"></a><span class="w">  </span><span class="n">vec_b_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31"></a><span class="w">  </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34"></a>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35"></a><span class="k">begin</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solve matrix system A x = b where A is a band matrix'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38"></a>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39"></a><span class="w">  </span><span class="c1">// Write diagonal elements</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix A:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  n = '</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42"></a><span class="w">  </span><span class="nb">Writeln</span><span class="p">(</span><span class="s">'  Left band width L = '</span><span class="o">,</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Right band width R = '</span><span class="o">,</span><span class="w"> </span><span class="n">R</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Diagonal elements of A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_band_elements</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a_band_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49"></a>
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50"></a><span class="w">  </span><span class="c1">// Solve</span>
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51"></a><span class="hll"><span class="w">  </span><span class="n">slegba</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">l</span><span class="o">,</span><span class="w"> </span><span class="n">r</span><span class="o">,</span><span class="w"> </span><span class="n">mat_a_band_elements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52"></a>
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54"></a><span class="w">    </span><span class="c1">// Optional -- Test if tyhe result of matrix A with the solution vector x equals to vector b.</span>
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55"></a><span class="w">    </span><span class="c1">// Since mutliplication of a matrix stored like a band matrix is quite</span>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56"></a><span class="w">    </span><span class="c1">// cumbersome we copy the band matrix into a standard matrix.</span>
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57"></a><span class="w">    </span><span class="nb">FillChar</span><span class="p">(</span><span class="n">mat_a_test</span><span class="o">,</span><span class="w"> </span><span class="nb">SizeOf</span><span class="p">(</span><span class="n">mat_a_test</span><span class="p">)</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58"></a><span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">i</span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="n">R</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62"></a><span class="w">          </span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mat_a_band_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63"></a><span class="w">          </span><span class="nb">inc</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-64"><a id="__codelineno-12-64" name="__codelineno-12-64"></a><span class="w">        </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-12-65"><a id="__codelineno-12-65" name="__codelineno-12-65"></a>
</span><span id="__span-12-66"><a id="__codelineno-12-66" name="__codelineno-12-66"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">R</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-67"><a id="__codelineno-12-67" name="__codelineno-12-67"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">i</span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="n">R</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-12-68"><a id="__codelineno-12-68" name="__codelineno-12-68"></a><span class="w">        </span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mat_a_band_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-12-69"><a id="__codelineno-12-69" name="__codelineno-12-69"></a><span class="w">        </span><span class="nb">inc</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-70"><a id="__codelineno-12-70" name="__codelineno-12-70"></a><span class="w">      </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-12-71"><a id="__codelineno-12-71" name="__codelineno-12-71"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">R</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-72"><a id="__codelineno-12-72" name="__codelineno-12-72"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">i</span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="n">R</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-73"><a id="__codelineno-12-73" name="__codelineno-12-73"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-12-74"><a id="__codelineno-12-74" name="__codelineno-12-74"></a><span class="w">          </span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mat_a_band_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-12-75"><a id="__codelineno-12-75" name="__codelineno-12-75"></a><span class="w">          </span><span class="nb">inc</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-76"><a id="__codelineno-12-76" name="__codelineno-12-76"></a><span class="w">        </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-12-77"><a id="__codelineno-12-77" name="__codelineno-12-77"></a>
</span><span id="__span-12-78"><a id="__codelineno-12-78" name="__codelineno-12-78"></a><span class="w">    </span><span class="c1">// Optional -- Print matrix A</span>
</span><span id="__span-12-79"><a id="__codelineno-12-79" name="__codelineno-12-79"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix A ='</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-80"><a id="__codelineno-12-80" name="__codelineno-12-80"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-12-81"><a id="__codelineno-12-81" name="__codelineno-12-81"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-82"><a id="__codelineno-12-82" name="__codelineno-12-82"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-83"><a id="__codelineno-12-83" name="__codelineno-12-83"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-84"><a id="__codelineno-12-84" name="__codelineno-12-84"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-12-85"><a id="__codelineno-12-85" name="__codelineno-12-85"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-86"><a id="__codelineno-12-86" name="__codelineno-12-86"></a>
</span><span id="__span-12-87"><a id="__codelineno-12-87" name="__codelineno-12-87"></a><span class="w">    </span><span class="c1">// Optional -- Print Vector b</span>
</span><span id="__span-12-88"><a id="__codelineno-12-88" name="__codelineno-12-88"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Vector b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-89"><a id="__codelineno-12-89" name="__codelineno-12-89"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-90"><a id="__codelineno-12-90" name="__codelineno-12-90"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-91"><a id="__codelineno-12-91" name="__codelineno-12-91"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-92"><a id="__codelineno-12-92" name="__codelineno-12-92"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-93"><a id="__codelineno-12-93" name="__codelineno-12-93"></a>
</span><span id="__span-12-94"><a id="__codelineno-12-94" name="__codelineno-12-94"></a><span class="w">    </span><span class="c1">// Print solution</span>
</span><span id="__span-12-95"><a id="__codelineno-12-95" name="__codelineno-12-95"></a><span class="hll"><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solution: vector x = '</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-12-96"><a id="__codelineno-12-96" name="__codelineno-12-96"></a><span class="hll"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span></span><span id="__span-12-97"><a id="__codelineno-12-97" name="__codelineno-12-97"></a><span class="hll"><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-12-98"><a id="__codelineno-12-98" name="__codelineno-12-98"></a><span class="hll"><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span></span><span id="__span-12-99"><a id="__codelineno-12-99" name="__codelineno-12-99"></a><span class="hll"><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span></span><span id="__span-12-100"><a id="__codelineno-12-100" name="__codelineno-12-100"></a><span class="hll">
</span></span><span id="__span-12-101"><a id="__codelineno-12-101" name="__codelineno-12-101"></a><span class="w">    </span><span class="c1">// Optional -- Double-check result by multiply mat_a_text and the soln_vec_x</span>
</span><span id="__span-12-102"><a id="__codelineno-12-102" name="__codelineno-12-102"></a><span class="w">    </span><span class="c1">// The result should be the same as vec_b</span>
</span><span id="__span-12-103"><a id="__codelineno-12-103" name="__codelineno-12-103"></a><span class="w">    </span><span class="n">omvmmv</span><span class="p">(</span><span class="n">mat_a_test</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-12-104"><a id="__codelineno-12-104" name="__codelineno-12-104"></a>
</span><span id="__span-12-105"><a id="__codelineno-12-105" name="__codelineno-12-105"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Check result: A x = (must be equal to b)'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-106"><a id="__codelineno-12-106" name="__codelineno-12-106"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-12-107"><a id="__codelineno-12-107" name="__codelineno-12-107"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-108"><a id="__codelineno-12-108" name="__codelineno-12-108"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-12-109"><a id="__codelineno-12-109" name="__codelineno-12-109"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-12-110"><a id="__codelineno-12-110" name="__codelineno-12-110"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-12-111"><a id="__codelineno-12-111" name="__codelineno-12-111"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Error'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-112"><a id="__codelineno-12-112" name="__codelineno-12-112"></a>
</span><span id="__span-12-113"><a id="__codelineno-12-113" name="__codelineno-12-113"></a>
</span><span id="__span-12-114"><a id="__codelineno-12-114" name="__codelineno-12-114"></a><span class="w">  </span><span class="c1">// Pause console</span>
</span><span id="__span-12-115"><a id="__codelineno-12-115" name="__codelineno-12-115"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-12-116"><a id="__codelineno-12-116" name="__codelineno-12-116"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-12-117"><a id="__codelineno-12-117" name="__codelineno-12-117"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="symmetric-positive-definite-band-matrix">Symmetric Positive Definite Band Matrix<a class="headerlink" href="#symmetric-positive-definite-band-matrix" title="Permanent link">¶</a></h3>
<p><code>slegpb</code> is the optimised solution for symmetric positive band matrices.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">slegpb</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that this routine cannot work with a 2D array.</p>
</div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>n</code> is the number of rows and columns in the matrix (the matrix must be square).</li>
<li><code>w</code> is the bandwidth (one-sided), which is the number of diagonals that extend below (or to the left of) the main diagonal. This value is also the number of diagonals that extend above (or to the right of) the main diagonal.</li>
<li><code>a</code> points to the first element of a 1D array that contains the elements of the diagonal band. <ul>
<li>This array holds only the band elements and is constructed by traversing the rows of the band matrix from top-left to bottom-right, stopping at the main diagonal. </li>
<li>As a result, <strong>it contains only the left band and the main diagonal elements</strong>.</li>
<li>The array must be dimensioned to hold at least <code>n*(w+1) - (w*(w+1)) div 2</code> elements. </li>
<li><strong>Note that this routine cannot work with a 2D array</strong>.</li>
</ul>
</li>
<li><code>b</code> points to the first element of the array holding the constant vector <span class="arithmatex">\(b\)</span>. The length of this array must be at least <span class="arithmatex">\(n\)</span>, and the vector remains unchanged during the computation.</li>
<li><code>x</code> is the first element of the array where the solution vector <span class="arithmatex">\(x\)</span> will be stored. It must be large enough to hold at least <code>n</code> values. If term is not equal to 1, the solution array may contain invalid data.</li>
<li><code>ca</code> specifies the accuracy of the solution.</li>
<li><code>term</code> is an error code that indicates the result of the calculation:<ul>
<li>1: The computation was successful, and the solution vector <span class="arithmatex">\(x\)</span> is valid.</li>
<li>2: The matrix is (nearly) singular, so a solution could not be determined.</li>
<li>3: There was an error in the input values (e.g., <code>n &lt; 1</code>, <code>w &lt; 0</code>, or <code>w &gt;= n</code>).</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>Solve this system of linear equations.</p>
<div class="arithmatex">\[
\displaystyle{  \begin{array}{ccccccc}
    5 x_1 &amp; - &amp; 4 x_2 &amp; + &amp;   x_3 &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp; = 0  \\
   -4 x_1 &amp; + &amp; 6 x_2 &amp; - &amp; 4 x_3 &amp; + &amp;   x_4 &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp; = 0  \\
      x_1 &amp; - &amp; 4 x_2 &amp; + &amp; 6 x_3 &amp; - &amp; 4 x_4 &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp; = 0  \\
          &amp;   &amp;   x_2 &amp; - &amp; 4 x_3 &amp; + &amp; 6 x_4 &amp; - &amp; 4 x_5 &amp;   &amp;       &amp;   &amp;       &amp; = 1  \\
          &amp;   &amp;       &amp;   &amp;   x_3 &amp; - &amp; 4 x_4 &amp; + &amp; 6 x_5 &amp; - &amp; 4 x_6 &amp; + &amp;   x_7 &amp; = 0  \\
          &amp;   &amp;       &amp;   &amp;       &amp;   &amp;   x_4 &amp; - &amp; 4 x_5 &amp; + &amp; 6 x_6 &amp; - &amp; 4 x_7 &amp; = 0  \\
          &amp;   &amp;       &amp;   &amp;       &amp;   &amp;       &amp;   &amp;   x_5 &amp; - &amp; 4 x_6 &amp; + &amp; 5 x_7 &amp; = 0  \\
  \end{array}
  \qquad \Rightarrow \qquad
  A=
  \left[
    \begin{array}{rrrr}
       5 &amp; -4 &amp;  1 &amp;  0 &amp;  0 &amp;  0 &amp;  0  \\
      -4 &amp;  6 &amp; -4 &amp;  1 &amp;  0 &amp;  0 &amp;  0  \\
       1 &amp; -4 &amp;  6 &amp; -4 &amp;  1 &amp;  0 &amp;  0  \\
       0 &amp;  1 &amp; -4 &amp;  6 &amp; -4 &amp;  1 &amp;  0  \\
       0 &amp;  0 &amp;  1 &amp; -4 &amp;  6 &amp; -4 &amp;  1  \\
       0 &amp;  0 &amp;  0 &amp;  1 &amp; -4 &amp;  6 &amp; -4  \\
       0 &amp;  0 &amp;  0 &amp;  0 &amp;  1 &amp; -4 &amp;  5
    \end{array}
  \right]
  , \;
  \mathbf{b} =
  \left[
    \begin{array}{r}
      0 \\
      0 \\
      0 \\
      1 \\
      0 \\
      0 \\
      0
    \end{array}
  \right]
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">  1</a></span>
<span class="normal"><a href="#__codelineno-14-2">  2</a></span>
<span class="normal"><a href="#__codelineno-14-3">  3</a></span>
<span class="normal"><a href="#__codelineno-14-4">  4</a></span>
<span class="normal"><a href="#__codelineno-14-5">  5</a></span>
<span class="normal"><a href="#__codelineno-14-6">  6</a></span>
<span class="normal"><a href="#__codelineno-14-7">  7</a></span>
<span class="normal"><a href="#__codelineno-14-8">  8</a></span>
<span class="normal"><a href="#__codelineno-14-9">  9</a></span>
<span class="normal"><a href="#__codelineno-14-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-14-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-14-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-14-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-14-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-14-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-14-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-14-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-14-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-14-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-14-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-14-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-14-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-14-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-14-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-14-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-14-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-14-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-14-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-14-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-14-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-14-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-14-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-14-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-14-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-14-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-14-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-14-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-14-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-14-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-14-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-14-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-14-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-14-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-14-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-14-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-14-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-14-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-14-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-14-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-14-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-14-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-14-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-14-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-14-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-14-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-14-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-14-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-14-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-14-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-14-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-14-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-14-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-14-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-14-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-14-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-14-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-14-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-14-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-14-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-14-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-14-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-14-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-14-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-14-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-14-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-14-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-14-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-14-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-14-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-14-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-14-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-14-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-14-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-14-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-14-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-14-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-14-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-14-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-14-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-14-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-14-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-14-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-14-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-14-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-14-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-14-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-14-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-14-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-14-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-14-100">100</a></span>
<span class="normal"><a href="#__codelineno-14-101">101</a></span>
<span class="normal"><a href="#__codelineno-14-102">102</a></span>
<span class="normal"><a href="#__codelineno-14-103">103</a></span>
<span class="normal"><a href="#__codelineno-14-104">104</a></span>
<span class="normal"><a href="#__codelineno-14-105">105</a></span>
<span class="normal"><a href="#__codelineno-14-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_spd</span><span class="o">;</span><span class="w">    </span><span class="c1">// "spd" = symmetric positive definite</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="k">uses</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">sle</span><span class="o">,</span><span class="w"> </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="k">const</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="w">  </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="w">  </span><span class="n">n_band_elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">div</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="k">var</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="w">  </span><span class="c1">// Band elements arranged in rows</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="w">  </span><span class="c1">// Elements outside of the band as well as right diagonals are omitted!</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="w">  </span><span class="n">mat_a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_band_elements</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Arbfloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="w">             </span><span class="mi">5</span><span class="o">,</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="w">            </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="w">             </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="w">                 </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="w">                     </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="w">                       </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="w">                          </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="w">    </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="w">  </span><span class="n">vec_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="w">    </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27"></a><span class="w">  </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29"></a><span class="w">  </span><span class="n">mat_a_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="w">  </span><span class="n">vec_b_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31"></a><span class="w">  </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34"></a>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35"></a><span class="k">begin</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solve matrix system A x = b where A is a symmetric positive definite band matrix'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38"></a>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39"></a><span class="w">  </span><span class="c1">// Write diagonal elements</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix A:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  n = '</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42"></a><span class="w">  </span><span class="nb">Writeln</span><span class="p">(</span><span class="s">'  (One-sided) band width w = '</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Diagonal elements of A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_band_elements</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48"></a>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49"></a><span class="w">  </span><span class="c1">// Solve</span>
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50"></a><span class="hll"><span class="w">  </span><span class="n">slegpb</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">,</span><span class="w"> </span><span class="n">mat_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51"></a>
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53"></a><span class="w">    </span><span class="c1">// To test the result we multiply a with the solution vector x and check</span>
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54"></a><span class="w">    </span><span class="c1">// whether the result is equal to b.</span>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55"></a><span class="w">    </span><span class="c1">// Since mutliplication of a matrix stored like a band matrix is quite</span>
</span><span id="__span-14-56"><a id="__codelineno-14-56" name="__codelineno-14-56"></a><span class="w">    </span><span class="c1">// cumbersome we copy the band matrix into a standard matrix.</span>
</span><span id="__span-14-57"><a id="__codelineno-14-57" name="__codelineno-14-57"></a><span class="w">    </span><span class="nb">FillChar</span><span class="p">(</span><span class="n">mat_a_test</span><span class="o">,</span><span class="w"> </span><span class="nb">SizeOf</span><span class="p">(</span><span class="n">mat_a_test</span><span class="p">)</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-58"><a id="__codelineno-14-58" name="__codelineno-14-58"></a><span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-14-59"><a id="__codelineno-14-59" name="__codelineno-14-59"></a><span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-14-60"><a id="__codelineno-14-60" name="__codelineno-14-60"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n_band_elements</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-14-61"><a id="__codelineno-14-61" name="__codelineno-14-61"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-62"><a id="__codelineno-14-62" name="__codelineno-14-62"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-14-63"><a id="__codelineno-14-63" name="__codelineno-14-63"></a><span class="w">          </span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mat_a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-14-64"><a id="__codelineno-14-64" name="__codelineno-14-64"></a><span class="w">          </span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">mat_a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-14-65"><a id="__codelineno-14-65" name="__codelineno-14-65"></a><span class="w">          </span><span class="nb">inc</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-66"><a id="__codelineno-14-66" name="__codelineno-14-66"></a><span class="w">        </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-14-67"><a id="__codelineno-14-67" name="__codelineno-14-67"></a><span class="w">      </span><span class="nb">inc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-68"><a id="__codelineno-14-68" name="__codelineno-14-68"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-14-69"><a id="__codelineno-14-69" name="__codelineno-14-69"></a>
</span><span id="__span-14-70"><a id="__codelineno-14-70" name="__codelineno-14-70"></a><span class="w">    </span><span class="c1">// Print mat_a</span>
</span><span id="__span-14-71"><a id="__codelineno-14-71" name="__codelineno-14-71"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix A ='</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-72"><a id="__codelineno-14-72" name="__codelineno-14-72"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-14-73"><a id="__codelineno-14-73" name="__codelineno-14-73"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-74"><a id="__codelineno-14-74" name="__codelineno-14-74"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a_test</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-75"><a id="__codelineno-14-75" name="__codelineno-14-75"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-76"><a id="__codelineno-14-76" name="__codelineno-14-76"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-14-77"><a id="__codelineno-14-77" name="__codelineno-14-77"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-78"><a id="__codelineno-14-78" name="__codelineno-14-78"></a>
</span><span id="__span-14-79"><a id="__codelineno-14-79" name="__codelineno-14-79"></a><span class="w">    </span><span class="c1">// Print vec_b</span>
</span><span id="__span-14-80"><a id="__codelineno-14-80" name="__codelineno-14-80"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Vector b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-81"><a id="__codelineno-14-81" name="__codelineno-14-81"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-82"><a id="__codelineno-14-82" name="__codelineno-14-82"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-83"><a id="__codelineno-14-83" name="__codelineno-14-83"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-84"><a id="__codelineno-14-84" name="__codelineno-14-84"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-85"><a id="__codelineno-14-85" name="__codelineno-14-85"></a>
</span><span id="__span-14-86"><a id="__codelineno-14-86" name="__codelineno-14-86"></a><span class="w">    </span><span class="c1">// Print solution vec_x</span>
</span><span id="__span-14-87"><a id="__codelineno-14-87" name="__codelineno-14-87"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solution: vector x = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-88"><a id="__codelineno-14-88" name="__codelineno-14-88"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-89"><a id="__codelineno-14-89" name="__codelineno-14-89"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-90"><a id="__codelineno-14-90" name="__codelineno-14-90"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-91"><a id="__codelineno-14-91" name="__codelineno-14-91"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-92"><a id="__codelineno-14-92" name="__codelineno-14-92"></a>
</span><span id="__span-14-93"><a id="__codelineno-14-93" name="__codelineno-14-93"></a><span class="w">    </span><span class="n">omvmmv</span><span class="p">(</span><span class="n">mat_a_test</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-14-94"><a id="__codelineno-14-94" name="__codelineno-14-94"></a>
</span><span id="__span-14-95"><a id="__codelineno-14-95" name="__codelineno-14-95"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Check result: A x = (must be equal to b)'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-96"><a id="__codelineno-14-96" name="__codelineno-14-96"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-97"><a id="__codelineno-14-97" name="__codelineno-14-97"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-98"><a id="__codelineno-14-98" name="__codelineno-14-98"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-14-99"><a id="__codelineno-14-99" name="__codelineno-14-99"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-14-100"><a id="__codelineno-14-100" name="__codelineno-14-100"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-14-101"><a id="__codelineno-14-101" name="__codelineno-14-101"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Error'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-102"><a id="__codelineno-14-102" name="__codelineno-14-102"></a>
</span><span id="__span-14-103"><a id="__codelineno-14-103" name="__codelineno-14-103"></a><span class="w">  </span><span class="c1">// Pause Console</span>
</span><span id="__span-14-104"><a id="__codelineno-14-104" name="__codelineno-14-104"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-14-105"><a id="__codelineno-14-105" name="__codelineno-14-105"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-14-106"><a id="__codelineno-14-106" name="__codelineno-14-106"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="tridiagonal-matrix">Tridiagonal Matrix<a class="headerlink" href="#tridiagonal-matrix" title="Permanent link">¶</a></h3>
<p>NumLib provides two special procedures to solve linear equations based on a tridiagonal matrix. These procedures use an efficient way to store tridiagonal matrices, with slight differences in their calculation methods and handling of certain cases.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">sledtr</span><span class="p">(</span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">l</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">u</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">slegtr</span><span class="p">(</span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">l</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">u</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>n</code> is the number of unknown variables. It must be the same as the number of columns and rows of the coefficent matrix.</li>
<li><code>l</code> specifies the first element in the subdiagonal of the matrix <span class="arithmatex">\(A\)</span>. This 1D array must be dimensioned to at least <code>n-1</code> elements.</li>
<li><code>d</code> specifies the first element along the main diagonal of the matrix <span class="arithmatex">\(A\)</span>. This 1D array must be dimensioned to contain at least <code>n</code> elements.</li>
<li><code>u</code> specifies the first element along the superdiagonal of the matrix <span class="arithmatex">\(A\)</span>. The array must be dimensioned to have at least <code>n-1</code> elements.</li>
<li><code>b</code> is the first element of the array containing the constant vector <span class="arithmatex">\(b\)</span>. The array length at least must be equal to <code>n</code>. The vector will not be changed during the calculation.</li>
<li><code>x</code> is the first element of the array to receive the solution vector <span class="arithmatex">\(x\)</span>. It must be allocated to contain at least <code>n</code> values.</li>
<li><code>ca</code> is a parameter to describe the accuracy of the solution.</li>
<li><code>term</code> returns an error code:<ul>
<li><code>1</code> - successful completion, the solution vector <span class="arithmatex">\(x\)</span> is valid</li>
<li><code>2</code> - the solution could not have been determined because the matrix is (almost) singular.</li>
<li><code>3</code> - error in input values: <code>n &lt; 1</code>.</li>
</ul>
</li>
</ul>
<p>The <code>sledtr</code> routine is numerically stable if matrix <span class="arithmatex">\(A\)</span> fulfills one of these conditions:</p>
<ul>
<li>Matrix <span class="arithmatex">\(A\)</span> is regular (i.e. its inverse matrix exists), and <span class="arithmatex">\(A\)</span> is columnar-diagonally dominant, this means:<ul>
<li>|d1| ≥ |l2|,</li>
<li>|di| ≥ |ui-1| + |li+1|, i = 2, ..., n-1,</li>
<li>|dn| ≥ |un-1|</li>
</ul>
</li>
<li>Matrix <span class="arithmatex">\(A\)</span> is regular, and <span class="arithmatex">\(A\)</span> is diagonally dominant, this means:<ul>
<li>|d1| ≥ |l2|,</li>
<li>|di| ≥ |ui| + |li|, i = 2, ..., n-1,</li>
<li>|dn| ≥ |un|</li>
</ul>
</li>
<li>Matrix <span class="arithmatex">\(A\)</span> is symmetric and positive-definite.</li>
</ul>
<p>Note, the <code>sledtr</code> routine does not provide the parameter <code>ca</code> from which the accuracy of the determined solution can be evaluated. If this is needed the (less stable) procedure <code>slegtr</code> must be used.</p>
<p><strong>Example</strong></p>
<p>Solve this tridiagonal system of linear equations where <span class="arithmatex">\(n=8\)</span>.</p>
<div class="arithmatex">\[
\displaystyle{  \begin{cases}
   188 x_1 - 100 x_2                    = 0   \\
   -100 x_1 + 188 x_2 -100 x_3          = 0 \\
   \vdots  \\
   -100 x_{n-2} + 188 x_{n-1} - 100 x_n = 0 \\          
   -100 x_{n-1} + 188 x_n               = 0 
  \end{cases}
  \qquad \Rightarrow \qquad
  A=
  \left[
    \begin{array}{rrrrr}
       188 &amp; -100   &amp;        &amp;        &amp; 0    \\
      -100 &amp;  188   &amp; -100   &amp;        &amp;      \\
           &amp; \ddots &amp; \ddots &amp; \ddots &amp;      \\
           &amp;        &amp; -100   &amp;   188  &amp; -100 \\
           &amp;        &amp;        &amp;  -100  &amp;  188 \\
    \end{array}
  \right]
  , \;
  \mathbf{b} =
  \left[
    \begin{array}{r}
       88 \\
      -12 \\
      \vdots \\
      -12 \\
       88
    \end{array}
  \right]
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span>
<span class="normal"><a href="#__codelineno-16-25">25</a></span>
<span class="normal"><a href="#__codelineno-16-26">26</a></span>
<span class="normal"><a href="#__codelineno-16-27">27</a></span>
<span class="normal"><a href="#__codelineno-16-28">28</a></span>
<span class="normal"><a href="#__codelineno-16-29">29</a></span>
<span class="normal"><a href="#__codelineno-16-30">30</a></span>
<span class="normal"><a href="#__codelineno-16-31">31</a></span>
<span class="normal"><a href="#__codelineno-16-32">32</a></span>
<span class="normal"><a href="#__codelineno-16-33">33</a></span>
<span class="normal"><a href="#__codelineno-16-34">34</a></span>
<span class="normal"><a href="#__codelineno-16-35">35</a></span>
<span class="normal"><a href="#__codelineno-16-36">36</a></span>
<span class="normal"><a href="#__codelineno-16-37">37</a></span>
<span class="normal"><a href="#__codelineno-16-38">38</a></span>
<span class="normal"><a href="#__codelineno-16-39">39</a></span>
<span class="normal"><a href="#__codelineno-16-40">40</a></span>
<span class="normal"><a href="#__codelineno-16-41">41</a></span>
<span class="normal"><a href="#__codelineno-16-42">42</a></span>
<span class="normal"><a href="#__codelineno-16-43">43</a></span>
<span class="normal"><a href="#__codelineno-16-44">44</a></span>
<span class="normal"><a href="#__codelineno-16-45">45</a></span>
<span class="normal"><a href="#__codelineno-16-46">46</a></span>
<span class="normal"><a href="#__codelineno-16-47">47</a></span>
<span class="normal"><a href="#__codelineno-16-48">48</a></span>
<span class="normal"><a href="#__codelineno-16-49">49</a></span>
<span class="normal"><a href="#__codelineno-16-50">50</a></span>
<span class="normal"><a href="#__codelineno-16-51">51</a></span>
<span class="normal"><a href="#__codelineno-16-52">52</a></span>
<span class="normal"><a href="#__codelineno-16-53">53</a></span>
<span class="normal"><a href="#__codelineno-16-54">54</a></span>
<span class="normal"><a href="#__codelineno-16-55">55</a></span>
<span class="normal"><a href="#__codelineno-16-56">56</a></span>
<span class="normal"><a href="#__codelineno-16-57">57</a></span>
<span class="normal"><a href="#__codelineno-16-58">58</a></span>
<span class="normal"><a href="#__codelineno-16-59">59</a></span>
<span class="normal"><a href="#__codelineno-16-60">60</a></span>
<span class="normal"><a href="#__codelineno-16-61">61</a></span>
<span class="normal"><a href="#__codelineno-16-62">62</a></span>
<span class="normal"><a href="#__codelineno-16-63">63</a></span>
<span class="normal"><a href="#__codelineno-16-64">64</a></span>
<span class="normal"><a href="#__codelineno-16-65">65</a></span>
<span class="normal"><a href="#__codelineno-16-66">66</a></span>
<span class="normal"><a href="#__codelineno-16-67">67</a></span>
<span class="normal"><a href="#__codelineno-16-68">68</a></span>
<span class="normal"><a href="#__codelineno-16-69">69</a></span>
<span class="normal"><a href="#__codelineno-16-70">70</a></span>
<span class="normal"><a href="#__codelineno-16-71">71</a></span>
<span class="normal"><a href="#__codelineno-16-72">72</a></span>
<span class="normal"><a href="#__codelineno-16-73">73</a></span>
<span class="normal"><a href="#__codelineno-16-74">74</a></span>
<span class="normal"><a href="#__codelineno-16-75">75</a></span>
<span class="normal"><a href="#__codelineno-16-76">76</a></span>
<span class="normal"><a href="#__codelineno-16-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_tridiag_matrix</span><span class="o">;</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="k">uses</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">sle</span><span class="o">;</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="k">const</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="o">;</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="k">var</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">  </span><span class="n">u_super_diag_items</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="w">      </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">  </span><span class="n">d_diag_items</span><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w">   </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="o">,</span><span class="w">  </span><span class="mi">188</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">  </span><span class="n">l_sub_diag_items</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">      </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">100</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">  </span><span class="n">vec_b</span><span class="w">             </span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w">   </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="mi">88</span><span class="o">,</span><span class="w">  </span><span class="o">-</span><span class="mi">12</span><span class="o">,</span><span class="w">  </span><span class="o">-</span><span class="mi">12</span><span class="o">,</span><span class="w">  </span><span class="o">-</span><span class="mi">12</span><span class="o">,</span><span class="w">  </span><span class="o">-</span><span class="mi">12</span><span class="o">,</span><span class="w">  </span><span class="o">-</span><span class="mi">12</span><span class="o">,</span><span class="w">  </span><span class="o">-</span><span class="mi">12</span><span class="o">,</span><span class="w">   </span><span class="mi">88</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="w">  </span><span class="n">ca</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="w">  </span><span class="n">vec_b_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20"></a>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="k">begin</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solve tridiagonal matrix system A x = b'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24"></a>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Superdiagonal of A:'</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">u_super_diag_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29"></a>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Main diagonal of A:'</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">d_diag_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34"></a>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Subdiagonal of A:'</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">''</span><span class="o">:</span><span class="mi">10</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">2</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">l_sub_diag_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40"></a>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Vector b:'</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45"></a>
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46"></a><span class="w">  </span><span class="c1">// Solve for vector x</span>
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47"></a><span class="hll"><span class="w">  </span><span class="n">slegtr</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">l_sub_diag_items</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">d_diag_items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">u_super_diag_items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">ca</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48"></a><span class="w">  </span><span class="c1">// Alternatively,</span>
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49"></a><span class="w">  </span><span class="c1">// sledtr(n, l_sub_diag_items[2], d_diag_items[1], u_super_diag_items[1], vec_b[1], soln_vec_x[1], term);</span>
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50"></a>
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51"></a>
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Solution vector x:'</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57"></a>
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58"></a><span class="w">    </span><span class="c1">// Multiply A with soln_vec_x to test the result</span>
</span><span id="__span-16-59"><a id="__codelineno-16-59" name="__codelineno-16-59"></a><span class="w">    </span><span class="c1">// NumLib does not have a routine to multiply a tridiagonal matrix with a</span>
</span><span id="__span-16-60"><a id="__codelineno-16-60" name="__codelineno-16-60"></a><span class="w">    </span><span class="c1">// vector... Let's do it manually.</span>
</span><span id="__span-16-61"><a id="__codelineno-16-61" name="__codelineno-16-61"></a><span class="w">    </span><span class="n">vec_b_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">d_diag_items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_super_diag_items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-16-62"><a id="__codelineno-16-62" name="__codelineno-16-62"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-63"><a id="__codelineno-16-63" name="__codelineno-16-63"></a><span class="w">      </span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">l_sub_diag_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d_diag_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_super_diag_items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-16-64"><a id="__codelineno-16-64" name="__codelineno-16-64"></a><span class="w">    </span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">l_sub_diag_items</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d_diag_items</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-16-65"><a id="__codelineno-16-65" name="__codelineno-16-65"></a>
</span><span id="__span-16-66"><a id="__codelineno-16-66" name="__codelineno-16-66"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Check b = A x:'</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-67"><a id="__codelineno-16-67" name="__codelineno-16-67"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-68"><a id="__codelineno-16-68" name="__codelineno-16-68"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-69"><a id="__codelineno-16-69" name="__codelineno-16-69"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-16-70"><a id="__codelineno-16-70" name="__codelineno-16-70"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-16-71"><a id="__codelineno-16-71" name="__codelineno-16-71"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-16-72"><a id="__codelineno-16-72" name="__codelineno-16-72"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Error'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-73"><a id="__codelineno-16-73" name="__codelineno-16-73"></a>
</span><span id="__span-16-74"><a id="__codelineno-16-74" name="__codelineno-16-74"></a><span class="w">  </span><span class="c1">// Pause Console</span>
</span><span id="__span-16-75"><a id="__codelineno-16-75" name="__codelineno-16-75"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-16-76"><a id="__codelineno-16-76" name="__codelineno-16-76"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-16-77"><a id="__codelineno-16-77" name="__codelineno-16-77"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="overdetermined-systems-least-squares">Overdetermined Systems (Least Squares)<a class="headerlink" href="#overdetermined-systems-least-squares" title="Permanent link">¶</a></h3>
<p>Unlike other routines in the sle unit that require a square matrix <span class="arithmatex">\(A\)</span>, <code>slegls</code> can solve systems with a rectangular matrix, where there are more equations than unknowns. These systems usually can't be solved exactly. However, an approximate solution can minimize the sum of squared residuals, i.e. the norm <span class="arithmatex">\(\displaystyle{ \|\mathbf{b} - A \mathbf{x}\|_2 }\)</span> is as small as possible. This method is commonly used for fitting equations to data (regression analysis).</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">slegls</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidtha</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>a</code> is the first element of an array of matrix <span class="arithmatex">\(A\)</span>. The array won't be modified.</li>
<li><code>m</code> is the number of rows in matrix <span class="arithmatex">\(A\)</span> (i.e., the number of equations).</li>
<li><code>n</code> is the number of columns in matrix <span class="arithmatex">\(A\)</span> (i.e., the number of unknown variables). <ul>
<li>Note: <span class="arithmatex">\(n\)</span> must not exceed <span class="arithmatex">\(m\)</span>.</li>
</ul>
</li>
<li><code>rwidtha</code> specifies the allocated number of columns for matrix <span class="arithmatex">\(A\)</span>, which can be larger than needed, with <span class="arithmatex">\(n≤rwidth\)</span>.</li>
<li><code>b</code> is the first element of vector <span class="arithmatex">\(b\)</span>, with a lenth matching <span class="arithmatex">\(m\)</span>, though it can be allocated larger.</li>
<li><code>x</code> is the first element of the array for the solution vector <span class="arithmatex">\(x\)</span>, with length matching <span class="arithmatex">\(n\)</span>, though it can also be allocated larger.</li>
<li><code>term</code> returns an error code:<ul>
<li>1 - Success, solution <span class="arithmatex">\(x\)</span> is valid</li>
<li>2 - No clear solution due to linearly dependent columns.</li>
<li>3 - Input error: <code>n &lt; 1</code>, or <code>n &gt; m</code>.</li>
</ul>
</li>
</ul>
<p>The method uses Householder transformation to reduce <span class="arithmatex">\(A\)</span> to an upper triangular form.</p>
<p><strong>Example</strong></p>
<p>Find the least-squares solution for the system <span class="arithmatex">\(A x = b\)</span> of 4 equations and 3 unknowns.</p>
<div class="arithmatex">\[
\displaystyle{  A=
 \left(
 \begin{array}{rrr}
  1 &amp; 0 &amp; 1 \\
  1 &amp; 1 &amp; 1 \\
  0 &amp; 1 &amp; 0 \\
  1 &amp; 1 &amp; 0
 \end{array}
 \right), \ \
 b=
 \left(
 \begin{array}{r}
 21 \\ 39 \\ 21 \\ 30
 \end{array}
 \right).
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span>
<span class="normal"><a href="#__codelineno-18-28">28</a></span>
<span class="normal"><a href="#__codelineno-18-29">29</a></span>
<span class="normal"><a href="#__codelineno-18-30">30</a></span>
<span class="normal"><a href="#__codelineno-18-31">31</a></span>
<span class="normal"><a href="#__codelineno-18-32">32</a></span>
<span class="normal"><a href="#__codelineno-18-33">33</a></span>
<span class="normal"><a href="#__codelineno-18-34">34</a></span>
<span class="normal"><a href="#__codelineno-18-35">35</a></span>
<span class="normal"><a href="#__codelineno-18-36">36</a></span>
<span class="normal"><a href="#__codelineno-18-37">37</a></span>
<span class="normal"><a href="#__codelineno-18-38">38</a></span>
<span class="normal"><a href="#__codelineno-18-39">39</a></span>
<span class="normal"><a href="#__codelineno-18-40">40</a></span>
<span class="normal"><a href="#__codelineno-18-41">41</a></span>
<span class="normal"><a href="#__codelineno-18-42">42</a></span>
<span class="normal"><a href="#__codelineno-18-43">43</a></span>
<span class="normal"><a href="#__codelineno-18-44">44</a></span>
<span class="normal"><a href="#__codelineno-18-45">45</a></span>
<span class="normal"><a href="#__codelineno-18-46">46</a></span>
<span class="normal"><a href="#__codelineno-18-47">47</a></span>
<span class="normal"><a href="#__codelineno-18-48">48</a></span>
<span class="normal"><a href="#__codelineno-18-49">49</a></span>
<span class="normal"><a href="#__codelineno-18-50">50</a></span>
<span class="normal"><a href="#__codelineno-18-51">51</a></span>
<span class="normal"><a href="#__codelineno-18-52">52</a></span>
<span class="normal"><a href="#__codelineno-18-53">53</a></span>
<span class="normal"><a href="#__codelineno-18-54">54</a></span>
<span class="normal"><a href="#__codelineno-18-55">55</a></span>
<span class="normal"><a href="#__codelineno-18-56">56</a></span>
<span class="normal"><a href="#__codelineno-18-57">57</a></span>
<span class="normal"><a href="#__codelineno-18-58">58</a></span>
<span class="normal"><a href="#__codelineno-18-59">59</a></span>
<span class="normal"><a href="#__codelineno-18-60">60</a></span>
<span class="normal"><a href="#__codelineno-18-61">61</a></span>
<span class="normal"><a href="#__codelineno-18-62">62</a></span>
<span class="normal"><a href="#__codelineno-18-63">63</a></span>
<span class="normal"><a href="#__codelineno-18-64">64</a></span>
<span class="normal"><a href="#__codelineno-18-65">65</a></span>
<span class="normal"><a href="#__codelineno-18-66">66</a></span>
<span class="normal"><a href="#__codelineno-18-67">67</a></span>
<span class="normal"><a href="#__codelineno-18-68">68</a></span>
<span class="normal"><a href="#__codelineno-18-69">69</a></span>
<span class="normal"><a href="#__codelineno-18-70">70</a></span>
<span class="normal"><a href="#__codelineno-18-71">71</a></span>
<span class="normal"><a href="#__codelineno-18-72">72</a></span>
<span class="normal"><a href="#__codelineno-18-73">73</a></span>
<span class="normal"><a href="#__codelineno-18-74">74</a></span>
<span class="normal"><a href="#__codelineno-18-75">75</a></span>
<span class="normal"><a href="#__codelineno-18-76">76</a></span>
<span class="normal"><a href="#__codelineno-18-77">77</a></span>
<span class="normal"><a href="#__codelineno-18-78">78</a></span>
<span class="normal"><a href="#__codelineno-18-79">79</a></span>
<span class="normal"><a href="#__codelineno-18-80">80</a></span>
<span class="normal"><a href="#__codelineno-18-81">81</a></span>
<span class="normal"><a href="#__codelineno-18-82">82</a></span>
<span class="normal"><a href="#__codelineno-18-83">83</a></span>
<span class="normal"><a href="#__codelineno-18-84">84</a></span>
<span class="normal"><a href="#__codelineno-18-85">85</a></span>
<span class="normal"><a href="#__codelineno-18-86">86</a></span>
<span class="normal"><a href="#__codelineno-18-87">87</a></span>
<span class="normal"><a href="#__codelineno-18-88">88</a></span>
<span class="normal"><a href="#__codelineno-18-89">89</a></span>
<span class="normal"><a href="#__codelineno-18-90">90</a></span>
<span class="normal"><a href="#__codelineno-18-91">91</a></span>
<span class="normal"><a href="#__codelineno-18-92">92</a></span>
<span class="normal"><a href="#__codelineno-18-93">93</a></span>
<span class="normal"><a href="#__codelineno-18-94">94</a></span>
<span class="normal"><a href="#__codelineno-18-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_leastsquares</span><span class="o">;</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="k">uses</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">  </span><span class="n">sle</span><span class="o">,</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="w">  </span><span class="n">omv</span><span class="o">;</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9"></a>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="k">const</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">  </span><span class="n">m_row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">;</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">  </span><span class="n">n_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">;</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13"></a>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="k">var</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">  </span><span class="n">mat_A</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">m_row</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="w">     </span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">     </span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">     </span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">     </span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">  </span><span class="n">vec_b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">m_row</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">21</span><span class="o">,</span><span class="w"> </span><span class="mi">39</span><span class="o">,</span><span class="w"> </span><span class="mi">21</span><span class="o">,</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_col</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="w">  </span><span class="n">vec_b_test</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">m_row</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">  </span><span class="nb">sum</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26"></a>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="k">begin</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solve A x = b with the least-squares method'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30"></a>
</span><span id="__span-18-31"><a id="__codelineno-18-31" name="__codelineno-18-31"></a><span class="w">  </span><span class="c1">// Display input data</span>
</span><span id="__span-18-32"><a id="__codelineno-18-32" name="__codelineno-18-32"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-33"><a id="__codelineno-18-33" name="__codelineno-18-33"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-34"><a id="__codelineno-18-34" name="__codelineno-18-34"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-18-35"><a id="__codelineno-18-35" name="__codelineno-18-35"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-36"><a id="__codelineno-18-36" name="__codelineno-18-36"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_A</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-37"><a id="__codelineno-18-37" name="__codelineno-18-37"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-38"><a id="__codelineno-18-38" name="__codelineno-18-38"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-18-39"><a id="__codelineno-18-39" name="__codelineno-18-39"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-40"><a id="__codelineno-18-40" name="__codelineno-18-40"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-41"><a id="__codelineno-18-41" name="__codelineno-18-41"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-42"><a id="__codelineno-18-42" name="__codelineno-18-42"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-43"><a id="__codelineno-18-43" name="__codelineno-18-43"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-44"><a id="__codelineno-18-44" name="__codelineno-18-44"></a>
</span><span id="__span-18-45"><a id="__codelineno-18-45" name="__codelineno-18-45"></a><span class="w">  </span><span class="c1">// Calculate and show solution</span>
</span><span id="__span-18-46"><a id="__codelineno-18-46" name="__codelineno-18-46"></a><span class="hll"><span class="w">  </span><span class="n">slegls</span><span class="p">(</span><span class="n">mat_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-18-47"><a id="__codelineno-18-47" name="__codelineno-18-47"></a>
</span><span id="__span-18-48"><a id="__codelineno-18-48" name="__codelineno-18-48"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-49"><a id="__codelineno-18-49" name="__codelineno-18-49"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solution x = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-50"><a id="__codelineno-18-50" name="__codelineno-18-50"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-51"><a id="__codelineno-18-51" name="__codelineno-18-51"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-52"><a id="__codelineno-18-52" name="__codelineno-18-52"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-53"><a id="__codelineno-18-53" name="__codelineno-18-53"></a>
</span><span id="__span-18-54"><a id="__codelineno-18-54" name="__codelineno-18-54"></a><span class="w">  </span><span class="c1">// Calculate and display residuals</span>
</span><span id="__span-18-55"><a id="__codelineno-18-55" name="__codelineno-18-55"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-56"><a id="__codelineno-18-56" name="__codelineno-18-56"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Residuals A x - b = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-57"><a id="__codelineno-18-57" name="__codelineno-18-57"></a><span class="w">  </span><span class="nb">sum</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-18-58"><a id="__codelineno-18-58" name="__codelineno-18-58"></a><span class="w">  </span><span class="n">omvmmv</span><span class="p">(</span><span class="n">mat_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-18-59"><a id="__codelineno-18-59" name="__codelineno-18-59"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-60"><a id="__codelineno-18-60" name="__codelineno-18-60"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-18-61"><a id="__codelineno-18-61" name="__codelineno-18-61"></a><span class="w">    </span><span class="nb">Write</span><span class="p">((</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-62"><a id="__codelineno-18-62" name="__codelineno-18-62"></a><span class="w">    </span><span class="nb">sum</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-18-63"><a id="__codelineno-18-63" name="__codelineno-18-63"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-18-64"><a id="__codelineno-18-64" name="__codelineno-18-64"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-65"><a id="__codelineno-18-65" name="__codelineno-18-65"></a>
</span><span id="__span-18-66"><a id="__codelineno-18-66" name="__codelineno-18-66"></a><span class="w">  </span><span class="c1">// Sum of squared residuals</span>
</span><span id="__span-18-67"><a id="__codelineno-18-67" name="__codelineno-18-67"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-68"><a id="__codelineno-18-68" name="__codelineno-18-68"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Sum of squared residuals'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-69"><a id="__codelineno-18-69" name="__codelineno-18-69"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="nb">sum</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-70"><a id="__codelineno-18-70" name="__codelineno-18-70"></a>
</span><span id="__span-18-71"><a id="__codelineno-18-71" name="__codelineno-18-71"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-72"><a id="__codelineno-18-72" name="__codelineno-18-72"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'----------------------------------------------------------------------------'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-73"><a id="__codelineno-18-73" name="__codelineno-18-73"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-74"><a id="__codelineno-18-74" name="__codelineno-18-74"></a>
</span><span id="__span-18-75"><a id="__codelineno-18-75" name="__codelineno-18-75"></a><span class="w">  </span><span class="c1">// Modify solution to show that the sum of squared residuals increases';</span>
</span><span id="__span-18-76"><a id="__codelineno-18-76" name="__codelineno-18-76"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Modified solution x</span><span class="se">''</span><span class="s"> (to show that it has a larger sum of squared residuals)'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-77"><a id="__codelineno-18-77" name="__codelineno-18-77"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-18-78"><a id="__codelineno-18-78" name="__codelineno-18-78"></a><span class="w">  </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-18-79"><a id="__codelineno-18-79" name="__codelineno-18-79"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-80"><a id="__codelineno-18-80" name="__codelineno-18-80"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_col</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-81"><a id="__codelineno-18-81" name="__codelineno-18-81"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">soln_vec_x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-82"><a id="__codelineno-18-82" name="__codelineno-18-82"></a><span class="w">  </span><span class="n">omvmmv</span><span class="p">(</span><span class="n">mat_A</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">m_row</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">n_col</span><span class="o">,</span><span class="w"> </span><span class="n">soln_vec_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">vec_b_test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-18-83"><a id="__codelineno-18-83" name="__codelineno-18-83"></a><span class="w">  </span><span class="nb">sum</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-18-84"><a id="__codelineno-18-84" name="__codelineno-18-84"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m_row</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-18-85"><a id="__codelineno-18-85" name="__codelineno-18-85"></a><span class="w">    </span><span class="nb">sum</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">vec_b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vec_b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-18-86"><a id="__codelineno-18-86" name="__codelineno-18-86"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-87"><a id="__codelineno-18-87" name="__codelineno-18-87"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-88"><a id="__codelineno-18-88" name="__codelineno-18-88"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Sum of squared residuals'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-89"><a id="__codelineno-18-89" name="__codelineno-18-89"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="nb">sum</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-90"><a id="__codelineno-18-90" name="__codelineno-18-90"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-18-91"><a id="__codelineno-18-91" name="__codelineno-18-91"></a>
</span><span id="__span-18-92"><a id="__codelineno-18-92" name="__codelineno-18-92"></a><span class="w">  </span><span class="c1">// Pause Console</span>
</span><span id="__span-18-93"><a id="__codelineno-18-93" name="__codelineno-18-93"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-18-94"><a id="__codelineno-18-94" name="__codelineno-18-94"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-18-95"><a id="__codelineno-18-95" name="__codelineno-18-95"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>The output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>Solve A x = b with the least-squares method
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>A =
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    1    0    1
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    1    1    1
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    0    1    0
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    1    1    0
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>b =
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>   21   39   21   30
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>Solution x =
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>   10   20   10
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>Residuals A x - b =
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>   -1    1   -1   -0
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>Sum of squared residuals
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    3
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>----------------------------------------------------------------------------
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>Modified solution x' (to show that it has a larger sum of squared residuals)
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>   11   19   10
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>Sum of squared residuals
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>    5
</span></code></pre></div>
<h4 id="why-calculate-the-sum-of-squared-residuals-and-why-modify-the-solution-to-increase-the-sum-of-squared-residuals">Why Calculate the Sum of Squared Residuals and Why Modify the Solution to Increase the Sum of Squared Residuals?<a class="headerlink" href="#why-calculate-the-sum-of-squared-residuals-and-why-modify-the-solution-to-increase-the-sum-of-squared-residuals" title="Permanent link">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Why Calculate the Sum of Squared Residuals?</p>
<p>The sum of squared residuals is a measure of how well the computed solution fits the data. It tells us how far off the computed values (from <span class="arithmatex">\(A × x\)</span>) are from the actual values in <span class="arithmatex">\(b\)</span>.</p>
<p>In a least-squares solution, this sum is minimised. By calculating it, the code verifies how close the solution is to the actual results. A smaller sum of squared residuals means a better fit.</p>
<div class="arithmatex">\[
Sum\_of\_Squared\_Residuals=(-1)^{2} + (1)^{2} + (-1)^{2} + 0^{2}=3
\]</div>
<p>A smaller sum indicates a better fit. In this case, a sum of 3 is reasonable and shows that the solution is a close approximation.</p>
</div>
<div class="admonition note">
<p class="admonition-title">What about the residual of <span class="arithmatex">\((-1, 1, -1, 0)\)</span>?</p>
<p>The residuals <span class="arithmatex">\(A × x - b\)</span> being <span class="arithmatex">\((-1, 1, -1, 0)\)</span> indicate that the least-squares solution is a close <strong>approximation</strong>, but not perfect.</p>
<p>However, in an over-determined system (more equations than unknowns, as here with 4 equations and 3 unknowns), an exact solution is usually not possible. The least-squares method tries to find a solution <span class="arithmatex">\(x\)</span> that minimizes the sum of the squared residuals.</p>
<p>This means that, when solving the system, the predictions for some rows of <span class="arithmatex">\(b\)</span> are slightly off:</p>
<ul>
<li>The first equation is off by -1 (under-predicted).</li>
<li>The second equation is off by 1 (over-predicted).</li>
<li>The third equation is off by -1 (under-predicted).</li>
<li>The fourth equation is off by 0 (almost perfect prediction).</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Why Modify the Solution to Increase the Sum of Squared Residuals?</p>
<p>In the second part of the code, the solution vector <span class="arithmatex">\(x\)</span> is manually modified:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span></code></pre></div>
<p>This shows what happens if the solution is <strong>perturbed</strong>. By changing <span class="arithmatex">\(x\)</span>, the code     demonstrates that the sum of squared residuals increases:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nb">sum</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">b_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">;</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Sum of squared residuals'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="nb">WriteLn</span><span class="p">(</span><span class="nb">sum</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p>The point of this modification is to highlight the importance of the least-squares solution. The original solution minimizes the residuals, but altering the solution results in a worse fit (higher residuals).</p>
<p>Deviating from the least-squares solution results in a higher sum of squared residuals, indicating a poorer fit.</p>
</div>
<h2 id="unit-eig-eigenvalues-and-eigenvectors">Unit <code>eig</code> - Eigenvalues and eigenvectors<a class="headerlink" href="#unit-eig-eigenvalues-and-eigenvectors" title="Permanent link">¶</a></h2>
<p>An <strong>eigenvector</strong> is a special type of vector that keeps its direction even when a linear transformation (like multiplying by a matrix) is applied to it.When you multiply a square matrix <span class="arithmatex">\(A\)</span> by a non-zero vector <span class="arithmatex">\(x\)</span> and the result is the same vector multiplied by a number (called a <strong>scalar</strong>), then:
  - <span class="arithmatex">\(x\)</span> is the eigenvector
  - The number is called the <strong>eigenvalue</strong> (represented by <span class="arithmatex">\(λ\)</span>).</p>
<div class="arithmatex">\[
\displaystyle{  A \mathbf{x} = \lambda \mathbf{x}  \qquad \Rightarrow \qquad  A \mathbf{x} - \lambda \mathbf{x} = 0   }
\]</div>
<p><strong>NumLib</strong> has tools to calculate eigenvalues and eigenvectors for different types of matrices. Each matrix type has two to four procedures with numbers 1 to 4 that indicate their complexity:</p>
<ul>
<li><strong>Procedures with "1":</strong> Calculate all eigenvalues.</li>
<li><strong>Procedures with "2":</strong> Calculate specific eigenvalues in a certain range.</li>
<li><strong>Procedures with "3":</strong> Calculate all eigenvalues and eigenvectors.</li>
<li><strong>Procedures with "4":</strong> Calculate specific eigenvalues and eigenvectors in a certain range.</li>
</ul>
<h3 id="matrices-with-general-storage">Matrices with General Storage<a class="headerlink" href="#matrices-with-general-storage" title="Permanent link">¶</a></h3>
<p>The routines assume the <span class="arithmatex">\(n \times n\)</span> matrix is stored as a 2D (or 1D) array of <strong>ArbFloat</strong> values.</p>
<p><strong>For Generic Matrices</strong></p>
<ul>
<li><strong>eigge1:</strong> Calculates all eigenvalues.</li>
<li><strong>eigge3:</strong> Calculates all eigenvalues and eigenvectors.</li>
</ul>
<p><strong>For Generic Symmetric Matrices</strong></p>
<ul>
<li><strong>eiggs1:</strong> Calculates all eigenvalues.</li>
<li><strong>eiggs2:</strong> Calculates some eigenvalues in a specific range.</li>
<li><strong>eiggs3:</strong> Calculates all eigenvalues and eigenvectors.</li>
<li><strong>eiggs4:</strong> Calculates some eigenvalues and eigenvectors in a specific range.</li>
</ul>
<p><strong>For Symmetric Positive Definite Matrices</strong></p>
<ul>
<li><strong>eiggg1:</strong> Calculates all eigenvalues.</li>
<li><strong>eiggg2:</strong> Calculates some eigenvalues in a specific range.</li>
</ul>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1">// Generic matrix (without any special symmetries)</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigge1</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">                      </span><span class="c1">// all eigenvalues</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigge3</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidtha</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="n">rwidthx</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// all eigenvalues and eigenvectors</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c1">// Generic symmetric matrix</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggs1</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">                     </span><span class="c1">// all eigenvalues</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggs2</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">             </span><span class="c1">// some eigenvalues (index k1..k2)</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggs3</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidtha</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">                 </span><span class="c1">// all eigenvalues and eigenvectors</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggs4</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidtha</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">         </span><span class="c1">// some eigenvalues and eigenvectors (index k1..k2)</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="c1">// Symmetric positive definite matrix</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggg1</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">                     </span><span class="c1">// all eigenvalues</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggg2</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidth</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">             </span><span class="c1">// some eigenvalues (index k1..k2)</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggg3</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidtha</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">                 </span><span class="c1">// all eigenvalues and eigenvectors</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eiggg4</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">rwidtha</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span><span class="w">         </span><span class="c1">// some eigenvalues and eigenvectors (index k1..k2)</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>a</code> is the first element of an array containing the matrix <span class="arithmatex">\(A\)</span> for which the eigenvalue/eigenvector has to be calculated. <ul>
<li>The array must be dimensioned to provide space for at least <span class="arithmatex">\(n^{2}\)</span> floating point values.</li>
</ul>
</li>
<li><code>n</code> specifies the size of the matrix <span class="arithmatex">\(A\)</span>, i.e. the number of rows or columns. Note that the input matrix must be square, i.e. the number of rows and columns is equal.</li>
<li><code>rwidth</code> is the allocated row length of the array a. It can be larger than n if the array is allocated larger than necessary, but normally <code>rwidth = n</code>.</li>
<li><code>lam</code> is the first element of an array receiving the calculated eigenvalues. <ul>
<li>In case of a generic matrix (<code>eigge1</code>, <code>eigge3</code>) the eigenvalues can be complex; therefore, the array must be dimensioned for values of type <code>complex</code> as declared in unit <code>typ</code>. </li>
<li>In the other cases (<code>eiggs1..4</code> or <code>eiggg1..4</code>) the eigenvalues are real, and the array must be dimensioned for datatype <code>ArbFloat</code>. </li>
<li>Since a <span class="arithmatex">\(n \times n\)</span> matrix has <span class="arithmatex">\(n\)</span> eigenvalues, the array must be allocated for at least <code>n</code> values, in case of the procedures with appended 2 or 4 only <code>k2-k1+1</code> values are sufficient (see below).</li>
</ul>
</li>
<li><code>term</code> returns an error code:<ul>
<li>1 -- successful calculation</li>
<li>2 -- calculation failed</li>
<li>3 -- error in input data: n&lt;1, k1&lt;1, k1&gt;k2, or k2&gt;n.</li>
</ul>
</li>
</ul>
<p>Additionally, in case of <code>eigge3</code>:</p>
<ul>
<li><code>x</code> is the first element of a matrix to receive the calculated eigenvectors. <ul>
<li>Again, the eigenvectors of a generic matrix can have complex components. Therefore, the matrix must be declared for the datatype <code>complex</code>, and it must be large enough to hold at least <span class="arithmatex">\(n^{2}\)</span> values. </li>
<li>If the matrix is symmetric or positive definite, the eigenvectors are real, and the array must be declared for datatype <code>ArbFloat</code>. In any case, the eigenvectors are normalized to unit length and arranged in the columns of this matrix.</li>
</ul>
</li>
<li><code>rwidthx</code> denotes the allocated row length of the matrix <span class="arithmatex">\(x\)</span>. Thus it is possible to dimension the result matrix larger than actually needed.</li>
</ul>
<p>Additionally, in case of procedures <code>eiggs2</code>, <code>eiggs4</code>, <code>eiggg2</code> and <code>eiggg4</code>:</p>
<ul>
<li><code>k1</code> and <code>k2</code> define the interval of indexes <code>k</code> for which the eigenvalues (<span class="arithmatex">\(\lambda k\)</span>) and eigenvalues (<span class="arithmatex">\(c_k\)</span>) are to be calculated. They are integers and must be ordered such that <span class="arithmatex">\(1&lt;=k1&lt;=k2&lt;=n\)</span>.</li>
</ul>
<p><strong>Example</strong></p>
<p>Calculate the eigenvalues and eigenvectors of the matrix.</p>
<div class="arithmatex">\[
\displaystyle{  A=
             \begin{bmatrix}
                 8 &amp; -1 &amp; -5 \\
                -4 &amp;  4 &amp; -2 \\
                18 &amp; -5 &amp; -7
             \end{bmatrix}
   }
   \]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span>
<span class="normal"><a href="#__codelineno-23-27">27</a></span>
<span class="normal"><a href="#__codelineno-23-28">28</a></span>
<span class="normal"><a href="#__codelineno-23-29">29</a></span>
<span class="normal"><a href="#__codelineno-23-30">30</a></span>
<span class="normal"><a href="#__codelineno-23-31">31</a></span>
<span class="normal"><a href="#__codelineno-23-32">32</a></span>
<span class="normal"><a href="#__codelineno-23-33">33</a></span>
<span class="normal"><a href="#__codelineno-23-34">34</a></span>
<span class="normal"><a href="#__codelineno-23-35">35</a></span>
<span class="normal"><a href="#__codelineno-23-36">36</a></span>
<span class="normal"><a href="#__codelineno-23-37">37</a></span>
<span class="normal"><a href="#__codelineno-23-38">38</a></span>
<span class="normal"><a href="#__codelineno-23-39">39</a></span>
<span class="normal"><a href="#__codelineno-23-40">40</a></span>
<span class="normal"><a href="#__codelineno-23-41">41</a></span>
<span class="normal"><a href="#__codelineno-23-42">42</a></span>
<span class="normal"><a href="#__codelineno-23-43">43</a></span>
<span class="normal"><a href="#__codelineno-23-44">44</a></span>
<span class="normal"><a href="#__codelineno-23-45">45</a></span>
<span class="normal"><a href="#__codelineno-23-46">46</a></span>
<span class="normal"><a href="#__codelineno-23-47">47</a></span>
<span class="normal"><a href="#__codelineno-23-48">48</a></span>
<span class="normal"><a href="#__codelineno-23-49">49</a></span>
<span class="normal"><a href="#__codelineno-23-50">50</a></span>
<span class="normal"><a href="#__codelineno-23-51">51</a></span>
<span class="normal"><a href="#__codelineno-23-52">52</a></span>
<span class="normal"><a href="#__codelineno-23-53">53</a></span>
<span class="normal"><a href="#__codelineno-23-54">54</a></span>
<span class="normal"><a href="#__codelineno-23-55">55</a></span>
<span class="normal"><a href="#__codelineno-23-56">56</a></span>
<span class="normal"><a href="#__codelineno-23-57">57</a></span>
<span class="normal"><a href="#__codelineno-23-58">58</a></span>
<span class="normal"><a href="#__codelineno-23-59">59</a></span>
<span class="normal"><a href="#__codelineno-23-60">60</a></span>
<span class="normal"><a href="#__codelineno-23-61">61</a></span>
<span class="normal"><a href="#__codelineno-23-62">62</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="k">program</span><span class="w"> </span><span class="n">eig_general_matrix</span><span class="o">;</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="k">uses</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">math</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">eig</span><span class="o">;</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="k">const</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">;</span><span class="w">         </span><span class="c1">// Size of the matrix where m (row) = n (row)</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="w">  </span><span class="n">dec_place</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">;</span><span class="w"> </span><span class="c1">// No of decimal place</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11"></a>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="k">var</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="w">  </span><span class="c1">// a is the input matrix</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="w">  </span><span class="n">mat_a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16"></a><span class="w">    </span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w">  </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">,</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="w">    </span><span class="p">(</span><span class="mi">18</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="w">  </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="w">  </span><span class="n">eig_values_lambda</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="w">  </span><span class="n">eig_vec_mat_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23"></a>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="nf">ComplexToStr</span><span class="p">(</span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="n">decimals</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="k">String</span><span class="o">;</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25"></a><span class="w">  </span><span class="k">var</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26"></a><span class="w">    </span><span class="n">sgn</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="kt">boolean</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s">'+'</span><span class="o">,</span><span class="w"> </span><span class="s">'-'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">Format</span><span class="p">(</span><span class="s">'%.*f %s %.*fi'</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="n">Decimals</span><span class="o">,</span><span class="w"> </span><span class="n">z</span><span class="o">.</span><span class="n">Re</span><span class="o">,</span><span class="w"> </span><span class="n">sgn</span><span class="p">[</span><span class="n">z</span><span class="o">.</span><span class="n">Im</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">Decimals</span><span class="o">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">Im</span><span class="p">)])</span><span class="o">;</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30"></a>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31"></a><span class="k">begin</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32"></a><span class="w">  </span><span class="c1">// write input matrix</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Matrix a = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="n">dec_place</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40"></a>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41"></a><span class="w">  </span><span class="c1">// Calculate eigenvalues/vectors</span>
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42"></a><span class="hll"><span class="w">  </span><span class="n">eigge3</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">eig_values_lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">eig_vec_mat_x</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43"></a>
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44"></a><span class="w">  </span><span class="c1">// write eigenvalues</span>
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Eigenvalues: lambda = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">ComplexToStr</span><span class="p">(</span><span class="n">eig_values_lambda</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">dec_place</span><span class="p">)</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-23-50"><a id="__codelineno-23-50" name="__codelineno-23-50"></a>
</span><span id="__span-23-51"><a id="__codelineno-23-51" name="__codelineno-23-51"></a><span class="w">  </span><span class="c1">// Write eigenvectors</span>
</span><span id="__span-23-52"><a id="__codelineno-23-52" name="__codelineno-23-52"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Eigenvectors (as columns): x = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-53"><a id="__codelineno-23-53" name="__codelineno-23-53"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-23-54"><a id="__codelineno-23-54" name="__codelineno-23-54"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-23-55"><a id="__codelineno-23-55" name="__codelineno-23-55"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">ComplexToStr</span><span class="p">(</span><span class="n">eig_vec_mat_x</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">dec_place</span><span class="p">)</span><span class="o">:</span><span class="mi">25</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-56"><a id="__codelineno-23-56" name="__codelineno-23-56"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-23-57"><a id="__codelineno-23-57" name="__codelineno-23-57"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-23-58"><a id="__codelineno-23-58" name="__codelineno-23-58"></a>
</span><span id="__span-23-59"><a id="__codelineno-23-59" name="__codelineno-23-59"></a><span class="w">  </span><span class="c1">// Pause console</span>
</span><span id="__span-23-60"><a id="__codelineno-23-60" name="__codelineno-23-60"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-23-61"><a id="__codelineno-23-61" name="__codelineno-23-61"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-23-62"><a id="__codelineno-23-62" name="__codelineno-23-62"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>Matrix a =
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>     8.000    -1.000    -5.000
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    -4.000     4.000    -2.000
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    18.000    -5.000    -7.000
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>Eigenvalues: lambda =
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>           2.000 + 4.000i           2.000 - 4.000i           1.000 + 0.000i
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>Eigenvectors (as columns): x =
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>           0.316 + 0.316i           0.316 - 0.316i           0.408 + 0.000i
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>           0.000 + 0.632i           0.000 - 0.632i           0.816 + 0.000i
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>           0.632 + 0.000i           0.632 + 0.000i           0.408 + 0.000i
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>Press enter to quit
</span></code></pre></div>
<h3 id="symmetric-band-matrices">Symmetric Band Matrices<a class="headerlink" href="#symmetric-band-matrices" title="Permanent link">¶</a></h3>
<p>NumLib provides four routines for calculating the eigenvalues and eigenvectors of <strong>symmetric band matrices</strong> (matrices with non-zero elements in a band around the main diagonal):</p>
<ol>
<li>
<p><strong>eigbs1</strong>: Calculates all eigenvalues.
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigbs1</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div><p></p>
</li>
<li>
<p><strong>eigbs2</strong>: Calculates some of the eigenvalues, within a specified range (from index <code>k1</code> to <code>k2</code>).
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigbs2</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div><p></p>
</li>
<li>
<p><strong>eigbs3</strong>: Calculates all eigenvalues and their corresponding eigenvectors.
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigbs3</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">rwidthx</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div><p></p>
</li>
<li>
<p><strong>eigbs4</strong>: Calculates some eigenvalues and their corresponding eigenvectors (within the range <code>k1</code> to <code>k2</code>).
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigbs4</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">rwidthx</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">m2</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div><p></p>
</li>
</ol>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong>a</strong>: This is the first element of a 1D array that contains the matrix's diagonal and left band elements. The right band is ignored because the matrix is symmetric. The array needs to be large enough to hold at least <code>n*(w+1) - (w*(w+1)) div 2</code> elements.</p>
</li>
<li>
<p><strong>n</strong>: The number of rows and columns in the matrix (since the matrix is square).</p>
</li>
<li>
<p><strong>w</strong>: The <strong>bandwidth</strong>, or the number of diagonals the band extends on either side of the main diagonal (the left and right bandwidth must be the same since the matrix is symmetric).</p>
</li>
<li>
<p><strong>lam</strong>: The first element of an array where the computed eigenvalues will be stored. Since a matrix of size <code>n x n</code> has <code>n</code> eigenvalues, this array should have space for at least <code>n</code> values of type <code>ArbFloat</code>.</p>
</li>
<li>
<p><strong>x</strong>: (Used in <code>eigbs3</code> and <code>eigbs4</code>) The first element of a matrix that will store the computed eigenvectors. The matrix must be large enough to hold at least <code>n x n</code> values and will contain the eigenvectors as columns. These vectors are normalized (scaled to unit length).</p>
</li>
<li>
<p><strong>rwidthx</strong>: (Used in <code>eigbs3</code> and <code>eigbs4</code>) The allocated row length for the eigenvector matrix <code>x</code>. This allows the matrix to be larger than needed if desired.</p>
</li>
<li>
<p><strong>k1, k2</strong>: (Used in <code>eigbs2</code> and <code>eigbs4</code>) These define the range of eigenvalues and eigenvectors to compute. For example, setting <code>k1 = 1</code> and <code>k2 = 3</code> calculates the first three eigenvalues and their vectors. The values must satisfy <code>1 &lt;= k1 &lt;= k2 &lt;= n</code>.</p>
</li>
<li>
<p><strong>m2</strong>: (Used in <code>eigbs4</code>) The index of the largest eigenvalue for which an eigenvector has been computed.</p>
</li>
<li>
<p><strong>term</strong>: A return code indicating the result:</p>
</li>
<li><strong>1</strong>: Calculation was successful.</li>
<li><strong>2</strong>: Calculation failed.</li>
<li><strong>3</strong>: There was an error in the input parameters, such as <code>n &lt; 1</code>, <code>w &lt; 0</code>, <code>w &gt;= n</code>, <code>k1 &lt; 1</code>, <code>k1 &gt; k2</code>, or <code>k2 &gt; n</code>.</li>
</ul>
<p>If the bandwidth <code>w</code> is larger than one-third of the matrix size (<code>n/3</code>), it is generally more efficient to compute all eigenvalues and eigenvectors, even if you don't need all of them.</p>
<p><strong>Example</strong></p>
<p>Calculate the eigenvalues and eigenvectors of the symmetric 7 x 7 matrix </p>
<div class="arithmatex">\[
\displaystyle{  A=
 \begin{bmatrix}
  5 &amp; -4 &amp; 1 &amp;  &amp;  &amp;  &amp; 0 \\
 -4 &amp; 6  &amp; -4 &amp; 1 &amp;  &amp;  &amp;  \\
  1 &amp; -4 &amp; 6  &amp; -4 &amp; 1 &amp;  &amp;  \\
   &amp; 1 &amp; -4 &amp; 6 &amp; -4 &amp; 1 &amp;  \\
   &amp;  &amp; 1 &amp; -4 &amp; 6 &amp; -4 &amp; 1 \\
   &amp;  &amp;  &amp; 1 &amp; -4 &amp; 6 &amp; -4 \\
 0 &amp;  &amp;  &amp;  &amp; 1 &amp; -4 &amp; 5
 \end{bmatrix}
 }
\]</div>
<p>The eigenvalues are </p>
<div class="arithmatex">\[
\displaystyle{ \lambda_k = 16\sin^{4}\frac{k\pi}{16}, \qquad k=1,2,\ldots,7 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">  1</a></span>
<span class="normal"><a href="#__codelineno-29-2">  2</a></span>
<span class="normal"><a href="#__codelineno-29-3">  3</a></span>
<span class="normal"><a href="#__codelineno-29-4">  4</a></span>
<span class="normal"><a href="#__codelineno-29-5">  5</a></span>
<span class="normal"><a href="#__codelineno-29-6">  6</a></span>
<span class="normal"><a href="#__codelineno-29-7">  7</a></span>
<span class="normal"><a href="#__codelineno-29-8">  8</a></span>
<span class="normal"><a href="#__codelineno-29-9">  9</a></span>
<span class="normal"><a href="#__codelineno-29-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-29-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-29-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-29-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-29-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-29-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-29-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-29-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-29-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-29-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-29-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-29-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-29-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-29-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-29-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-29-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-29-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-29-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-29-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-29-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-29-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-29-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-29-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-29-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-29-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-29-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-29-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-29-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-29-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-29-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-29-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-29-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-29-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-29-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-29-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-29-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-29-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-29-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-29-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-29-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-29-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-29-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-29-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-29-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-29-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-29-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-29-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-29-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-29-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-29-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-29-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-29-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-29-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-29-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-29-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-29-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-29-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-29-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-29-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-29-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-29-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-29-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-29-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-29-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-29-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-29-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-29-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-29-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-29-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-29-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-29-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-29-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-29-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-29-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-29-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-29-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-29-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-29-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-29-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-29-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-29-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-29-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-29-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-29-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-29-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-29-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-29-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-29-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-29-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-29-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-29-100">100</a></span>
<span class="normal"><a href="#__codelineno-29-101">101</a></span>
<span class="normal"><a href="#__codelineno-29-102">102</a></span>
<span class="normal"><a href="#__codelineno-29-103">103</a></span>
<span class="normal"><a href="#__codelineno-29-104">104</a></span>
<span class="normal"><a href="#__codelineno-29-105">105</a></span>
<span class="normal"><a href="#__codelineno-29-106">106</a></span>
<span class="normal"><a href="#__codelineno-29-107">107</a></span>
<span class="normal"><a href="#__codelineno-29-108">108</a></span>
<span class="normal"><a href="#__codelineno-29-109">109</a></span>
<span class="normal"><a href="#__codelineno-29-110">110</a></span>
<span class="normal"><a href="#__codelineno-29-111">111</a></span>
<span class="normal"><a href="#__codelineno-29-112">112</a></span>
<span class="normal"><a href="#__codelineno-29-113">113</a></span>
<span class="normal"><a href="#__codelineno-29-114">114</a></span>
<span class="normal"><a href="#__codelineno-29-115">115</a></span>
<span class="normal"><a href="#__codelineno-29-116">116</a></span>
<span class="normal"><a href="#__codelineno-29-117">117</a></span>
<span class="normal"><a href="#__codelineno-29-118">118</a></span>
<span class="normal"><a href="#__codelineno-29-119">119</a></span>
<span class="normal"><a href="#__codelineno-29-120">120</a></span>
<span class="normal"><a href="#__codelineno-29-121">121</a></span>
<span class="normal"><a href="#__codelineno-29-122">122</a></span>
<span class="normal"><a href="#__codelineno-29-123">123</a></span>
<span class="normal"><a href="#__codelineno-29-124">124</a></span>
<span class="normal"><a href="#__codelineno-29-125">125</a></span>
<span class="normal"><a href="#__codelineno-29-126">126</a></span>
<span class="normal"><a href="#__codelineno-29-127">127</a></span>
<span class="normal"><a href="#__codelineno-29-128">128</a></span>
<span class="normal"><a href="#__codelineno-29-129">129</a></span>
<span class="normal"><a href="#__codelineno-29-130">130</a></span>
<span class="normal"><a href="#__codelineno-29-131">131</a></span>
<span class="normal"><a href="#__codelineno-29-132">132</a></span>
<span class="normal"><a href="#__codelineno-29-133">133</a></span>
<span class="normal"><a href="#__codelineno-29-134">134</a></span>
<span class="normal"><a href="#__codelineno-29-135">135</a></span>
<span class="normal"><a href="#__codelineno-29-136">136</a></span>
<span class="normal"><a href="#__codelineno-29-137">137</a></span>
<span class="normal"><a href="#__codelineno-29-138">138</a></span>
<span class="normal"><a href="#__codelineno-29-139">139</a></span>
<span class="normal"><a href="#__codelineno-29-140">140</a></span>
<span class="normal"><a href="#__codelineno-29-141">141</a></span>
<span class="normal"><a href="#__codelineno-29-142">142</a></span>
<span class="normal"><a href="#__codelineno-29-143">143</a></span>
<span class="normal"><a href="#__codelineno-29-144">144</a></span>
<span class="normal"><a href="#__codelineno-29-145">145</a></span>
<span class="normal"><a href="#__codelineno-29-146">146</a></span>
<span class="normal"><a href="#__codelineno-29-147">147</a></span>
<span class="normal"><a href="#__codelineno-29-148">148</a></span>
<span class="normal"><a href="#__codelineno-29-149">149</a></span>
<span class="normal"><a href="#__codelineno-29-150">150</a></span>
<span class="normal"><a href="#__codelineno-29-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">program</span><span class="w"> </span><span class="n">eig_symband_matrix</span><span class="o">;</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="k">uses</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">math</span><span class="o">,</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">eig</span><span class="o">;</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="k">const</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="w">  </span><span class="n">n_mat_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="o">;</span><span class="w">    </span><span class="c1">// Size of the matrix (n x n matrix)</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="w">  </span><span class="n">w_band_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span><span class="w">   </span><span class="c1">// Bandwidth of the matrix (how many diagonals on either side of the main diagonal)</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12"></a>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="w">  </span><span class="c1">// Total number of elements in the 1D array representing the matrix's diagonals</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="w">  </span><span class="n">n_diag_elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">w_band_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">w_band_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">w_band_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">div</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15"></a>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="w">  </span><span class="n">decimal_place</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">;</span><span class="w"> </span><span class="c1">// Number of decimal places for output</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17"></a>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18"></a><span class="c1">// Converts a matrix index (i, j) into the corresponding 1D array index for a band matrix</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19"></a><span class="k">function</span><span class="w"> </span><span class="nf">MatrixIndexToArrayIndex</span><span class="p">(</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20"></a>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21"></a><span class="w">  </span><span class="c1">// Calculates the starting index for a given diagonal element</span>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="nf">DiagElementIndex</span><span class="p">(</span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23"></a><span class="w">  </span><span class="k">var</span>
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24"></a><span class="w">    </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28"></a><span class="w">      </span><span class="k">exit</span><span class="o">;</span>
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29"></a><span class="w">    </span><span class="c1">// For diagonals truncated at the left side of the matrix</span>
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31"></a><span class="w">      </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="bp">Result</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">;</span>
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33"></a><span class="w">        </span><span class="k">exit</span><span class="o">;</span>
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-35"><a id="__codelineno-29-35" name="__codelineno-29-35"></a><span class="w">    </span><span class="c1">// For full rows and diagonals truncated on the right side</span>
</span><span id="__span-29-36"><a id="__codelineno-29-36" name="__codelineno-29-36"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-37"><a id="__codelineno-29-37" name="__codelineno-29-37"></a><span class="w">      </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="bp">Result</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-29-38"><a id="__codelineno-29-38" name="__codelineno-29-38"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-39"><a id="__codelineno-29-39" name="__codelineno-29-39"></a><span class="w">        </span><span class="k">exit</span><span class="o">;</span>
</span><span id="__span-29-40"><a id="__codelineno-29-40" name="__codelineno-29-40"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-41"><a id="__codelineno-29-41" name="__codelineno-29-41"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">n</span><span class="o">;</span>
</span><span id="__span-29-42"><a id="__codelineno-29-42" name="__codelineno-29-42"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-43"><a id="__codelineno-29-43" name="__codelineno-29-43"></a>
</span><span id="__span-29-44"><a id="__codelineno-29-44" name="__codelineno-29-44"></a><span class="k">var</span>
</span><span id="__span-29-45"><a id="__codelineno-29-45" name="__codelineno-29-45"></a><span class="w">  </span><span class="n">d</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>
</span><span id="__span-29-46"><a id="__codelineno-29-46" name="__codelineno-29-46"></a><span class="k">begin</span>
</span><span id="__span-29-47"><a id="__codelineno-29-47" name="__codelineno-29-47"></a><span class="w">  </span><span class="c1">// Ensures that we always access the upper diagonal by swapping (i, j) if necessary</span>
</span><span id="__span-29-48"><a id="__codelineno-29-48" name="__codelineno-29-48"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-49"><a id="__codelineno-29-49" name="__codelineno-29-49"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">MatrixIndexToArrayIndex</span><span class="p">(</span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-50"><a id="__codelineno-29-50" name="__codelineno-29-50"></a><span class="w">    </span><span class="k">exit</span><span class="o">;</span>
</span><span id="__span-29-51"><a id="__codelineno-29-51" name="__codelineno-29-51"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-52"><a id="__codelineno-29-52" name="__codelineno-29-52"></a>
</span><span id="__span-29-53"><a id="__codelineno-29-53" name="__codelineno-29-53"></a><span class="w">  </span><span class="c1">// Get the starting index of the diagonal element in the 1D array</span>
</span><span id="__span-29-54"><a id="__codelineno-29-54" name="__codelineno-29-54"></a><span class="w">  </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">DiagElementIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-55"><a id="__codelineno-29-55" name="__codelineno-29-55"></a>
</span><span id="__span-29-56"><a id="__codelineno-29-56" name="__codelineno-29-56"></a><span class="w">  </span><span class="c1">// If i = j, we are on the main diagonal</span>
</span><span id="__span-29-57"><a id="__codelineno-29-57" name="__codelineno-29-57"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-58"><a id="__codelineno-29-58" name="__codelineno-29-58"></a><span class="w">    </span><span class="k">exit</span><span class="o">;</span>
</span><span id="__span-29-59"><a id="__codelineno-29-59" name="__codelineno-29-59"></a>
</span><span id="__span-29-60"><a id="__codelineno-29-60" name="__codelineno-29-60"></a><span class="w">  </span><span class="c1">// Calculate the offset for the element in the band</span>
</span><span id="__span-29-61"><a id="__codelineno-29-61" name="__codelineno-29-61"></a><span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="o">;</span>
</span><span id="__span-29-62"><a id="__codelineno-29-62" name="__codelineno-29-62"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-63"><a id="__codelineno-29-63" name="__codelineno-29-63"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="c1">// Element is outside the bandwidth, return -1 to indicate zero</span>
</span><span id="__span-29-64"><a id="__codelineno-29-64" name="__codelineno-29-64"></a><span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-65"><a id="__codelineno-29-65" name="__codelineno-29-65"></a><span class="w">    </span><span class="nb">dec</span><span class="p">(</span><span class="bp">Result</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Adjust the index for the diagonal element</span>
</span><span id="__span-29-66"><a id="__codelineno-29-66" name="__codelineno-29-66"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="bp">Result</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-67"><a id="__codelineno-29-67" name="__codelineno-29-67"></a><span class="w">      </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">;</span><span class="w"> </span><span class="c1">// Invalid index (out of bounds)</span>
</span><span id="__span-29-68"><a id="__codelineno-29-68" name="__codelineno-29-68"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-69"><a id="__codelineno-29-69" name="__codelineno-29-69"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-70"><a id="__codelineno-29-70" name="__codelineno-29-70"></a>
</span><span id="__span-29-71"><a id="__codelineno-29-71" name="__codelineno-29-71"></a><span class="k">var</span>
</span><span id="__span-29-72"><a id="__codelineno-29-72" name="__codelineno-29-72"></a><span class="w">  </span><span class="c1">// Array to hold the elements of the banded matrix (diagonal and left band)</span>
</span><span id="__span-29-73"><a id="__codelineno-29-73" name="__codelineno-29-73"></a><span class="w">  </span><span class="n">mat_a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_diag_elements</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-29-74"><a id="__codelineno-29-74" name="__codelineno-29-74"></a><span class="w">     </span><span class="mi">5</span><span class="o">,</span><span class="w">   </span><span class="c1">// Main diagonal element (row 1, col 1)</span>
</span><span id="__span-29-75"><a id="__codelineno-29-75" name="__codelineno-29-75"></a><span class="w">    </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w">   </span><span class="c1">// Row 2 (left band and main diagonal)</span>
</span><span id="__span-29-76"><a id="__codelineno-29-76" name="__codelineno-29-76"></a><span class="w">     </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w">   </span><span class="c1">// Row 3 (two left band, main diagonal)</span>
</span><span id="__span-29-77"><a id="__codelineno-29-77" name="__codelineno-29-77"></a><span class="w">         </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w">   </span><span class="c1">// Row 4, (two left band, main diagonal)</span>
</span><span id="__span-29-78"><a id="__codelineno-29-78" name="__codelineno-29-78"></a><span class="w">             </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span><span class="w">  </span><span class="c1">// Row 5, the same ...</span>
</span><span id="__span-29-79"><a id="__codelineno-29-79" name="__codelineno-29-79"></a><span class="w">                 </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="o">,</span>
</span><span id="__span-29-80"><a id="__codelineno-29-80" name="__codelineno-29-80"></a><span class="w">                     </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-81"><a id="__codelineno-29-81" name="__codelineno-29-81"></a>
</span><span id="__span-29-82"><a id="__codelineno-29-82" name="__codelineno-29-82"></a><span class="w">  </span><span class="c1">// Array to store the calculated eigenvalues</span>
</span><span id="__span-29-83"><a id="__codelineno-29-83" name="__codelineno-29-83"></a><span class="w">  </span><span class="n">eig_values_lambda</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-29-84"><a id="__codelineno-29-84" name="__codelineno-29-84"></a>
</span><span id="__span-29-85"><a id="__codelineno-29-85" name="__codelineno-29-85"></a><span class="w">  </span><span class="c1">// Matrix to store the calculated eigenvectors</span>
</span><span id="__span-29-86"><a id="__codelineno-29-86" name="__codelineno-29-86"></a><span class="w">  </span><span class="n">eig_vectors_mat_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-29-87"><a id="__codelineno-29-87" name="__codelineno-29-87"></a>
</span><span id="__span-29-88"><a id="__codelineno-29-88" name="__codelineno-29-88"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span><span class="w"> </span><span class="c1">// Variable for capturing the result of the eigenvalue/eigenvector calculation</span>
</span><span id="__span-29-89"><a id="__codelineno-29-89" name="__codelineno-29-89"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span><span class="w">  </span><span class="c1">// Loop counters</span>
</span><span id="__span-29-90"><a id="__codelineno-29-90" name="__codelineno-29-90"></a>
</span><span id="__span-29-91"><a id="__codelineno-29-91" name="__codelineno-29-91"></a><span class="k">begin</span>
</span><span id="__span-29-92"><a id="__codelineno-29-92" name="__codelineno-29-92"></a><span class="w">  </span><span class="c1">// Display matrix information</span>
</span><span id="__span-29-93"><a id="__codelineno-29-93" name="__codelineno-29-93"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'n = '</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-94"><a id="__codelineno-29-94" name="__codelineno-29-94"></a><span class="w">  </span><span class="nb">Writeln</span><span class="p">(</span><span class="s">'(One-sided) band width w = '</span><span class="o">,</span><span class="w"> </span><span class="n">w_band_size</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-95"><a id="__codelineno-29-95" name="__codelineno-29-95"></a>
</span><span id="__span-29-96"><a id="__codelineno-29-96" name="__codelineno-29-96"></a><span class="w">  </span><span class="c1">// Print diagonal elements of the band matrix</span>
</span><span id="__span-29-97"><a id="__codelineno-29-97" name="__codelineno-29-97"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Diagonal elements of A = '</span><span class="o">,</span><span class="w"> </span><span class="n">mat_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-98"><a id="__codelineno-29-98" name="__codelineno-29-98"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_diag_elements</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-29-99"><a id="__codelineno-29-99" name="__codelineno-29-99"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-100"><a id="__codelineno-29-100" name="__codelineno-29-100"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-101"><a id="__codelineno-29-101" name="__codelineno-29-101"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-102"><a id="__codelineno-29-102" name="__codelineno-29-102"></a>
</span><span id="__span-29-103"><a id="__codelineno-29-103" name="__codelineno-29-103"></a><span class="w">  </span><span class="c1">// Reconstruct and display the full symmetric band matrix from the 1D array (for verification purposes)</span>
</span><span id="__span-29-104"><a id="__codelineno-29-104" name="__codelineno-29-104"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Reconstructed A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-105"><a id="__codelineno-29-105" name="__codelineno-29-105"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-106"><a id="__codelineno-29-106" name="__codelineno-29-106"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-107"><a id="__codelineno-29-107" name="__codelineno-29-107"></a><span class="w">      </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">MatrixIndexToArrayIndex</span><span class="p">(</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">w_band_size</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Get the 1D array index for the element (i, j)</span>
</span><span id="__span-29-108"><a id="__codelineno-29-108" name="__codelineno-29-108"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-109"><a id="__codelineno-29-109" name="__codelineno-29-109"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="mf">0.0</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Print 0 if the element is outside the band</span>
</span><span id="__span-29-110"><a id="__codelineno-29-110" name="__codelineno-29-110"></a><span class="w">      </span><span class="k">else</span>
</span><span id="__span-29-111"><a id="__codelineno-29-111" name="__codelineno-29-111"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Print the matrix element</span>
</span><span id="__span-29-112"><a id="__codelineno-29-112" name="__codelineno-29-112"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-113"><a id="__codelineno-29-113" name="__codelineno-29-113"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-114"><a id="__codelineno-29-114" name="__codelineno-29-114"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-115"><a id="__codelineno-29-115" name="__codelineno-29-115"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-116"><a id="__codelineno-29-116" name="__codelineno-29-116"></a>
</span><span id="__span-29-117"><a id="__codelineno-29-117" name="__codelineno-29-117"></a><span class="w">  </span><span class="c1">// Call NumLib to calculate all eigenvalues and eigenvectors (eigbs3)</span>
</span><span id="__span-29-118"><a id="__codelineno-29-118" name="__codelineno-29-118"></a><span class="hll"><span class="w">  </span><span class="n">eigbs3</span><span class="p">(</span><span class="n">mat_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">w_band_size</span><span class="o">,</span><span class="w"> </span><span class="n">eig_values_lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">eig_vectors_mat_x</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-29-119"><a id="__codelineno-29-119" name="__codelineno-29-119"></a>
</span><span id="__span-29-120"><a id="__codelineno-29-120" name="__codelineno-29-120"></a><span class="w">  </span><span class="c1">// Check if the calculation was successful</span>
</span><span id="__span-29-121"><a id="__codelineno-29-121" name="__codelineno-29-121"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-122"><a id="__codelineno-29-122" name="__codelineno-29-122"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'term = '</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">,</span><span class="w"> </span><span class="s">' --&gt; ERROR'</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Error message in case of failure</span>
</span><span id="__span-29-123"><a id="__codelineno-29-123" name="__codelineno-29-123"></a><span class="w">    </span><span class="nb">halt</span><span class="o">;</span>
</span><span id="__span-29-124"><a id="__codelineno-29-124" name="__codelineno-29-124"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-125"><a id="__codelineno-29-125" name="__codelineno-29-125"></a>
</span><span id="__span-29-126"><a id="__codelineno-29-126" name="__codelineno-29-126"></a><span class="w">  </span><span class="c1">// Display expected eigenvalues for reference (example)</span>
</span><span id="__span-29-127"><a id="__codelineno-29-127" name="__codelineno-29-127"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Expected eigenvalues:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-128"><a id="__codelineno-29-128" name="__codelineno-29-128"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-29-129"><a id="__codelineno-29-129" name="__codelineno-29-129"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="mi">16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">intpower</span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="n">decimal_place</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Compute and print expected eigenvalues</span>
</span><span id="__span-29-130"><a id="__codelineno-29-130" name="__codelineno-29-130"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-131"><a id="__codelineno-29-131" name="__codelineno-29-131"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-132"><a id="__codelineno-29-132" name="__codelineno-29-132"></a>
</span><span id="__span-29-133"><a id="__codelineno-29-133" name="__codelineno-29-133"></a><span class="w">  </span><span class="c1">// Print the calculated eigenvalues</span>
</span><span id="__span-29-134"><a id="__codelineno-29-134" name="__codelineno-29-134"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Calculated eigenvalues: lambda = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-135"><a id="__codelineno-29-135" name="__codelineno-29-135"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-29-136"><a id="__codelineno-29-136" name="__codelineno-29-136"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">eig_values_lambda</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="n">decimal_place</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Print each eigenvalue</span>
</span><span id="__span-29-137"><a id="__codelineno-29-137" name="__codelineno-29-137"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-138"><a id="__codelineno-29-138" name="__codelineno-29-138"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-139"><a id="__codelineno-29-139" name="__codelineno-29-139"></a>
</span><span id="__span-29-140"><a id="__codelineno-29-140" name="__codelineno-29-140"></a><span class="w">  </span><span class="c1">// Print the calculated eigenvectors (one per column)</span>
</span><span id="__span-29-141"><a id="__codelineno-29-141" name="__codelineno-29-141"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Eigenvectors (as columns): x = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-142"><a id="__codelineno-29-142" name="__codelineno-29-142"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-29-143"><a id="__codelineno-29-143" name="__codelineno-29-143"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-29-144"><a id="__codelineno-29-144" name="__codelineno-29-144"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">eig_vectors_mat_x</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="n">decimal_place</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Print each element of the eigenvector matrix</span>
</span><span id="__span-29-145"><a id="__codelineno-29-145" name="__codelineno-29-145"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-29-146"><a id="__codelineno-29-146" name="__codelineno-29-146"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-29-147"><a id="__codelineno-29-147" name="__codelineno-29-147"></a>
</span><span id="__span-29-148"><a id="__codelineno-29-148" name="__codelineno-29-148"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-29-149"><a id="__codelineno-29-149" name="__codelineno-29-149"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-29-150"><a id="__codelineno-29-150" name="__codelineno-29-150"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-29-151"><a id="__codelineno-29-151" name="__codelineno-29-151"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>n = 7
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>(One-sided) band width w = 2
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>Diagonal elements of A = 5 -4  6  1 -4  6  1 -4  6  1 -4  6  1 -4  6  1 -4  5
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>Reconstructed A =
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>  5 -4  1  0  0  0  0
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a> -4  6 -4  1  0  0  0
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>  1 -4  6 -4  1  0  0
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>  0  1 -4  6 -4  1  0
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>  0  0  1 -4  6 -4  1
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>  0  0  0  1 -4  6 -4
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>  0  0  0  0  1 -4  5
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>Expected eigenvalues:
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>          0.023          0.343          1.524          4.000          7.647         11.657         14.805
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>Calculated eigenvalues: lambda =
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>          0.023          0.343          1.524          4.000          7.647         11.657         14.805
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>Eigenvectors (as columns): x =
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>         -0.191         -0.354          0.462          0.500          0.462          0.354          0.191
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>         -0.354         -0.500          0.354          0.000         -0.354         -0.500         -0.354
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>         -0.462         -0.354         -0.191         -0.500         -0.191          0.354          0.462
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>         -0.500         -0.000         -0.500          0.000          0.500          0.000         -0.500
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>         -0.462          0.354         -0.191          0.500         -0.191         -0.354          0.462
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>         -0.354          0.500          0.354         -0.000         -0.354          0.500         -0.354
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a>         -0.191          0.354          0.462         -0.500          0.462         -0.354          0.191
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>Press enter to quit
</span></code></pre></div>
<h3 id="symmetric-tridiagonal-matrices">Symmetric Tridiagonal Matrices<a class="headerlink" href="#symmetric-tridiagonal-matrices" title="Permanent link">¶</a></h3>
<p>Symmetric tridiagonal matrices can be handled using the following routines: <code>eigts1</code>, <code>eigts2</code>, <code>eigts3</code>, and <code>eigts4</code>.</p>
<ol>
<li>
<p><strong>All Eigenvalues</strong><br>
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigts1</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">cd</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
   This procedure computes all eigenvalues of the matrix.<p></p>
</li>
<li>
<p><strong>Some Eigenvalues (with indices k1..k2)</strong><br>
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigts2</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">cd</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
   This computes the eigenvalues within the index range <code>k1</code> to <code>k2</code>.<p></p>
</li>
<li>
<p><strong>All Eigenvalues and Eigenvectors</strong><br>
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigts3</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">cd</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
   This calculates all eigenvalues and their corresponding eigenvectors.<p></p>
</li>
<li>
<p><strong>Some Eigenvalues and Eigenvectors (with indices k1..k2)</strong><br>
   </p><div class="language-pascal highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">eigts4</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">cd</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">k1</span><span class="o">,</span><span class="w"> </span><span class="n">k2</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">lam</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">rwidth</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">m2</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
   This computes eigenvalues and eigenvectors within the specified index range <code>k1</code> to <code>k2</code>.<p></p>
</li>
</ol>
<hr>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>d</strong>: A 1D array representing the main diagonal of the matrix. It must contain at least <code>n</code> elements.</li>
<li><strong>cd</strong>: A 1D array representing the subdiagonal of the matrix. It must have at least <code>n-1</code> elements.</li>
<li><strong>n</strong>: The size of the matrix (number of rows or columns), which must be square.</li>
<li><strong>k1, k2</strong>: The index range for the eigenvalues and eigenvectors to be calculated, where <code>1 &lt;= k1 &lt;= k2 &lt;= n</code>.</li>
<li><strong>lam</strong>: A 1D array to store the calculated eigenvalues. For routines <code>eigts1</code> and <code>eigts3</code>, it must contain at least <code>n</code> elements. For <code>eigts2</code> and <code>eigts4</code>, it only needs to store <code>k2 - k1 + 1</code> elements.</li>
<li><strong>x</strong>: A 2D array to store the calculated eigenvectors. For <code>eigts3</code>, the array must have at least <code>n^2</code> elements. For <code>eigts4</code>, it must provide space for <code>n * (k2 - k1 + 1)</code> elements. Eigenvectors are normalized to unit length and stored in columns.</li>
<li><strong>rwidth</strong>: The row length of the matrix <code>x</code>. This allows the result matrix to be dimensioned larger than necessary.</li>
<li><strong>term</strong>: An error code returned after calculation:</li>
<li><code>1</code>: Successful calculation.</li>
<li><code>2</code>: Calculation failed.</li>
<li><code>3</code>: Error in input data (e.g., <code>n &lt; 1</code>, <code>k1 &lt; 1</code>, <code>k1 &gt; k2</code>, or <code>k2 &gt; n</code>).</li>
</ul>
<p>This explanation organizes the routines, clearly defines the parameters, and explains the error codes in a structured way for easier understanding.</p>
<p><strong>Example</strong></p>
<p>Calculate eigenvalues and eigenvectors of the matrix:</p>
<div class="arithmatex">\[
\displaystyle{  A=
 \begin{bmatrix}
  1 &amp; 1 &amp; 0 &amp; 0 \\
  1 &amp; 1 &amp; 2 &amp; 0 \\
  0 &amp; 2 &amp; 1 &amp; 1 \\
  0 &amp; 0 &amp; 1 &amp; 1
 \end{bmatrix}
 }
\]</div>
<p>The expected eigenvalues are:</p>
<div class="arithmatex">\[
\displaystyle{  -\sqrt{2},\ 2-\sqrt{2},\ \sqrt{2},\ 2+\sqrt{2} }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span>
<span class="normal"><a href="#__codelineno-35-15">15</a></span>
<span class="normal"><a href="#__codelineno-35-16">16</a></span>
<span class="normal"><a href="#__codelineno-35-17">17</a></span>
<span class="normal"><a href="#__codelineno-35-18">18</a></span>
<span class="normal"><a href="#__codelineno-35-19">19</a></span>
<span class="normal"><a href="#__codelineno-35-20">20</a></span>
<span class="normal"><a href="#__codelineno-35-21">21</a></span>
<span class="normal"><a href="#__codelineno-35-22">22</a></span>
<span class="normal"><a href="#__codelineno-35-23">23</a></span>
<span class="normal"><a href="#__codelineno-35-24">24</a></span>
<span class="normal"><a href="#__codelineno-35-25">25</a></span>
<span class="normal"><a href="#__codelineno-35-26">26</a></span>
<span class="normal"><a href="#__codelineno-35-27">27</a></span>
<span class="normal"><a href="#__codelineno-35-28">28</a></span>
<span class="normal"><a href="#__codelineno-35-29">29</a></span>
<span class="normal"><a href="#__codelineno-35-30">30</a></span>
<span class="normal"><a href="#__codelineno-35-31">31</a></span>
<span class="normal"><a href="#__codelineno-35-32">32</a></span>
<span class="normal"><a href="#__codelineno-35-33">33</a></span>
<span class="normal"><a href="#__codelineno-35-34">34</a></span>
<span class="normal"><a href="#__codelineno-35-35">35</a></span>
<span class="normal"><a href="#__codelineno-35-36">36</a></span>
<span class="normal"><a href="#__codelineno-35-37">37</a></span>
<span class="normal"><a href="#__codelineno-35-38">38</a></span>
<span class="normal"><a href="#__codelineno-35-39">39</a></span>
<span class="normal"><a href="#__codelineno-35-40">40</a></span>
<span class="normal"><a href="#__codelineno-35-41">41</a></span>
<span class="normal"><a href="#__codelineno-35-42">42</a></span>
<span class="normal"><a href="#__codelineno-35-43">43</a></span>
<span class="normal"><a href="#__codelineno-35-44">44</a></span>
<span class="normal"><a href="#__codelineno-35-45">45</a></span>
<span class="normal"><a href="#__codelineno-35-46">46</a></span>
<span class="normal"><a href="#__codelineno-35-47">47</a></span>
<span class="normal"><a href="#__codelineno-35-48">48</a></span>
<span class="normal"><a href="#__codelineno-35-49">49</a></span>
<span class="normal"><a href="#__codelineno-35-50">50</a></span>
<span class="normal"><a href="#__codelineno-35-51">51</a></span>
<span class="normal"><a href="#__codelineno-35-52">52</a></span>
<span class="normal"><a href="#__codelineno-35-53">53</a></span>
<span class="normal"><a href="#__codelineno-35-54">54</a></span>
<span class="normal"><a href="#__codelineno-35-55">55</a></span>
<span class="normal"><a href="#__codelineno-35-56">56</a></span>
<span class="normal"><a href="#__codelineno-35-57">57</a></span>
<span class="normal"><a href="#__codelineno-35-58">58</a></span>
<span class="normal"><a href="#__codelineno-35-59">59</a></span>
<span class="normal"><a href="#__codelineno-35-60">60</a></span>
<span class="normal"><a href="#__codelineno-35-61">61</a></span>
<span class="normal"><a href="#__codelineno-35-62">62</a></span>
<span class="normal"><a href="#__codelineno-35-63">63</a></span>
<span class="normal"><a href="#__codelineno-35-64">64</a></span>
<span class="normal"><a href="#__codelineno-35-65">65</a></span>
<span class="normal"><a href="#__codelineno-35-66">66</a></span>
<span class="normal"><a href="#__codelineno-35-67">67</a></span>
<span class="normal"><a href="#__codelineno-35-68">68</a></span>
<span class="normal"><a href="#__codelineno-35-69">69</a></span>
<span class="normal"><a href="#__codelineno-35-70">70</a></span>
<span class="normal"><a href="#__codelineno-35-71">71</a></span>
<span class="normal"><a href="#__codelineno-35-72">72</a></span>
<span class="normal"><a href="#__codelineno-35-73">73</a></span>
<span class="normal"><a href="#__codelineno-35-74">74</a></span>
<span class="normal"><a href="#__codelineno-35-75">75</a></span>
<span class="normal"><a href="#__codelineno-35-76">76</a></span>
<span class="normal"><a href="#__codelineno-35-77">77</a></span>
<span class="normal"><a href="#__codelineno-35-78">78</a></span>
<span class="normal"><a href="#__codelineno-35-79">79</a></span>
<span class="normal"><a href="#__codelineno-35-80">80</a></span>
<span class="normal"><a href="#__codelineno-35-81">81</a></span>
<span class="normal"><a href="#__codelineno-35-82">82</a></span>
<span class="normal"><a href="#__codelineno-35-83">83</a></span>
<span class="normal"><a href="#__codelineno-35-84">84</a></span>
<span class="normal"><a href="#__codelineno-35-85">85</a></span>
<span class="normal"><a href="#__codelineno-35-86">86</a></span>
<span class="normal"><a href="#__codelineno-35-87">87</a></span>
<span class="normal"><a href="#__codelineno-35-88">88</a></span>
<span class="normal"><a href="#__codelineno-35-89">89</a></span>
<span class="normal"><a href="#__codelineno-35-90">90</a></span>
<span class="normal"><a href="#__codelineno-35-91">91</a></span>
<span class="normal"><a href="#__codelineno-35-92">92</a></span>
<span class="normal"><a href="#__codelineno-35-93">93</a></span>
<span class="normal"><a href="#__codelineno-35-94">94</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="hll"><span class="k">program</span><span class="w"> </span><span class="n">eig_symtridiag_matrix</span><span class="o">;</span>
</span></span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="k">uses</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">eig</span><span class="o">;</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7"></a>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="k">const</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="w">  </span><span class="n">n_mat_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">;</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10"></a>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="k">var</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="w">  </span><span class="c1">// This var contains the elements of the main diagonal of the input matrix</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="w">  </span><span class="n">diag_elements</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14"></a>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15"></a><span class="w">  </span><span class="c1">// This var contains the elements of the subdiagonal</span>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16"></a><span class="w">  </span><span class="n">subdiag_elements</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">2</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17"></a>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18"></a><span class="w">  </span><span class="c1">// Array to store the calculated eigenvalues</span>
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19"></a><span class="w">  </span><span class="n">eig_values_lambda</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20"></a>
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21"></a><span class="w">  </span><span class="c1">// Matrix to store the calculated eigenvectors</span>
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22"></a><span class="w">  </span><span class="n">eig_vectors_mat_x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="n">n_mat_size</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-35-23"><a id="__codelineno-35-23" name="__codelineno-35-23"></a>
</span><span id="__span-35-24"><a id="__codelineno-35-24" name="__codelineno-35-24"></a><span class="w">  </span><span class="c1">// Variable for capturing the result of the eigenvalue/eigenvector calculation</span>
</span><span id="__span-35-25"><a id="__codelineno-35-25" name="__codelineno-35-25"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-35-26"><a id="__codelineno-35-26" name="__codelineno-35-26"></a>
</span><span id="__span-35-27"><a id="__codelineno-35-27" name="__codelineno-35-27"></a><span class="w">  </span><span class="c1">// Variables for loops</span>
</span><span id="__span-35-28"><a id="__codelineno-35-28" name="__codelineno-35-28"></a><span class="w">  </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-35-29"><a id="__codelineno-35-29" name="__codelineno-35-29"></a>
</span><span id="__span-35-30"><a id="__codelineno-35-30" name="__codelineno-35-30"></a><span class="k">begin</span>
</span><span id="__span-35-31"><a id="__codelineno-35-31" name="__codelineno-35-31"></a>
</span><span id="__span-35-32"><a id="__codelineno-35-32" name="__codelineno-35-32"></a><span class="w">  </span><span class="c1">// Write elements of diagonal</span>
</span><span id="__span-35-33"><a id="__codelineno-35-33" name="__codelineno-35-33"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'n = '</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-34"><a id="__codelineno-35-34" name="__codelineno-35-34"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Elements of main diagonal = '</span><span class="o">,</span><span class="w"> </span><span class="n">diag_elements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-35"><a id="__codelineno-35-35" name="__codelineno-35-35"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-35-36"><a id="__codelineno-35-36" name="__codelineno-35-36"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">diag_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-37"><a id="__codelineno-35-37" name="__codelineno-35-37"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-38"><a id="__codelineno-35-38" name="__codelineno-35-38"></a>
</span><span id="__span-35-39"><a id="__codelineno-35-39" name="__codelineno-35-39"></a><span class="w">  </span><span class="c1">// Write elements of sub-diagonal</span>
</span><span id="__span-35-40"><a id="__codelineno-35-40" name="__codelineno-35-40"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'Elements of subdiagonal   = '</span><span class="o">,</span><span class="w"> </span><span class="s">' '</span><span class="o">:</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="n">subdiag_elements</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-41"><a id="__codelineno-35-41" name="__codelineno-35-41"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-35-42"><a id="__codelineno-35-42" name="__codelineno-35-42"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">subdiag_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-43"><a id="__codelineno-35-43" name="__codelineno-35-43"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-44"><a id="__codelineno-35-44" name="__codelineno-35-44"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-45"><a id="__codelineno-35-45" name="__codelineno-35-45"></a>
</span><span id="__span-35-46"><a id="__codelineno-35-46" name="__codelineno-35-46"></a><span class="w">  </span><span class="c1">// Write reconstructed band input matrix (not needed for calculation)</span>
</span><span id="__span-35-47"><a id="__codelineno-35-47" name="__codelineno-35-47"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Reconstructed A = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-48"><a id="__codelineno-35-48" name="__codelineno-35-48"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-35-49"><a id="__codelineno-35-49" name="__codelineno-35-49"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-35-50"><a id="__codelineno-35-50" name="__codelineno-35-50"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-35-51"><a id="__codelineno-35-51" name="__codelineno-35-51"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">diag_elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-35-52"><a id="__codelineno-35-52" name="__codelineno-35-52"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-35-53"><a id="__codelineno-35-53" name="__codelineno-35-53"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">subdiag_elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-35-54"><a id="__codelineno-35-54" name="__codelineno-35-54"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-35-55"><a id="__codelineno-35-55" name="__codelineno-35-55"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="n">subdiag_elements</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-35-56"><a id="__codelineno-35-56" name="__codelineno-35-56"></a><span class="w">      </span><span class="k">else</span>
</span><span id="__span-35-57"><a id="__codelineno-35-57" name="__codelineno-35-57"></a><span class="w">        </span><span class="nb">Write</span><span class="p">(</span><span class="mf">0.0</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-58"><a id="__codelineno-35-58" name="__codelineno-35-58"></a><span class="w">    </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-35-59"><a id="__codelineno-35-59" name="__codelineno-35-59"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-60"><a id="__codelineno-35-60" name="__codelineno-35-60"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-35-61"><a id="__codelineno-35-61" name="__codelineno-35-61"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-62"><a id="__codelineno-35-62" name="__codelineno-35-62"></a>
</span><span id="__span-35-63"><a id="__codelineno-35-63" name="__codelineno-35-63"></a><span class="w">  </span><span class="c1">// Calculate eigenvalues/vectors</span>
</span><span id="__span-35-64"><a id="__codelineno-35-64" name="__codelineno-35-64"></a><span class="w">  </span><span class="n">eigts3</span><span class="p">(</span><span class="n">diag_elements</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">subdiag_elements</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">eig_values_lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">eig_vectors_mat_x</span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n_mat_size</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-65"><a id="__codelineno-35-65" name="__codelineno-35-65"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-35-66"><a id="__codelineno-35-66" name="__codelineno-35-66"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'term = '</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">,</span><span class="w"> </span><span class="s">' --&gt; ERROR'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-67"><a id="__codelineno-35-67" name="__codelineno-35-67"></a><span class="w">    </span><span class="nb">halt</span><span class="o">;</span>
</span><span id="__span-35-68"><a id="__codelineno-35-68" name="__codelineno-35-68"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-35-69"><a id="__codelineno-35-69" name="__codelineno-35-69"></a>
</span><span id="__span-35-70"><a id="__codelineno-35-70" name="__codelineno-35-70"></a><span class="w">  </span><span class="c1">// Write expected results of eigenvalues</span>
</span><span id="__span-35-71"><a id="__codelineno-35-71" name="__codelineno-35-71"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Expected eigenvalues:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-72"><a id="__codelineno-35-72" name="__codelineno-35-72"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="o">-</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">+</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-73"><a id="__codelineno-35-73" name="__codelineno-35-73"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-74"><a id="__codelineno-35-74" name="__codelineno-35-74"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-75"><a id="__codelineno-35-75" name="__codelineno-35-75"></a>
</span><span id="__span-35-76"><a id="__codelineno-35-76" name="__codelineno-35-76"></a><span class="w">  </span><span class="c1">// write eigenvalues</span>
</span><span id="__span-35-77"><a id="__codelineno-35-77" name="__codelineno-35-77"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Calculated eigenvalues: lambda = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-78"><a id="__codelineno-35-78" name="__codelineno-35-78"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-35-79"><a id="__codelineno-35-79" name="__codelineno-35-79"></a><span class="w">    </span><span class="nb">Write</span><span class="p">(</span><span class="n">eig_values_lambda</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-80"><a id="__codelineno-35-80" name="__codelineno-35-80"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-81"><a id="__codelineno-35-81" name="__codelineno-35-81"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-82"><a id="__codelineno-35-82" name="__codelineno-35-82"></a>
</span><span id="__span-35-83"><a id="__codelineno-35-83" name="__codelineno-35-83"></a><span class="w">  </span><span class="c1">// Write eigenvectors</span>
</span><span id="__span-35-84"><a id="__codelineno-35-84" name="__codelineno-35-84"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Eigenvectors (as columns): x = '</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-85"><a id="__codelineno-35-85" name="__codelineno-35-85"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-35-86"><a id="__codelineno-35-86" name="__codelineno-35-86"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n_mat_size</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-35-87"><a id="__codelineno-35-87" name="__codelineno-35-87"></a><span class="w">      </span><span class="nb">Write</span><span class="p">(</span><span class="n">eig_vectors_mat_x</span><span class="p">[</span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-88"><a id="__codelineno-35-88" name="__codelineno-35-88"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-35-89"><a id="__codelineno-35-89" name="__codelineno-35-89"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-35-90"><a id="__codelineno-35-90" name="__codelineno-35-90"></a>
</span><span id="__span-35-91"><a id="__codelineno-35-91" name="__codelineno-35-91"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-35-92"><a id="__codelineno-35-92" name="__codelineno-35-92"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-35-93"><a id="__codelineno-35-93" name="__codelineno-35-93"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-35-94"><a id="__codelineno-35-94" name="__codelineno-35-94"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>n = 4
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>Elements of main diagonal = 1  1  1  1
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>Elements of subdiagonal   =    1  2  1
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>Reconstructed A =
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>  1  1  0  0
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>  1  1  2  0
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>  0  2  1  1
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>  0  0  1  1
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>Expected eigenvalues:
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>         -1.414          0.586          1.414          3.414
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>Calculated eigenvalues: lambda =
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>         -1.414          0.586          1.414          3.414
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>Eigenvectors (as columns): x =
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>         -0.271         -0.653          0.653          0.271
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>          0.653          0.271          0.271          0.653
</span><span id="__span-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>         -0.653          0.271         -0.271          0.653
</span><span id="__span-36-21"><a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>          0.271         -0.653         -0.653          0.271
</span><span id="__span-36-22"><a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>Press enter to quit
</span></code></pre></div>
<h2 id="unit-roo-finding-the-roots-of-a-function">Unit <code>roo</code> - Finding the roots of a function<a class="headerlink" href="#unit-roo-finding-the-roots-of-a-function" title="Permanent link">¶</a></h2>
<h3 id="roots-of-a-polynomial">Roots of a Polynomial<a class="headerlink" href="#roots-of-a-polynomial" title="Permanent link">¶</a></h3>
<p>A polynomial of degree <code>n</code> </p>
<div class="arithmatex">\[
\displaystyle{  z^n + a_1 z^{n-1} + a_2 z^{n-2} + ... + a_{n-1} z + a_n = 0 }
\]</div>
<p>always has <code>n</code> complex solutions, though they may not all be distinct. The datatype <code>complex</code> is described in the section on complex numbers. You can calculate the roots using the <code>roopol</code> function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The polynomial must be normalized, meaning the coefficient of the highest-degree term should be 1.</p>
</div>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">roopol</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">k</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong>a</strong>: An array containing the polynomial coefficients, ordered from highest to lowest degree. </p>
<ul>
<li>The polynomial must be normalized, meaning the coefficient of the highest-degree term should be 1. This coefficient is <strong>not</strong> included in the array, so the array must have at least <code>n</code> elements. </li>
<li>Since only real polynomials are handled, the array elements should be of type <code>ArbFloat</code>. Note: the data organization for this array is different from other polynomial routines in this library.</li>
</ul>
</li>
<li>
<p><strong>n</strong>: The degree of the polynomial. It must be a positive integer.</p>
</li>
<li>
<p><strong>z</strong>: An array of complex values that will store the roots of the polynomial. The array must have at least <code>n</code> elements. The values returned are undefined if an error occurs (i.e., if <code>term &lt;&gt; 1</code>).</p>
</li>
<li>
<p><strong>k</strong>: The number of roots found. This value should always equal <code>n</code>; if it doesn't, an error has occurred.</p>
</li>
<li>
<p><strong>term</strong>: An error code returned by the function:</p>
<ul>
<li><code>1</code>: Successful completion, and the array <code>z</code> contains valid root data.</li>
<li><code>2</code>: Not all roots were found (<code>k &lt; n</code>).</li>
<li><code>3</code>: Error in input data (<code>n &lt; 1</code>).</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>Calculate the roots of the polynomial <span class="arithmatex">\(z^5 + 3 z^4 + 4 z^3 - 8 z^2\)</span>. The expected zero points are:</p>
<div class="arithmatex">\[
\displaystyle{  z_1=0,\ z_2=0,\ z_3=1,\ z_4=-2+2i,\ z_5=-2-2i }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-38-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-38-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-38-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-38-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-38-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-38-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-38-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-38-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-38-10">10</a></span>
<span class="normal"><a href="#__codelineno-38-11">11</a></span>
<span class="normal"><a href="#__codelineno-38-12">12</a></span>
<span class="normal"><a href="#__codelineno-38-13">13</a></span>
<span class="normal"><a href="#__codelineno-38-14">14</a></span>
<span class="normal"><a href="#__codelineno-38-15">15</a></span>
<span class="normal"><a href="#__codelineno-38-16">16</a></span>
<span class="normal"><a href="#__codelineno-38-17">17</a></span>
<span class="normal"><a href="#__codelineno-38-18">18</a></span>
<span class="normal"><a href="#__codelineno-38-19">19</a></span>
<span class="normal"><a href="#__codelineno-38-20">20</a></span>
<span class="normal"><a href="#__codelineno-38-21">21</a></span>
<span class="normal"><a href="#__codelineno-38-22">22</a></span>
<span class="normal"><a href="#__codelineno-38-23">23</a></span>
<span class="normal"><a href="#__codelineno-38-24">24</a></span>
<span class="normal"><a href="#__codelineno-38-25">25</a></span>
<span class="normal"><a href="#__codelineno-38-26">26</a></span>
<span class="normal"><a href="#__codelineno-38-27">27</a></span>
<span class="normal"><a href="#__codelineno-38-28">28</a></span>
<span class="normal"><a href="#__codelineno-38-29">29</a></span>
<span class="normal"><a href="#__codelineno-38-30">30</a></span>
<span class="normal"><a href="#__codelineno-38-31">31</a></span>
<span class="normal"><a href="#__codelineno-38-32">32</a></span>
<span class="normal"><a href="#__codelineno-38-33">33</a></span>
<span class="normal"><a href="#__codelineno-38-34">34</a></span>
<span class="normal"><a href="#__codelineno-38-35">35</a></span>
<span class="normal"><a href="#__codelineno-38-36">36</a></span>
<span class="normal"><a href="#__codelineno-38-37">37</a></span>
<span class="normal"><a href="#__codelineno-38-38">38</a></span>
<span class="normal"><a href="#__codelineno-38-39">39</a></span>
<span class="normal"><a href="#__codelineno-38-40">40</a></span>
<span class="normal"><a href="#__codelineno-38-41">41</a></span>
<span class="normal"><a href="#__codelineno-38-42">42</a></span>
<span class="normal"><a href="#__codelineno-38-43">43</a></span>
<span class="normal"><a href="#__codelineno-38-44">44</a></span>
<span class="normal"><a href="#__codelineno-38-45">45</a></span>
<span class="normal"><a href="#__codelineno-38-46">46</a></span>
<span class="normal"><a href="#__codelineno-38-47">47</a></span>
<span class="normal"><a href="#__codelineno-38-48">48</a></span>
<span class="normal"><a href="#__codelineno-38-49">49</a></span>
<span class="normal"><a href="#__codelineno-38-50">50</a></span>
<span class="normal"><a href="#__codelineno-38-51">51</a></span>
<span class="normal"><a href="#__codelineno-38-52">52</a></span>
<span class="normal"><a href="#__codelineno-38-53">53</a></span>
<span class="normal"><a href="#__codelineno-38-54">54</a></span>
<span class="normal"><a href="#__codelineno-38-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_root_polynomials</span><span class="o">;</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4"></a>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5"></a><span class="k">uses</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">roo</span><span class="o">;</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7"></a>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="k">const</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="o">;</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10"></a>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11"></a><span class="k">var</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12"></a><span class="w">  </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13"></a><span class="w">  </span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14"></a><span class="w">  </span><span class="n">k</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17"></a><span class="w">  </span><span class="n">c</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18"></a>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="nf">ComplexToStr</span><span class="p">(</span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="n">Decimals</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="k">string</span><span class="o">;</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20"></a><span class="w">  </span><span class="k">const</span>
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21"></a><span class="w">    </span><span class="nb">SIGN</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="kt">boolean</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s">'+'</span><span class="o">,</span><span class="w"> </span><span class="s">'-'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">Format</span><span class="p">(</span><span class="s">'%.*f %s %.*f i'</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="n">Decimals</span><span class="o">,</span><span class="w"> </span><span class="n">z</span><span class="o">.</span><span class="n">re</span><span class="o">,</span><span class="w"> </span><span class="nb">SIGN</span><span class="p">[</span><span class="n">z</span><span class="o">.</span><span class="n">im</span><span class="w"> </span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">Decimals</span><span class="o">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">im</span><span class="p">)])</span><span class="o">;</span>
</span><span id="__span-38-24"><a id="__codelineno-38-24" name="__codelineno-38-24"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-38-25"><a id="__codelineno-38-25" name="__codelineno-38-25"></a>
</span><span id="__span-38-26"><a id="__codelineno-38-26" name="__codelineno-38-26"></a><span class="k">begin</span>
</span><span id="__span-38-27"><a id="__codelineno-38-27" name="__codelineno-38-27"></a><span class="w">  </span><span class="c1">// Solve equation</span>
</span><span id="__span-38-28"><a id="__codelineno-38-28" name="__codelineno-38-28"></a><span class="hll"><span class="w">  </span><span class="n">roopol</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">k</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-38-29"><a id="__codelineno-38-29" name="__codelineno-38-29"></a>
</span><span id="__span-38-30"><a id="__codelineno-38-30" name="__codelineno-38-30"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-38-31"><a id="__codelineno-38-31" name="__codelineno-38-31"></a><span class="w">    </span><span class="c1">// Display results</span>
</span><span id="__span-38-32"><a id="__codelineno-38-32" name="__codelineno-38-32"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Results of procedure roopol:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-33"><a id="__codelineno-38-33" name="__codelineno-38-33"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-38-34"><a id="__codelineno-38-34" name="__codelineno-38-34"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #'</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="s">': '</span><span class="o">,</span><span class="w"> </span><span class="n">ComplexToStr</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-35"><a id="__codelineno-38-35" name="__codelineno-38-35"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-38-36"><a id="__codelineno-38-36" name="__codelineno-38-36"></a>
</span><span id="__span-38-37"><a id="__codelineno-38-37" name="__codelineno-38-37"></a><span class="w">    </span><span class="c1">// Display expected results</span>
</span><span id="__span-38-38"><a id="__codelineno-38-38" name="__codelineno-38-38"></a><span class="w">    </span><span class="nb">Writeln</span><span class="p">(</span><span class="s">'Expected results:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-39"><a id="__codelineno-38-39" name="__codelineno-38-39"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// z1 = 0</span>
</span><span id="__span-38-40"><a id="__codelineno-38-40" name="__codelineno-38-40"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #1: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-41"><a id="__codelineno-38-41" name="__codelineno-38-41"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// z2 = 0</span>
</span><span id="__span-38-42"><a id="__codelineno-38-42" name="__codelineno-38-42"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #2: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-43"><a id="__codelineno-38-43" name="__codelineno-38-43"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// z3 = 1</span>
</span><span id="__span-38-44"><a id="__codelineno-38-44" name="__codelineno-38-44"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #3: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-45"><a id="__codelineno-38-45" name="__codelineno-38-45"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// z4 = -2 + 2 i</span>
</span><span id="__span-38-46"><a id="__codelineno-38-46" name="__codelineno-38-46"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #4: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-47"><a id="__codelineno-38-47" name="__codelineno-38-47"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// z4 = -2 - 2 i</span>
</span><span id="__span-38-48"><a id="__codelineno-38-48" name="__codelineno-38-48"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #5: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-49"><a id="__codelineno-38-49" name="__codelineno-38-49"></a><span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">else</span>
</span><span id="__span-38-50"><a id="__codelineno-38-50" name="__codelineno-38-50"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'ERROR'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-51"><a id="__codelineno-38-51" name="__codelineno-38-51"></a>
</span><span id="__span-38-52"><a id="__codelineno-38-52" name="__codelineno-38-52"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-38-53"><a id="__codelineno-38-53" name="__codelineno-38-53"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-38-54"><a id="__codelineno-38-54" name="__codelineno-38-54"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-38-55"><a id="__codelineno-38-55" name="__codelineno-38-55"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="roots-of-a-quadratic-equation">Roots of a Quadratic Equation<a class="headerlink" href="#roots-of-a-quadratic-equation" title="Permanent link">¶</a></h3>
<p>A quadratic equation is a polynomial of degree 2. It always has two complex roots, though they may not be distinct. You can find these roots using the <code>rooqua</code> procedure.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">rooqua</span><span class="p">(</span><span class="n">p</span><span class="o">,</span><span class="w"> </span><span class="n">q</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">z1</span><span class="o">,</span><span class="w"> </span><span class="n">z2</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>p</strong>: The coefficient of the linear term in the quadratic equation.</li>
<li><strong>q</strong>: The constant term of the quadratic equation.</li>
<li><strong>z1, z2</strong>: Variables that will store the two complex roots of the equation. The type <code>complex</code> is declared in the unit <code>typ</code>.</li>
</ul>
<p><code>rooqua</code> assumes that the quadratic term has been normalized, meaning the coefficient of the quadratic term is set to 1.</p>
<p><strong>Example</strong></p>
<p>Determine the roots of the equation <span class="arithmatex">\(z^2 + 2 z + 5 = 0\)</span>.</p>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-40-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-40-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-40-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-40-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-40-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-40-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-40-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-40-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-40-10">10</a></span>
<span class="normal"><a href="#__codelineno-40-11">11</a></span>
<span class="normal"><a href="#__codelineno-40-12">12</a></span>
<span class="normal"><a href="#__codelineno-40-13">13</a></span>
<span class="normal"><a href="#__codelineno-40-14">14</a></span>
<span class="normal"><a href="#__codelineno-40-15">15</a></span>
<span class="normal"><a href="#__codelineno-40-16">16</a></span>
<span class="normal"><a href="#__codelineno-40-17">17</a></span>
<span class="normal"><a href="#__codelineno-40-18">18</a></span>
<span class="normal"><a href="#__codelineno-40-19">19</a></span>
<span class="normal"><a href="#__codelineno-40-20">20</a></span>
<span class="normal"><a href="#__codelineno-40-21">21</a></span>
<span class="normal"><a href="#__codelineno-40-22">22</a></span>
<span class="normal"><a href="#__codelineno-40-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_root_quadratic</span><span class="o">;</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2"></a>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4"></a>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5"></a><span class="k">uses</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">roo</span><span class="o">;</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7"></a>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8"></a><span class="k">var</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9"></a><span class="w">  </span><span class="n">z1</span><span class="o">,</span><span class="w"> </span><span class="n">z2</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10"></a>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11"></a><span class="k">const</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12"></a><span class="w">  </span><span class="nb">SIGN</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="kt">boolean</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s">'+'</span><span class="o">,</span><span class="w"> </span><span class="s">'-'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13"></a>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14"></a><span class="k">begin</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15"></a><span class="hll"><span class="w">  </span><span class="n">rooqua</span><span class="p">(</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">z1</span><span class="o">,</span><span class="w"> </span><span class="n">z2</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16"></a>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="nb">Format</span><span class="p">(</span><span class="s">'1st solution: %g %s %g i'</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="n">z1</span><span class="o">.</span><span class="n">re</span><span class="o">,</span><span class="w"> </span><span class="nb">SIGN</span><span class="p">[</span><span class="n">z1</span><span class="o">.</span><span class="n">im</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">z1</span><span class="o">.</span><span class="n">im</span><span class="p">)]))</span><span class="o">;</span>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="nb">Format</span><span class="p">(</span><span class="s">'2nd solution: %g %s %g i'</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="n">z2</span><span class="o">.</span><span class="n">re</span><span class="o">,</span><span class="w"> </span><span class="nb">SIGN</span><span class="p">[</span><span class="n">z2</span><span class="o">.</span><span class="n">im</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">z2</span><span class="o">.</span><span class="n">im</span><span class="p">)]))</span><span class="o">;</span>
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19"></a>
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-40-23"><a id="__codelineno-40-23" name="__codelineno-40-23"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h3 id="roots-of-the-binomial-equation">Roots of the Binomial Equation<a class="headerlink" href="#roots-of-the-binomial-equation" title="Permanent link">¶</a></h3>
<p>The binomial equation <span class="arithmatex">\( z^n = a \)</span> is a special type of polynomial where all terms except for the highest- and lowest-order terms have zero coefficients. It has <code>n</code> complex solutions, which can be calculated using the <code>roobin</code> procedure.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">roobin</span><span class="p">(</span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>n</strong>: The exponent in the binomial equation. It must be a positive integer.</li>
<li><strong>a</strong>: The constant term on the right-hand side of the equation. This is expected to be a complex number (refer to the section on complex numbers).</li>
<li><strong>z</strong>: An array of type <code>complex</code> that will store the calculated roots. It must have space for at least <code>n</code> complex values.</li>
<li><strong>term</strong>: An error code returned by the procedure:<ul>
<li><code>1</code>: Successful termination.</li>
<li><code>2</code>: Error in input data (<code>n &lt; 1</code>).</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>Calculate the roots of the equation:</p>
<div class="arithmatex">\[
\displaystyle{ z^4 = -1 }
\]</div>
<p>The exact solutions are</p>
<div class="arithmatex">\[
\displaystyle{ z_1 = \frac{1}{2} \sqrt{2} (1+i) ,\ z_2 = \frac{1}{2} \sqrt{2} (1-i) ,\ z_3= \frac{1}{2} \sqrt{2} (-1+i) ,\ z_4= \frac{1}{2} \sqrt{2} (-1-i) }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-42-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-42-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-42-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-42-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-42-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-42-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-42-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-42-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-42-10">10</a></span>
<span class="normal"><a href="#__codelineno-42-11">11</a></span>
<span class="normal"><a href="#__codelineno-42-12">12</a></span>
<span class="normal"><a href="#__codelineno-42-13">13</a></span>
<span class="normal"><a href="#__codelineno-42-14">14</a></span>
<span class="normal"><a href="#__codelineno-42-15">15</a></span>
<span class="normal"><a href="#__codelineno-42-16">16</a></span>
<span class="normal"><a href="#__codelineno-42-17">17</a></span>
<span class="normal"><a href="#__codelineno-42-18">18</a></span>
<span class="normal"><a href="#__codelineno-42-19">19</a></span>
<span class="normal"><a href="#__codelineno-42-20">20</a></span>
<span class="normal"><a href="#__codelineno-42-21">21</a></span>
<span class="normal"><a href="#__codelineno-42-22">22</a></span>
<span class="normal"><a href="#__codelineno-42-23">23</a></span>
<span class="normal"><a href="#__codelineno-42-24">24</a></span>
<span class="normal"><a href="#__codelineno-42-25">25</a></span>
<span class="normal"><a href="#__codelineno-42-26">26</a></span>
<span class="normal"><a href="#__codelineno-42-27">27</a></span>
<span class="normal"><a href="#__codelineno-42-28">28</a></span>
<span class="normal"><a href="#__codelineno-42-29">29</a></span>
<span class="normal"><a href="#__codelineno-42-30">30</a></span>
<span class="normal"><a href="#__codelineno-42-31">31</a></span>
<span class="normal"><a href="#__codelineno-42-32">32</a></span>
<span class="normal"><a href="#__codelineno-42-33">33</a></span>
<span class="normal"><a href="#__codelineno-42-34">34</a></span>
<span class="normal"><a href="#__codelineno-42-35">35</a></span>
<span class="normal"><a href="#__codelineno-42-36">36</a></span>
<span class="normal"><a href="#__codelineno-42-37">37</a></span>
<span class="normal"><a href="#__codelineno-42-38">38</a></span>
<span class="normal"><a href="#__codelineno-42-39">39</a></span>
<span class="normal"><a href="#__codelineno-42-40">40</a></span>
<span class="normal"><a href="#__codelineno-42-41">41</a></span>
<span class="normal"><a href="#__codelineno-42-42">42</a></span>
<span class="normal"><a href="#__codelineno-42-43">43</a></span>
<span class="normal"><a href="#__codelineno-42-44">44</a></span>
<span class="normal"><a href="#__codelineno-42-45">45</a></span>
<span class="normal"><a href="#__codelineno-42-46">46</a></span>
<span class="normal"><a href="#__codelineno-42-47">47</a></span>
<span class="normal"><a href="#__codelineno-42-48">48</a></span>
<span class="normal"><a href="#__codelineno-42-49">49</a></span>
<span class="normal"><a href="#__codelineno-42-50">50</a></span>
<span class="normal"><a href="#__codelineno-42-51">51</a></span>
<span class="normal"><a href="#__codelineno-42-52">52</a></span>
<span class="normal"><a href="#__codelineno-42-53">53</a></span>
<span class="normal"><a href="#__codelineno-42-54">54</a></span>
<span class="normal"><a href="#__codelineno-42-55">55</a></span>
<span class="normal"><a href="#__codelineno-42-56">56</a></span>
<span class="normal"><a href="#__codelineno-42-57">57</a></span>
<span class="normal"><a href="#__codelineno-42-58">58</a></span>
<span class="normal"><a href="#__codelineno-42-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_root_binomial</span><span class="o">;</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a><span class="k">uses</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">roo</span><span class="o">;</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7"></a>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8"></a><span class="k">const</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">;</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10"></a>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11"></a><span class="k">var</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12"></a><span class="w">  </span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15"></a><span class="w">  </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16"></a><span class="w">  </span><span class="n">c</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17"></a>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="nf">ComplexToStr</span><span class="p">(</span><span class="n">z</span><span class="o">:</span><span class="w"> </span><span class="n">complex</span><span class="o">;</span><span class="w"> </span><span class="n">Decimals</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="k">string</span><span class="o">;</span>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19"></a><span class="w">  </span><span class="k">const</span>
</span><span id="__span-42-20"><a id="__codelineno-42-20" name="__codelineno-42-20"></a><span class="w">    </span><span class="nb">SIGN</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="kt">boolean</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s">'+'</span><span class="o">,</span><span class="w"> </span><span class="s">'-'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-21"><a id="__codelineno-42-21" name="__codelineno-42-21"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-42-22"><a id="__codelineno-42-22" name="__codelineno-42-22"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">Format</span><span class="p">(</span><span class="s">'%.*g %s %.*g i'</span><span class="o">,</span><span class="w"> </span><span class="p">[</span><span class="n">Decimals</span><span class="o">,</span><span class="w"> </span><span class="n">z</span><span class="o">.</span><span class="n">re</span><span class="o">,</span><span class="w"> </span><span class="nb">SIGN</span><span class="p">[</span><span class="n">z</span><span class="o">.</span><span class="n">im</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">Decimals</span><span class="o">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">im</span><span class="p">)])</span><span class="o">;</span>
</span><span id="__span-42-23"><a id="__codelineno-42-23" name="__codelineno-42-23"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-42-24"><a id="__codelineno-42-24" name="__codelineno-42-24"></a>
</span><span id="__span-42-25"><a id="__codelineno-42-25" name="__codelineno-42-25"></a><span class="k">begin</span>
</span><span id="__span-42-26"><a id="__codelineno-42-26" name="__codelineno-42-26"></a><span class="w">  </span><span class="c1">// Prepare constant term as a complex value</span>
</span><span id="__span-42-27"><a id="__codelineno-42-27" name="__codelineno-42-27"></a><span class="w">  </span><span class="n">a</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-28"><a id="__codelineno-42-28" name="__codelineno-42-28"></a>
</span><span id="__span-42-29"><a id="__codelineno-42-29" name="__codelineno-42-29"></a><span class="w">  </span><span class="c1">// Solve equation</span>
</span><span id="__span-42-30"><a id="__codelineno-42-30" name="__codelineno-42-30"></a><span class="hll"><span class="w">  </span><span class="n">roobin</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-42-31"><a id="__codelineno-42-31" name="__codelineno-42-31"></a>
</span><span id="__span-42-32"><a id="__codelineno-42-32" name="__codelineno-42-32"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-42-33"><a id="__codelineno-42-33" name="__codelineno-42-33"></a><span class="w">    </span><span class="c1">// Display results</span>
</span><span id="__span-42-34"><a id="__codelineno-42-34" name="__codelineno-42-34"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Results of procedure roobin:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-35"><a id="__codelineno-42-35" name="__codelineno-42-35"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="o">:=</span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-42-36"><a id="__codelineno-42-36" name="__codelineno-42-36"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #'</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="s">': '</span><span class="o">,</span><span class="w"> </span><span class="n">ComplexToStr</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-37"><a id="__codelineno-42-37" name="__codelineno-42-37"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-42-38"><a id="__codelineno-42-38" name="__codelineno-42-38"></a>
</span><span id="__span-42-39"><a id="__codelineno-42-39" name="__codelineno-42-39"></a><span class="w">    </span><span class="c1">// Display expected results</span>
</span><span id="__span-42-40"><a id="__codelineno-42-40" name="__codelineno-42-40"></a><span class="w">    </span><span class="nb">Writeln</span><span class="p">(</span><span class="s">'Expected results:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-41"><a id="__codelineno-42-41" name="__codelineno-42-41"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-42"><a id="__codelineno-42-42" name="__codelineno-42-42"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-42-43"><a id="__codelineno-42-43" name="__codelineno-42-43"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #1: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-44"><a id="__codelineno-42-44" name="__codelineno-42-44"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-45"><a id="__codelineno-42-45" name="__codelineno-42-45"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-42-46"><a id="__codelineno-42-46" name="__codelineno-42-46"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #2: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-47"><a id="__codelineno-42-47" name="__codelineno-42-47"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-48"><a id="__codelineno-42-48" name="__codelineno-42-48"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-42-49"><a id="__codelineno-42-49" name="__codelineno-42-49"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #3: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-50"><a id="__codelineno-42-50" name="__codelineno-42-50"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-51"><a id="__codelineno-42-51" name="__codelineno-42-51"></a><span class="w">    </span><span class="n">c</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-42-52"><a id="__codelineno-42-52" name="__codelineno-42-52"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'  Solution #4: '</span><span class="o">,</span><span class="w"> </span><span class="n">complexToStr</span><span class="p">(</span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-53"><a id="__codelineno-42-53" name="__codelineno-42-53"></a><span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">else</span>
</span><span id="__span-42-54"><a id="__codelineno-42-54" name="__codelineno-42-54"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'ERROR'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-55"><a id="__codelineno-42-55" name="__codelineno-42-55"></a>
</span><span id="__span-42-56"><a id="__codelineno-42-56" name="__codelineno-42-56"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-42-57"><a id="__codelineno-42-57" name="__codelineno-42-57"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-42-58"><a id="__codelineno-42-58" name="__codelineno-42-58"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-42-59"><a id="__codelineno-42-59" name="__codelineno-42-59"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>Results of procedure roobin:
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>  Solution #1: 0.707107 + 0.707107 i
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>  Solution #2: 0.707107 - 0.707107 i
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>  Solution #3: -0.707107 + 0.707107 i
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>  Solution #4: -0.707107 - 0.707107 i
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>Expected results:
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>  Solution #1: 0.707107 + 0.707107 i
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>  Solution #2: 0.707107 - 0.707107 i
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>  Solution #3: -0.707107 + 0.707107 i
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>  Solution #4: -0.707107 - 0.707107 i
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>Press enter to quit
</span></code></pre></div>
<h3 id="bisection-method">Bisection Method<a class="headerlink" href="#bisection-method" title="Permanent link">¶</a></h3>
<p>The bisection method is used to estimate the root of a function by identifying two values, <code>a</code> and <code>b</code>, such that the function has opposite signs at those points. The midpoint of the interval is calculated, and the subinterval where the function's signs differ is selected for the next iteration. This process continues until the desired precision (i.e., interval length) is achieved.</p>
<p>In <strong>NumLib</strong>, this method is implemented using the <code>roof1r</code> procedure:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">roof1r</span><span class="p">(</span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="n">rfunc1r</span><span class="o">;</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">ae</span><span class="o">,</span><span class="w"> </span><span class="n">re</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>f</strong>: The function for which the root is to be determined. It must take a single floating-point argument of type <code>ArbFloat</code>. The function type <code>rfunc1r</code> is declared in the <code>typ</code> unit.</li>
<li><strong>a, b</strong>: The endpoints of the interval. The root must lie between these two values, meaning the function values <code>f(a)</code> and <code>f(b)</code> should have opposite signs.</li>
<li><strong>ae, re</strong>: These determine the absolute (<code>ae</code>) and relative (<code>re</code>) precision of the root. <code>re</code> is relative to the maximum of <code>abs(a)</code> and <code>abs(b)</code>. Higher accuracy is achieved by setting <code>ae</code> to <code>MachEps</code> (from the <code>typ</code> unit). Both parameters must be non-negative.</li>
<li><strong>x</strong>: The variable that returns the found root.</li>
<li><strong>term</strong>: An error code indicating the result of the process:<ul>
<li><code>1</code>: Successful termination. A root has been found with the specified absolute or relative precision.</li>
<li><code>2</code>: The required accuracy could not be achieved, but the value of <code>x</code> is the "best achievable" approximation.</li>
<li><code>3</code>: Input error: <code>ae &lt; 0</code> or <code>re &lt; 0</code>, or the function values at <code>a</code> and <code>b</code> do not have opposite signs.</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>The following program uses the bisection method to find the square root of 2. The root is the value of <code>x</code> where the function <span class="arithmatex">\( f(x) = x^2 - 2 \)</span> equals zero. Since <span class="arithmatex">\( f(1) = -1 \)</span> and <span class="arithmatex">\( f(2) = 2 \)</span>, the root lies between 1 and 2.</p>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-45-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-45-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-45-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-45-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-45-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-45-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-45-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-45-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-45-10">10</a></span>
<span class="normal"><a href="#__codelineno-45-11">11</a></span>
<span class="normal"><a href="#__codelineno-45-12">12</a></span>
<span class="normal"><a href="#__codelineno-45-13">13</a></span>
<span class="normal"><a href="#__codelineno-45-14">14</a></span>
<span class="normal"><a href="#__codelineno-45-15">15</a></span>
<span class="normal"><a href="#__codelineno-45-16">16</a></span>
<span class="normal"><a href="#__codelineno-45-17">17</a></span>
<span class="normal"><a href="#__codelineno-45-18">18</a></span>
<span class="normal"><a href="#__codelineno-45-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_root_bisection</span><span class="o">;</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2"></a>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="k">uses</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">roo</span><span class="o">;</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5"></a>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6"></a><span class="k">function</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7"></a><span class="k">begin</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8"></a><span class="w">  </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10"></a>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11"></a><span class="k">var</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12"></a><span class="w">  </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14"></a>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15"></a><span class="k">begin</span>
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16"></a><span class="hll"><span class="w">  </span><span class="n">roof1r</span><span class="p">(</span><span class="o">@</span><span class="n">f</span><span class="o">,</span><span class="w"> </span><span class="mf">1.0</span><span class="o">,</span><span class="w"> </span><span class="mf">2.0</span><span class="o">,</span><span class="w"> </span><span class="mf">1e-9</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Bisection result: '</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'sqrt(2):          '</span><span class="o">,</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>Bisection result:  1.4142135621888698E+000
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>sqrt(2):           1.4142135623730951E+000
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>Press enter to quit
</span></code></pre></div>
<p>Here’s a tidied version of your text:</p>
<hr>
<h3 id="roots-of-a-system-of-nonlinear-equations">Roots of a System of Nonlinear Equations<a class="headerlink" href="#roots-of-a-system-of-nonlinear-equations" title="Permanent link">¶</a></h3>
<p>We want to find the roots of a system of nonlinear equations:</p>
<div class="arithmatex">\[ f_{i}(x_1, x_2, \ldots, x_n) = 0, \; i=1,2,\ldots,n \]</div>
<p>The <strong><code>roofnr</code></strong> procedure can be used to find the roots of such a system:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">roofnr</span><span class="p">(</span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="n">roofnrfunc</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">residu</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">ra</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>f</strong>: The address of the procedure that calculates the function values <span class="arithmatex">\( f_i(x_1, x_2, \dots, x_n) \)</span>. The function type <code>roofnrfunc</code> is declared in the <code>typ</code> unit:
  <div class="language-pascal highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="k">type</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">  </span><span class="n">roofnrfunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">procedure</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">fx</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">deff</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div></li>
<li><strong>x</strong>: An array of at least <code>n</code> <code>ArbFloat</code> values, providing the <span class="arithmatex">\( x_j \)</span> values at which the functions are evaluated.</li>
<li><strong>fx</strong>: An array to store the calculated values of the functions <span class="arithmatex">\( f_i \)</span>.</li>
<li><strong>deff</strong>: A boolean flag that can be used to stop the root-finding process based on a condition.</li>
</ul>
<p>For example, to solve the system of equations:</p>
<div class="arithmatex">\[ 
\begin{array}{l}
f_1(x_1, x_2) = x_1^2 + x_2^2 - 2 = 0 \\
f_2(x_1, x_2) = -(x_1 - 1)^2 + x_2 = 0
\end{array}
\]</div>
<p>The function <code>f</code> can be written as:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">x1</span><span class="o">,</span><span class="w"> </span><span class="n">f1x</span><span class="o">:</span><span class="w"> </span><span class="kt">real</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">deff</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">)</span><span class="o">;</span><span class="w"> </span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="k">var</span><span class="w"> </span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">  </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">x1</span><span class="o">;</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">  </span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">f1x</span><span class="o">;</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="k">begin</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="w">  </span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="w">  </span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="k">end</span><span class="o">;</span>
</span></code></pre></div>
<p>To stop the process when <span class="arithmatex">\( x_1 &lt; 1 \)</span>, set <code>deff</code> to <code>false</code>:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">x1</span><span class="o">,</span><span class="w"> </span><span class="n">f1x</span><span class="o">:</span><span class="w"> </span><span class="kt">real</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">deff</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="kp">far</span><span class="o">;</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="k">var</span><span class="w"> </span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">  </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">x1</span><span class="o">;</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">  </span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="kt">real</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">f1x</span><span class="o">;</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="k">begin</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">  </span><span class="n">deff</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="o">;</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">deff</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">    </span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">    </span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="k">end</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><strong>n</strong>: The number of equations or variables ( <span class="arithmatex">\( x_i \)</span> ) in the system.</li>
<li><strong>x</strong>: The first element of an array (with at least <code>n</code> values) used for both input and output. Initially, it should contain estimates of the roots. After computation, it holds the found roots.</li>
<li><strong>residu</strong>: The 2-norm of the vector of residuals in the solution:
  $$ |f|<em i="1">2 = \sqrt{\sum</em> $$}^{n} f_i^2</li>
<li><strong>ra</strong>: The relative accuracy for calculating the solution. Typical values are <span class="arithmatex">\( 10^{-3}, 10^{-5}, 10^{-8} \)</span> depending on the precision (<code>single</code>, <code>real</code>, or <code>double</code>).</li>
<li><strong>term</strong>: An error code indicating the result:<ul>
<li><code>1</code>: Successful solution with desired accuracy.</li>
<li><code>2</code>: The solution accuracy could not be achieved, but the returned <code>x</code> values are the best achievable.</li>
<li><code>3</code>: Incorrect input data (e.g., <code>n &lt; 0</code> or <code>re &lt; 0</code>).</li>
<li><code>4</code>: The calculation process was stopped due to exceeding function call limits.</li>
<li><code>5</code>: Insufficient progress—no solution found or needs a different starting value.</li>
<li><code>6</code>: The procedure attempted to compute a value outside the range defined by <code>deff</code>.</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>Solve the system of equations:</p>
<div class="arithmatex">\[ 
\begin{array}{l}
f_1(x_1, x_2) = x_1^2 + x_2^2 - 2 = 0 \\
f_2(x_1, x_2) = -(x_1 - 1)^2 + x_2 = 0
\end{array}
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-51-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-51-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-51-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-51-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-51-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-51-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-51-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-51-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-51-10">10</a></span>
<span class="normal"><a href="#__codelineno-51-11">11</a></span>
<span class="normal"><a href="#__codelineno-51-12">12</a></span>
<span class="normal"><a href="#__codelineno-51-13">13</a></span>
<span class="normal"><a href="#__codelineno-51-14">14</a></span>
<span class="normal"><a href="#__codelineno-51-15">15</a></span>
<span class="normal"><a href="#__codelineno-51-16">16</a></span>
<span class="normal"><a href="#__codelineno-51-17">17</a></span>
<span class="normal"><a href="#__codelineno-51-18">18</a></span>
<span class="normal"><a href="#__codelineno-51-19">19</a></span>
<span class="normal"><a href="#__codelineno-51-20">20</a></span>
<span class="normal"><a href="#__codelineno-51-21">21</a></span>
<span class="normal"><a href="#__codelineno-51-22">22</a></span>
<span class="normal"><a href="#__codelineno-51-23">23</a></span>
<span class="normal"><a href="#__codelineno-51-24">24</a></span>
<span class="normal"><a href="#__codelineno-51-25">25</a></span>
<span class="normal"><a href="#__codelineno-51-26">26</a></span>
<span class="normal"><a href="#__codelineno-51-27">27</a></span>
<span class="normal"><a href="#__codelineno-51-28">28</a></span>
<span class="normal"><a href="#__codelineno-51-29">29</a></span>
<span class="normal"><a href="#__codelineno-51-30">30</a></span>
<span class="normal"><a href="#__codelineno-51-31">31</a></span>
<span class="normal"><a href="#__codelineno-51-32">32</a></span>
<span class="normal"><a href="#__codelineno-51-33">33</a></span>
<span class="normal"><a href="#__codelineno-51-34">34</a></span>
<span class="normal"><a href="#__codelineno-51-35">35</a></span>
<span class="normal"><a href="#__codelineno-51-36">36</a></span>
<span class="normal"><a href="#__codelineno-51-37">37</a></span>
<span class="normal"><a href="#__codelineno-51-38">38</a></span>
<span class="normal"><a href="#__codelineno-51-39">39</a></span>
<span class="normal"><a href="#__codelineno-51-40">40</a></span>
<span class="normal"><a href="#__codelineno-51-41">41</a></span>
<span class="normal"><a href="#__codelineno-51-42">42</a></span>
<span class="normal"><a href="#__codelineno-51-43">43</a></span>
<span class="normal"><a href="#__codelineno-51-44">44</a></span>
<span class="normal"><a href="#__codelineno-51-45">45</a></span>
<span class="normal"><a href="#__codelineno-51-46">46</a></span>
<span class="normal"><a href="#__codelineno-51-47">47</a></span>
<span class="normal"><a href="#__codelineno-51-48">48</a></span>
<span class="normal"><a href="#__codelineno-51-49">49</a></span>
<span class="normal"><a href="#__codelineno-51-50">50</a></span>
<span class="normal"><a href="#__codelineno-51-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_root_nonlinear</span><span class="o">;</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2"></a>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4"></a>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5"></a><span class="k">uses</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">roo</span><span class="o">;</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7"></a>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8"></a><span class="k">const</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10"></a><span class="w">  </span><span class="n">ra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-10</span><span class="o">;</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11"></a>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12"></a><span class="k">var</span>
</span><span id="__span-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13"></a><span class="w">  </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14"></a><span class="w">  </span><span class="n">f_check</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15"></a><span class="w">  </span><span class="n">residu</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18"></a><span class="w">  </span><span class="n">deff</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="o">;</span>
</span><span id="__span-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19"></a>
</span><span id="__span-51-20"><a id="__codelineno-51-20" name="__codelineno-51-20"></a><span class="w">  </span><span class="k">procedure</span><span class="w"> </span><span class="nf">funcs</span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">x0</span><span class="o">,</span><span class="w"> </span><span class="n">fx</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">deff</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-21"><a id="__codelineno-51-21" name="__codelineno-51-21"></a><span class="w">  </span><span class="k">var</span>
</span><span id="__span-51-22"><a id="__codelineno-51-22" name="__codelineno-51-22"></a><span class="w">    </span><span class="n">xloc</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">x0</span><span class="o">;</span>
</span><span id="__span-51-23"><a id="__codelineno-51-23" name="__codelineno-51-23"></a><span class="w">    </span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">fx</span><span class="o">;</span>
</span><span id="__span-51-24"><a id="__codelineno-51-24" name="__codelineno-51-24"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-51-25"><a id="__codelineno-51-25" name="__codelineno-51-25"></a><span class="w">    </span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">xloc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">xloc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span>
</span><span id="__span-51-26"><a id="__codelineno-51-26" name="__codelineno-51-26"></a><span class="w">    </span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="nb">sqr</span><span class="p">(</span><span class="n">xloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-51-27"><a id="__codelineno-51-27" name="__codelineno-51-27"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-51-28"><a id="__codelineno-51-28" name="__codelineno-51-28"></a>
</span><span id="__span-51-29"><a id="__codelineno-51-29" name="__codelineno-51-29"></a><span class="k">begin</span>
</span><span id="__span-51-30"><a id="__codelineno-51-30" name="__codelineno-51-30"></a><span class="w">  </span><span class="c1">// Initial guess values</span>
</span><span id="__span-51-31"><a id="__codelineno-51-31" name="__codelineno-51-31"></a><span class="w">  </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-51-32"><a id="__codelineno-51-32" name="__codelineno-51-32"></a><span class="w">  </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-51-33"><a id="__codelineno-51-33" name="__codelineno-51-33"></a>
</span><span id="__span-51-34"><a id="__codelineno-51-34" name="__codelineno-51-34"></a><span class="w">  </span><span class="c1">// Solve the equation system</span>
</span><span id="__span-51-35"><a id="__codelineno-51-35" name="__codelineno-51-35"></a><span class="hll"><span class="w">  </span><span class="n">roofnr</span><span class="p">(</span><span class="o">@</span><span class="n">funcs</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">residu</span><span class="o">,</span><span class="w"> </span><span class="n">ra</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-51-36"><a id="__codelineno-51-36" name="__codelineno-51-36"></a>
</span><span id="__span-51-37"><a id="__codelineno-51-37" name="__codelineno-51-37"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'term = '</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-38"><a id="__codelineno-51-38" name="__codelineno-51-38"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-51-39"><a id="__codelineno-51-39" name="__codelineno-51-39"></a>
</span><span id="__span-51-40"><a id="__codelineno-51-40" name="__codelineno-51-40"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-51-41"><a id="__codelineno-51-41" name="__codelineno-51-41"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Results found by procedure roofnr:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-42"><a id="__codelineno-51-42" name="__codelineno-51-42"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-51-43"><a id="__codelineno-51-43" name="__codelineno-51-43"></a><span class="w">      </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Solution #'</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">IntToStr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">': '</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">6</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-44"><a id="__codelineno-51-44" name="__codelineno-51-44"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Norm of residuals: '</span><span class="o">,</span><span class="w"> </span><span class="n">residu</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">15</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-45"><a id="__codelineno-51-45" name="__codelineno-51-45"></a><span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">else</span>
</span><span id="__span-51-46"><a id="__codelineno-51-46" name="__codelineno-51-46"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'ERROR'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-47"><a id="__codelineno-51-47" name="__codelineno-51-47"></a>
</span><span id="__span-51-48"><a id="__codelineno-51-48" name="__codelineno-51-48"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-51-49"><a id="__codelineno-51-49" name="__codelineno-51-49"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-51-50"><a id="__codelineno-51-50" name="__codelineno-51-50"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-51-51"><a id="__codelineno-51-51" name="__codelineno-51-51"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>term = 1
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>Results found by procedure roofnr:
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>Solution #1: 1.404698
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>Solution #2: 0.163780
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>Norm of residuals: 0.000000000000000
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>Press enter to quit
</span></code></pre></div>
<h2 id="unit-int-numerical-integration-of-a-function">Unit <code>int</code> - Numerical integration of a function<a class="headerlink" href="#unit-int-numerical-integration-of-a-function" title="Permanent link">¶</a></h2>
<p>The <code>int1fr</code> function in the <code>NumLib</code> library calculates the integral of a given function between limits <code>a</code> and <code>b</code>, with a specified absolute accuracy <code>ae</code>:</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">int1fr</span><span class="p">(</span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="n">rfunc1r</span><span class="o">;</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">ae</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">integral</span><span class="o">,</span><span class="w"> </span><span class="n">err</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><code>f</code></strong>: A pointer to the function to be integrated. The function must take a single real variable of type <code>ArbFloat</code> and return a value of type <code>ArbFloat</code>. The function type is declared as <code>rfunc1r</code> in the <code>typ</code> unit.</p>
</li>
<li>
<p><strong><code>a, b</code></strong>: The integration limits. These can also be set to <code>+/-Infinity</code> to allow integration over infinite intervals. The order of <code>a</code> and <code>b</code> follows correct mathematical conventions.</p>
</li>
<li>
<p><strong><code>ae</code></strong>: The required absolute accuracy for the result.</p>
</li>
<li>
<p><strong><code>integral</code></strong>: The result of the integration. It is valid only if <code>term = 1</code>.</p>
</li>
<li>
<p><strong><code>err</code></strong>: The error in accuracy if the requested precision could not be achieved. In this case, <code>term = 2</code>.</p>
</li>
<li>
<p><strong><code>term</code></strong>: The termination status code:</p>
<ul>
<li><code>1</code>: Integration successful with absolute accuracy <code>ae</code>.</li>
<li><code>2</code>: Requested accuracy not reached, but the result is approximated with error <code>err</code>.</li>
<li><code>3</code>: Invalid input (e.g., <code>ae &lt; 0</code>, or both <code>a</code> and <code>b</code> are infinite).</li>
<li><code>4</code>: Integration failed due to divergence or slow convergence.</li>
</ul>
</li>
</ul>
<p><strong>Example</strong></p>
<p>This example demonstrates calculating the integral:</p>
<div class="arithmatex">\[
\int_a^b \frac{1}{x^2} \, dx
\]</div>
<p>for various integration limits <code>a</code> and <code>b</code>. Since the function diverges at <code>x = 0</code>, the integration interval must not include this point. The expected analytic result is provided for comparison.</p>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-54-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-54-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-54-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-54-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-54-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-54-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-54-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-54-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-54-10">10</a></span>
<span class="normal"><a href="#__codelineno-54-11">11</a></span>
<span class="normal"><a href="#__codelineno-54-12">12</a></span>
<span class="normal"><a href="#__codelineno-54-13">13</a></span>
<span class="normal"><a href="#__codelineno-54-14">14</a></span>
<span class="normal"><a href="#__codelineno-54-15">15</a></span>
<span class="normal"><a href="#__codelineno-54-16">16</a></span>
<span class="normal"><a href="#__codelineno-54-17">17</a></span>
<span class="normal"><a href="#__codelineno-54-18">18</a></span>
<span class="normal"><a href="#__codelineno-54-19">19</a></span>
<span class="normal"><a href="#__codelineno-54-20">20</a></span>
<span class="normal"><a href="#__codelineno-54-21">21</a></span>
<span class="normal"><a href="#__codelineno-54-22">22</a></span>
<span class="normal"><a href="#__codelineno-54-23">23</a></span>
<span class="normal"><a href="#__codelineno-54-24">24</a></span>
<span class="normal"><a href="#__codelineno-54-25">25</a></span>
<span class="normal"><a href="#__codelineno-54-26">26</a></span>
<span class="normal"><a href="#__codelineno-54-27">27</a></span>
<span class="normal"><a href="#__codelineno-54-28">28</a></span>
<span class="normal"><a href="#__codelineno-54-29">29</a></span>
<span class="normal"><a href="#__codelineno-54-30">30</a></span>
<span class="normal"><a href="#__codelineno-54-31">31</a></span>
<span class="normal"><a href="#__codelineno-54-32">32</a></span>
<span class="normal"><a href="#__codelineno-54-33">33</a></span>
<span class="normal"><a href="#__codelineno-54-34">34</a></span>
<span class="normal"><a href="#__codelineno-54-35">35</a></span>
<span class="normal"><a href="#__codelineno-54-36">36</a></span>
<span class="normal"><a href="#__codelineno-54-37">37</a></span>
<span class="normal"><a href="#__codelineno-54-38">38</a></span>
<span class="normal"><a href="#__codelineno-54-39">39</a></span>
<span class="normal"><a href="#__codelineno-54-40">40</a></span>
<span class="normal"><a href="#__codelineno-54-41">41</a></span>
<span class="normal"><a href="#__codelineno-54-42">42</a></span>
<span class="normal"><a href="#__codelineno-54-43">43</a></span>
<span class="normal"><a href="#__codelineno-54-44">44</a></span>
<span class="normal"><a href="#__codelineno-54-45">45</a></span>
<span class="normal"><a href="#__codelineno-54-46">46</a></span>
<span class="normal"><a href="#__codelineno-54-47">47</a></span>
<span class="normal"><a href="#__codelineno-54-48">48</a></span>
<span class="normal"><a href="#__codelineno-54-49">49</a></span>
<span class="normal"><a href="#__codelineno-54-50">50</a></span>
<span class="normal"><a href="#__codelineno-54-51">51</a></span>
<span class="normal"><a href="#__codelineno-54-52">52</a></span>
<span class="normal"><a href="#__codelineno-54-53">53</a></span>
<span class="normal"><a href="#__codelineno-54-54">54</a></span>
<span class="normal"><a href="#__codelineno-54-55">55</a></span>
<span class="normal"><a href="#__codelineno-54-56">56</a></span>
<span class="normal"><a href="#__codelineno-54-57">57</a></span>
<span class="normal"><a href="#__codelineno-54-58">58</a></span>
<span class="normal"><a href="#__codelineno-54-59">59</a></span>
<span class="normal"><a href="#__codelineno-54-60">60</a></span>
<span class="normal"><a href="#__codelineno-54-61">61</a></span>
<span class="normal"><a href="#__codelineno-54-62">62</a></span>
<span class="normal"><a href="#__codelineno-54-63">63</a></span>
<span class="normal"><a href="#__codelineno-54-64">64</a></span>
<span class="normal"><a href="#__codelineno-54-65">65</a></span>
<span class="normal"><a href="#__codelineno-54-66">66</a></span>
<span class="normal"><a href="#__codelineno-54-67">67</a></span>
<span class="normal"><a href="#__codelineno-54-68">68</a></span>
<span class="normal"><a href="#__codelineno-54-69">69</a></span>
<span class="normal"><a href="#__codelineno-54-70">70</a></span>
<span class="normal"><a href="#__codelineno-54-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="k">program</span><span class="w"> </span><span class="n">integrate</span><span class="o">;</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2"></a>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4"></a>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5"></a><span class="k">uses</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">Math</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="nb">int</span><span class="o">;</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7"></a>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8"></a><span class="c1">// Function representing 1/x^2</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9"></a><span class="k">function</span><span class="w"> </span><span class="nf">recipx2</span><span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10"></a><span class="k">begin</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11"></a><span class="w">  </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13"></a>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14"></a><span class="c1">// Analytic result of the integral</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15"></a><span class="k">function</span><span class="w"> </span><span class="nf">integral_recipx2</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">Arbfloat</span><span class="o">;</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16"></a><span class="k">begin</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Infinity</span>
</span><span id="__span-54-19"><a id="__codelineno-54-19" name="__codelineno-54-19"></a><span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Infinity</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-54-20"><a id="__codelineno-54-20" name="__codelineno-54-20"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.0</span>
</span><span id="__span-54-21"><a id="__codelineno-54-21" name="__codelineno-54-21"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-54-22"><a id="__codelineno-54-22" name="__codelineno-54-22"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">a</span><span class="o">;</span>
</span><span id="__span-54-23"><a id="__codelineno-54-23" name="__codelineno-54-23"></a>
</span><span id="__span-54-24"><a id="__codelineno-54-24" name="__codelineno-54-24"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-54-25"><a id="__codelineno-54-25" name="__codelineno-54-25"></a><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Infinity</span>
</span><span id="__span-54-26"><a id="__codelineno-54-26" name="__codelineno-54-26"></a><span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Infinity</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-54-27"><a id="__codelineno-54-27" name="__codelineno-54-27"></a><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.0</span>
</span><span id="__span-54-28"><a id="__codelineno-54-28" name="__codelineno-54-28"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-54-29"><a id="__codelineno-54-29" name="__codelineno-54-29"></a><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="o">;</span>
</span><span id="__span-54-30"><a id="__codelineno-54-30" name="__codelineno-54-30"></a>
</span><span id="__span-54-31"><a id="__codelineno-54-31" name="__codelineno-54-31"></a><span class="w">  </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="o">;</span>
</span><span id="__span-54-32"><a id="__codelineno-54-32" name="__codelineno-54-32"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-54-33"><a id="__codelineno-54-33" name="__codelineno-54-33"></a>
</span><span id="__span-54-34"><a id="__codelineno-54-34" name="__codelineno-54-34"></a><span class="c1">// Execute the integration and handle the result</span>
</span><span id="__span-54-35"><a id="__codelineno-54-35" name="__codelineno-54-35"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">Execute</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-36"><a id="__codelineno-54-36" name="__codelineno-54-36"></a><span class="k">var</span>
</span><span id="__span-54-37"><a id="__codelineno-54-37" name="__codelineno-54-37"></a><span class="w">  </span><span class="n">err</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span>
</span><span id="__span-54-38"><a id="__codelineno-54-38" name="__codelineno-54-38"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">;</span>
</span><span id="__span-54-39"><a id="__codelineno-54-39" name="__codelineno-54-39"></a><span class="w">  </span><span class="n">integral</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span>
</span><span id="__span-54-40"><a id="__codelineno-54-40" name="__codelineno-54-40"></a><span class="hll"><span class="k">begin</span>
</span></span><span id="__span-54-41"><a id="__codelineno-54-41" name="__codelineno-54-41"></a><span class="w">  </span><span class="k">try</span>
</span><span id="__span-54-42"><a id="__codelineno-54-42" name="__codelineno-54-42"></a><span class="w">    </span><span class="n">int1fr</span><span class="p">(</span><span class="o">@</span><span class="n">recipx2</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="mf">1e-9</span><span class="o">,</span><span class="w"> </span><span class="n">integral</span><span class="o">,</span><span class="w"> </span><span class="n">err</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-43"><a id="__codelineno-54-43" name="__codelineno-54-43"></a><span class="w">  </span><span class="k">except</span>
</span><span id="__span-54-44"><a id="__codelineno-54-44" name="__codelineno-54-44"></a><span class="w">    </span><span class="n">term</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">4</span><span class="o">;</span>
</span><span id="__span-54-45"><a id="__codelineno-54-45" name="__codelineno-54-45"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-54-46"><a id="__codelineno-54-46" name="__codelineno-54-46"></a>
</span><span id="__span-54-47"><a id="__codelineno-54-47" name="__codelineno-54-47"></a><span class="w">  </span><span class="nb">Write</span><span class="p">(</span><span class="s">'  The integral from '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">FloatToStr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">' to '</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">FloatToStr</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">;</span>
</span><span id="__span-54-48"><a id="__codelineno-54-48" name="__codelineno-54-48"></a>
</span><span id="__span-54-49"><a id="__codelineno-54-49" name="__codelineno-54-49"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="k">of</span>
</span><span id="__span-54-50"><a id="__codelineno-54-50" name="__codelineno-54-50"></a><span class="w">    </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">' is '</span><span class="o">,</span><span class="w"> </span><span class="n">integral</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">9</span><span class="o">,</span><span class="w"> </span><span class="s">', expected: '</span><span class="o">,</span><span class="w"> </span><span class="n">integral_recipx2</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-51"><a id="__codelineno-54-51" name="__codelineno-54-51"></a><span class="w">    </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">' is '</span><span class="o">,</span><span class="w"> </span><span class="n">integral</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">9</span><span class="o">,</span><span class="w"> </span><span class="s">', error: '</span><span class="o">,</span><span class="w"> </span><span class="n">err</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">9</span><span class="o">,</span><span class="w"> </span><span class="s">', expected: '</span><span class="o">,</span><span class="w"> </span><span class="n">integral_recipx2</span><span class="p">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-52"><a id="__codelineno-54-52" name="__codelineno-54-52"></a><span class="w">    </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">' cannot be calculated: Invalid input.'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-53"><a id="__codelineno-54-53" name="__codelineno-54-53"></a><span class="w">    </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">' cannot be calculated: Divergence or slow convergence.'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-54"><a id="__codelineno-54-54" name="__codelineno-54-54"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-54-55"><a id="__codelineno-54-55" name="__codelineno-54-55"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-54-56"><a id="__codelineno-54-56" name="__codelineno-54-56"></a>
</span><span id="__span-54-57"><a id="__codelineno-54-57" name="__codelineno-54-57"></a><span class="k">begin</span>
</span><span id="__span-54-58"><a id="__codelineno-54-58" name="__codelineno-54-58"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Integral of f(x) = 1/x^2'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-59"><a id="__codelineno-54-59" name="__codelineno-54-59"></a><span class="w">  </span><span class="n">Execute</span><span class="p">(</span><span class="mf">1.0</span><span class="o">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-60"><a id="__codelineno-54-60" name="__codelineno-54-60"></a><span class="w">  </span><span class="n">Execute</span><span class="p">(</span><span class="mf">1.0</span><span class="o">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-61"><a id="__codelineno-54-61" name="__codelineno-54-61"></a><span class="w">  </span><span class="n">Execute</span><span class="p">(</span><span class="mf">2.0</span><span class="o">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-62"><a id="__codelineno-54-62" name="__codelineno-54-62"></a><span class="w">  </span><span class="n">Execute</span><span class="p">(</span><span class="mf">1.0</span><span class="o">,</span><span class="w"> </span><span class="n">Infinity</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-63"><a id="__codelineno-54-63" name="__codelineno-54-63"></a><span class="w">  </span><span class="n">Execute</span><span class="p">(</span><span class="o">-</span><span class="n">Infinity</span><span class="o">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-64"><a id="__codelineno-54-64" name="__codelineno-54-64"></a><span class="w">  </span><span class="n">Execute</span><span class="p">(</span><span class="mf">0.0</span><span class="o">,</span><span class="w"> </span><span class="n">Infinity</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-65"><a id="__codelineno-54-65" name="__codelineno-54-65"></a><span class="w">  </span><span class="c1">// Note: The following case will raise an exception in some environments, but works outside the IDE.</span>
</span><span id="__span-54-66"><a id="__codelineno-54-66" name="__codelineno-54-66"></a><span class="w">  </span><span class="c1">// Execute(-1.0, Infinity);</span>
</span><span id="__span-54-67"><a id="__codelineno-54-67" name="__codelineno-54-67"></a>
</span><span id="__span-54-68"><a id="__codelineno-54-68" name="__codelineno-54-68"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-54-69"><a id="__codelineno-54-69" name="__codelineno-54-69"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-54-70"><a id="__codelineno-54-70" name="__codelineno-54-70"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-54-71"><a id="__codelineno-54-71" name="__codelineno-54-71"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>
<p><strong><code>recipx2</code></strong>: This function returns <span class="arithmatex">\( \frac{1}{x^2} \)</span>, which is the integrand.</p>
</li>
<li>
<p><strong><code>integral_recipx2</code></strong>: Computes the expected analytic result for the given integration limits.</p>
</li>
<li>
<p><strong><code>Execute</code></strong>: Runs the integration for the specified limits <code>a</code> and <code>b</code>, handles potential errors, and prints the result.</p>
</li>
</ul>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>Integral of f(x) = 1/x^2
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>  The integral from 1 to 2 is 0.500000000, expected: 0.500000000
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>  The integral from 1 to 1 is 0.000000000, expected: 0.000000000
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>  The integral from 2 to 1 is -0.500000000, expected: -0.500000000
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>  The integral from 1 to +Inf is 1.000000000, expected: 1.000000000
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>  The integral from -Inf to -1 is 1.000000000, expected: 1.000000000
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>  The integral from 0 to +Inf cannot be calculated: Divergence or slow convergence.
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>Press enter to quit
</span></code></pre></div>
<h2 id="unit-ode-ordinary-differential-equations">Unit <code>ode</code> - Ordinary differential equations<a class="headerlink" href="#unit-ode-ordinary-differential-equations" title="Permanent link">¶</a></h2>
<h3 id="solving-a-single-first-order-differential-equation">Solving a Single First-Order Differential Equation<a class="headerlink" href="#solving-a-single-first-order-differential-equation" title="Permanent link">¶</a></h3>
<p>The procedure <code>odeiv1</code> solves an initial value problem for a first-order differential equation of the form:</p>
<div class="arithmatex">\[
\begin{cases}
y' = f(x, y), \qquad x \in [a, b] \\
y(a) = \alpha
\end{cases}
\]</div>
<p>where <code>a</code>, <code>b</code>, <code>f</code>, and the initial condition <code>y(a) = α</code> are given.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">odeiv1</span><span class="p">(</span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="n">rfunc2r</span><span class="o">;</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">ae</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>f</code>: The function to be solved, depending on two real variables and returning a real value. Defined as <code>type rfunc2r = function(x, y: ArbFloat): ArbFloat</code>.</li>
<li><code>a</code>: The starting <code>x</code> value of the interval.</li>
<li><code>ya</code>: The initial value <code>α</code> at <code>x = a</code>.</li>
<li><code>b</code>: The end <code>x</code> value of the interval. After the calculation, if <code>term = 2</code>, <code>b</code> contains the new endpoint with the required accuracy, <code>ae</code>.</li>
<li><code>yb</code>: Returns the computed value <code>y(b)</code> if <code>term &lt; 3</code>. If <code>term = 3</code>, the result is undefined.</li>
<li><code>ae</code>: Specifies the absolute accuracy required for <code>y(b)</code>.</li>
<li><code>term</code>: Returns the following error codes:<ul>
<li><code>1</code>: Successful completion.</li>
<li><code>2</code>: The solution could not reach <code>b</code> with the required accuracy. <code>yb</code> is an approximation at the delivered <code>b</code>.</li>
<li><code>3</code>: Input error, <code>ae &lt;= 0</code>.</li>
</ul>
</li>
</ul>
<p>This algorithm is based on a fifth-order adaptive Runge-Kutta method. It may not be accurate for stiff differential equations, and accuracy issues can arise in unstable problems where small variations in <code>y(a)</code> cause large variations in <code>y(b)</code>.</p>
<p>If you want to solve for multiple points, like from <code>x = 0</code> to <code>x = 1</code> with a step size of 0.1, avoid restarting at each step and "integrate" instead.</p>
<p><strong>Example</strong></p>
<p>Solve the equation <span class="arithmatex">\(y'' = -10  (y - x^2)\)</span> with initial condition <span class="arithmatex">\(y(0) = 0\)</span> and compare it to the exact solution <span class="arithmatex">\(y(x) = -0.02  exp(-10  x) + x^2 - 0.2  x + 0.02\)</span>.</p>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-57-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-57-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-57-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-57-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-57-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-57-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-57-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-57-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-57-10">10</a></span>
<span class="normal"><a href="#__codelineno-57-11">11</a></span>
<span class="normal"><a href="#__codelineno-57-12">12</a></span>
<span class="normal"><a href="#__codelineno-57-13">13</a></span>
<span class="normal"><a href="#__codelineno-57-14">14</a></span>
<span class="normal"><a href="#__codelineno-57-15">15</a></span>
<span class="normal"><a href="#__codelineno-57-16">16</a></span>
<span class="normal"><a href="#__codelineno-57-17">17</a></span>
<span class="normal"><a href="#__codelineno-57-18">18</a></span>
<span class="normal"><a href="#__codelineno-57-19">19</a></span>
<span class="normal"><a href="#__codelineno-57-20">20</a></span>
<span class="normal"><a href="#__codelineno-57-21">21</a></span>
<span class="normal"><a href="#__codelineno-57-22">22</a></span>
<span class="normal"><a href="#__codelineno-57-23">23</a></span>
<span class="normal"><a href="#__codelineno-57-24">24</a></span>
<span class="normal"><a href="#__codelineno-57-25">25</a></span>
<span class="normal"><a href="#__codelineno-57-26">26</a></span>
<span class="normal"><a href="#__codelineno-57-27">27</a></span>
<span class="normal"><a href="#__codelineno-57-28">28</a></span>
<span class="normal"><a href="#__codelineno-57-29">29</a></span>
<span class="normal"><a href="#__codelineno-57-30">30</a></span>
<span class="normal"><a href="#__codelineno-57-31">31</a></span>
<span class="normal"><a href="#__codelineno-57-32">32</a></span>
<span class="normal"><a href="#__codelineno-57-33">33</a></span>
<span class="normal"><a href="#__codelineno-57-34">34</a></span>
<span class="normal"><a href="#__codelineno-57-35">35</a></span>
<span class="normal"><a href="#__codelineno-57-36">36</a></span>
<span class="normal"><a href="#__codelineno-57-37">37</a></span>
<span class="normal"><a href="#__codelineno-57-38">38</a></span>
<span class="normal"><a href="#__codelineno-57-39">39</a></span>
<span class="normal"><a href="#__codelineno-57-40">40</a></span>
<span class="normal"><a href="#__codelineno-57-41">41</a></span>
<span class="normal"><a href="#__codelineno-57-42">42</a></span>
<span class="normal"><a href="#__codelineno-57-43">43</a></span>
<span class="normal"><a href="#__codelineno-57-44">44</a></span>
<span class="normal"><a href="#__codelineno-57-45">45</a></span>
<span class="normal"><a href="#__codelineno-57-46">46</a></span>
<span class="normal"><a href="#__codelineno-57-47">47</a></span>
<span class="normal"><a href="#__codelineno-57-48">48</a></span>
<span class="normal"><a href="#__codelineno-57-49">49</a></span>
<span class="normal"><a href="#__codelineno-57-50">50</a></span>
<span class="normal"><a href="#__codelineno-57-51">51</a></span>
<span class="normal"><a href="#__codelineno-57-52">52</a></span>
<span class="normal"><a href="#__codelineno-57-53">53</a></span>
<span class="normal"><a href="#__codelineno-57-54">54</a></span>
<span class="normal"><a href="#__codelineno-57-55">55</a></span>
<span class="normal"><a href="#__codelineno-57-56">56</a></span>
<span class="normal"><a href="#__codelineno-57-57">57</a></span>
<span class="normal"><a href="#__codelineno-57-58">58</a></span>
<span class="normal"><a href="#__codelineno-57-59">59</a></span>
<span class="normal"><a href="#__codelineno-57-60">60</a></span>
<span class="normal"><a href="#__codelineno-57-61">61</a></span>
<span class="normal"><a href="#__codelineno-57-62">62</a></span>
<span class="normal"><a href="#__codelineno-57-63">63</a></span>
<span class="normal"><a href="#__codelineno-57-64">64</a></span>
<span class="normal"><a href="#__codelineno-57-65">65</a></span>
<span class="normal"><a href="#__codelineno-57-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_ode</span><span class="o">;</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2"></a>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4"></a>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5"></a><span class="k">uses</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="c1">// This unit contains common type definitions used in the program.</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7"></a><span class="w">  </span><span class="n">ode</span><span class="o">;</span><span class="w"> </span><span class="c1">// This unit provides the ODE solver `odeiv1` used in the program.</span>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8"></a>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9"></a><span class="c1">// Define the function representing the differential equation: y' = f(x, y).</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10"></a><span class="c1">// In this case, f(x, y) = -10 * (y - x^2), a basic second-order ODE.</span>
</span><span id="__span-57-11"><a id="__codelineno-57-11" name="__codelineno-57-11"></a><span class="k">function</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-57-12"><a id="__codelineno-57-12" name="__codelineno-57-12"></a><span class="k">begin</span>
</span><span id="__span-57-13"><a id="__codelineno-57-13" name="__codelineno-57-13"></a><span class="w">  </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">;</span><span class="w"> </span><span class="c1">// sqr(x) calculates x^2</span>
</span><span id="__span-57-14"><a id="__codelineno-57-14" name="__codelineno-57-14"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-57-15"><a id="__codelineno-57-15" name="__codelineno-57-15"></a>
</span><span id="__span-57-16"><a id="__codelineno-57-16" name="__codelineno-57-16"></a><span class="c1">// Define the exact analytical solution for comparison purposes.</span>
</span><span id="__span-57-17"><a id="__codelineno-57-17" name="__codelineno-57-17"></a><span class="c1">// The solution to the differential equation is given by y(x) = -0.02 * exp(-10 * x) + x^2 - 0.2 * x + 0.02.</span>
</span><span id="__span-57-18"><a id="__codelineno-57-18" name="__codelineno-57-18"></a><span class="k">function</span><span class="w"> </span><span class="nf">exact</span><span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="kt">real</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">real</span><span class="o">;</span><span class="w"> </span><span class="kp">far</span><span class="o">;</span>
</span><span id="__span-57-19"><a id="__codelineno-57-19" name="__codelineno-57-19"></a><span class="k">begin</span>
</span><span id="__span-57-20"><a id="__codelineno-57-20" name="__codelineno-57-20"></a><span class="w">  </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mf">0.02</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.02</span><span class="o">;</span>
</span><span id="__span-57-21"><a id="__codelineno-57-21" name="__codelineno-57-21"></a><span class="k">end</span><span class="o">;</span>
</span><span id="__span-57-22"><a id="__codelineno-57-22" name="__codelineno-57-22"></a>
</span><span id="__span-57-23"><a id="__codelineno-57-23" name="__codelineno-57-23"></a><span class="k">const</span>
</span><span id="__span-57-24"><a id="__codelineno-57-24" name="__codelineno-57-24"></a><span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">;</span><span class="w">  </span><span class="c1">// The length of the interval over which to solve the ODE.</span>
</span><span id="__span-57-25"><a id="__codelineno-57-25" name="__codelineno-57-25"></a><span class="w">  </span><span class="n">ae</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-5</span><span class="o">;</span><span class="w"> </span><span class="c1">// The absolute error tolerance for the ODE solver.</span>
</span><span id="__span-57-26"><a id="__codelineno-57-26" name="__codelineno-57-26"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="o">;</span><span class="w">    </span><span class="c1">// The number of steps to take between the start and end of the interval.</span>
</span><span id="__span-57-27"><a id="__codelineno-57-27" name="__codelineno-57-27"></a>
</span><span id="__span-57-28"><a id="__codelineno-57-28" name="__codelineno-57-28"></a><span class="k">var</span>
</span><span id="__span-57-29"><a id="__codelineno-57-29" name="__codelineno-57-29"></a><span class="w">  </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="c1">// Variables representing the interval endpoints and function values.</span>
</span><span id="__span-57-30"><a id="__codelineno-57-30" name="__codelineno-57-30"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w">           </span><span class="c1">// Variable to hold the error code returned by the ODE solver.</span>
</span><span id="__span-57-31"><a id="__codelineno-57-31" name="__codelineno-57-31"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w">              </span><span class="c1">// Loop counter.</span>
</span><span id="__span-57-32"><a id="__codelineno-57-32" name="__codelineno-57-32"></a>
</span><span id="__span-57-33"><a id="__codelineno-57-33" name="__codelineno-57-33"></a><span class="k">begin</span>
</span><span id="__span-57-34"><a id="__codelineno-57-34" name="__codelineno-57-34"></a><span class="w">  </span><span class="c1">// Set initial conditions for the ODE solver.</span>
</span><span id="__span-57-35"><a id="__codelineno-57-35" name="__codelineno-57-35"></a><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span><span class="w">      </span><span class="c1">// Start at x = 0.</span>
</span><span id="__span-57-36"><a id="__codelineno-57-36" name="__codelineno-57-36"></a><span class="w">  </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="o">;</span><span class="w">    </span><span class="c1">// End of the first step at x = 0.5 (the interval length).</span>
</span><span id="__span-57-37"><a id="__codelineno-57-37" name="__codelineno-57-37"></a><span class="w">  </span><span class="n">ya</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span><span class="w">     </span><span class="c1">// Initial condition: y(0) = 0.</span>
</span><span id="__span-57-38"><a id="__codelineno-57-38" name="__codelineno-57-38"></a>
</span><span id="__span-57-39"><a id="__codelineno-57-39" name="__codelineno-57-39"></a><span class="w">  </span><span class="c1">// Print table headers for output (x, y, exact solution, error code).</span>
</span><span id="__span-57-40"><a id="__codelineno-57-40" name="__codelineno-57-40"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'x'</span><span class="o">:</span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'y'</span><span class="o">:</span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'exact'</span><span class="o">:</span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'error code'</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-57-41"><a id="__codelineno-57-41" name="__codelineno-57-41"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-57-42"><a id="__codelineno-57-42" name="__codelineno-57-42"></a>
</span><span id="__span-57-43"><a id="__codelineno-57-43" name="__codelineno-57-43"></a><span class="w">  </span><span class="c1">// Output the initial condition at x = 0.</span>
</span><span id="__span-57-44"><a id="__codelineno-57-44" name="__codelineno-57-44"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">a</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="s">'-'</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span><span class="o">;</span><span class="w"> </span><span class="c1">// Display the starting point.</span>
</span><span id="__span-57-45"><a id="__codelineno-57-45" name="__codelineno-57-45"></a>
</span><span id="__span-57-46"><a id="__codelineno-57-46" name="__codelineno-57-46"></a><span class="w">  </span><span class="c1">// Loop to solve the ODE in steps of 0.5 (controlled by 'd') until n steps are done.</span>
</span><span id="__span-57-47"><a id="__codelineno-57-47" name="__codelineno-57-47"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-57-48"><a id="__codelineno-57-48" name="__codelineno-57-48"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-57-49"><a id="__codelineno-57-49" name="__codelineno-57-49"></a><span class="w">    </span><span class="c1">// Call the ODE solver (odeiv1) to compute y(b) based on the function 'f'.</span>
</span><span id="__span-57-50"><a id="__codelineno-57-50" name="__codelineno-57-50"></a><span class="w">    </span><span class="c1">// a: start of the interval, ya: initial value y(a), b: end of interval,</span>
</span><span id="__span-57-51"><a id="__codelineno-57-51" name="__codelineno-57-51"></a><span class="w">    </span><span class="c1">// yb: result of y(b), ae: accuracy, term: error code.</span>
</span><span id="__span-57-52"><a id="__codelineno-57-52" name="__codelineno-57-52"></a><span class="hll"><span class="w">    </span><span class="n">odeiv1</span><span class="p">(</span><span class="o">@</span><span class="n">f</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="o">,</span><span class="w"> </span><span class="n">ae</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-57-53"><a id="__codelineno-57-53" name="__codelineno-57-53"></a>
</span><span id="__span-57-54"><a id="__codelineno-57-54" name="__codelineno-57-54"></a><span class="w">    </span><span class="c1">// Output the results after each step: x = b, y(b), exact solution, and error code.</span>
</span><span id="__span-57-55"><a id="__codelineno-57-55" name="__codelineno-57-55"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">b</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">exact</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="mi">17</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-57-56"><a id="__codelineno-57-56" name="__codelineno-57-56"></a>
</span><span id="__span-57-57"><a id="__codelineno-57-57" name="__codelineno-57-57"></a><span class="w">    </span><span class="c1">// Update for the next step: set a = b and ya = yb, and increment b by 'd' for the next interval.</span>
</span><span id="__span-57-58"><a id="__codelineno-57-58" name="__codelineno-57-58"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="o">;</span><span class="w">     </span><span class="c1">// Move to the next interval.</span>
</span><span id="__span-57-59"><a id="__codelineno-57-59" name="__codelineno-57-59"></a><span class="w">    </span><span class="n">ya</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">yb</span><span class="o">;</span><span class="w">   </span><span class="c1">// Use the computed value y(b) as the initial value for the next step.</span>
</span><span id="__span-57-60"><a id="__codelineno-57-60" name="__codelineno-57-60"></a><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="o">;</span><span class="w"> </span><span class="c1">// Increment b for the next step.</span>
</span><span id="__span-57-61"><a id="__codelineno-57-61" name="__codelineno-57-61"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-57-62"><a id="__codelineno-57-62" name="__codelineno-57-62"></a>
</span><span id="__span-57-63"><a id="__codelineno-57-63" name="__codelineno-57-63"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-57-64"><a id="__codelineno-57-64" name="__codelineno-57-64"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-57-65"><a id="__codelineno-57-65" name="__codelineno-57-65"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-57-66"><a id="__codelineno-57-66" name="__codelineno-57-66"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>           x           y       exact       error code
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>     0.00000     0.00000     0.00000                -
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>     0.50000     0.16986     0.16987                1
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>     1.00000     0.82000     0.82000                1
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>     1.50000     1.97000     1.97000                1
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>     2.00000     3.62000     3.62000                1
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>     2.50000     5.77000     5.77000                1
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>     3.00000     8.42000     8.42000                1
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>     3.50000    11.57000    11.57000                1
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>     4.00000    15.22000    15.22000                1
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>     4.50000    19.37000    19.37000                1
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a>     5.00000    24.02000    24.02000                1
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a>Press enter to quit
</span></code></pre></div>
<h3 id="solving-a-system-of-first-order-differential-equations">Solving a System of First-Order Differential Equations<a class="headerlink" href="#solving-a-system-of-first-order-differential-equations" title="Permanent link">¶</a></h3>
<p>To solve a system of first-order differential equations:</p>
<div class="arithmatex">\[
\begin{cases}
\mathbf{y}' = \mathbf{f}(x, \mathbf{y}), \qquad x \in [a, b] \\
\mathbf{y}(a) = \alpha
\end{cases}
\]</div>
<p>where:</p>
<ul>
<li><code>y</code> is a vector <span class="arithmatex">\([y_1(x), y_2(x), ..., y_n(x)]\)</span>,</li>
<li><code>f(x, y)</code> is a vector function <span class="arithmatex">\([f_1(x, y), f_2(x, y), ..., f_n(x, y)]\)</span>,</li>
<li>The initial conditions are given as <span class="arithmatex">\(y(a) = [y_1(a), y_2(a), ..., y_n(a)]\)</span>.</li>
</ul>
<p>This can be solved using the procedure <code>odeiv2</code>, which uses an adaptive fifth-order Runge-Kutta method with variable step size.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">odeiv2</span><span class="p">(</span><span class="n">f</span><span class="o">:</span><span class="w"> </span><span class="n">oderk1n</span><span class="o">;</span><span class="w"> </span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">ya</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="n">ae</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>f</code>: The procedure calculating <span class="arithmatex">\(f_i(x, y_i)\)</span> values. It is of type <code>oderk1n = procedure(x: ArbFloat; var y, fxy: ArbFloat)</code>.</li>
<li><code>a</code>: Starting point of the calculation.</li>
<li><code>ya</code>: Initial values for the system, stored in an array.</li>
<li><code>b</code>: Endpoint of the interval. If <code>term = 2</code>, <code>b</code> will be updated.</li>
<li><code>yb</code>: Stores the results.</li>
<li><code>n</code>: Number of equations in the system.</li>
<li><code>ae</code>: Specifies absolute accuracy.</li>
<li><code>term</code>: Error codes:</li>
<li><code>1</code>: Successful completion.</li>
<li><code>2</code>: Solution couldn't reach <code>b</code> with desired accuracy. <code>yb</code> contains approximations.</li>
<li><code>3</code>: Input error, <code>n &lt; 1</code> or <code>ae &lt;= 0</code>.</li>
</ul>
<p><strong>Example</strong></p>
<p>Integrate the following system of ODEs between <code>x = 0</code> and <code>x = 1</code>:</p>
<div class="arithmatex">\[
\begin{cases}
y'_1 = 2xy_1 + y_2 \\
y'_2 = -y_1 + 2xy_2 \\
y_1(0) = 0, \quad y_2(0) = 1
\end{cases}
\]</div>
<p>The exact solutions are:</p>
<div class="arithmatex">\[
\begin{cases}
y_1(x) = \exp(x^2) \sin(x) \\
y_2(x) = \exp(x^2) \cos(x)
\end{cases}
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span>
<span class="normal"><a href="#__codelineno-60-15">15</a></span>
<span class="normal"><a href="#__codelineno-60-16">16</a></span>
<span class="normal"><a href="#__codelineno-60-17">17</a></span>
<span class="normal"><a href="#__codelineno-60-18">18</a></span>
<span class="normal"><a href="#__codelineno-60-19">19</a></span>
<span class="normal"><a href="#__codelineno-60-20">20</a></span>
<span class="normal"><a href="#__codelineno-60-21">21</a></span>
<span class="normal"><a href="#__codelineno-60-22">22</a></span>
<span class="normal"><a href="#__codelineno-60-23">23</a></span>
<span class="normal"><a href="#__codelineno-60-24">24</a></span>
<span class="normal"><a href="#__codelineno-60-25">25</a></span>
<span class="normal"><a href="#__codelineno-60-26">26</a></span>
<span class="normal"><a href="#__codelineno-60-27">27</a></span>
<span class="normal"><a href="#__codelineno-60-28">28</a></span>
<span class="normal"><a href="#__codelineno-60-29">29</a></span>
<span class="normal"><a href="#__codelineno-60-30">30</a></span>
<span class="normal"><a href="#__codelineno-60-31">31</a></span>
<span class="normal"><a href="#__codelineno-60-32">32</a></span>
<span class="normal"><a href="#__codelineno-60-33">33</a></span>
<span class="normal"><a href="#__codelineno-60-34">34</a></span>
<span class="normal"><a href="#__codelineno-60-35">35</a></span>
<span class="normal"><a href="#__codelineno-60-36">36</a></span>
<span class="normal"><a href="#__codelineno-60-37">37</a></span>
<span class="normal"><a href="#__codelineno-60-38">38</a></span>
<span class="normal"><a href="#__codelineno-60-39">39</a></span>
<span class="normal"><a href="#__codelineno-60-40">40</a></span>
<span class="normal"><a href="#__codelineno-60-41">41</a></span>
<span class="normal"><a href="#__codelineno-60-42">42</a></span>
<span class="normal"><a href="#__codelineno-60-43">43</a></span>
<span class="normal"><a href="#__codelineno-60-44">44</a></span>
<span class="normal"><a href="#__codelineno-60-45">45</a></span>
<span class="normal"><a href="#__codelineno-60-46">46</a></span>
<span class="normal"><a href="#__codelineno-60-47">47</a></span>
<span class="normal"><a href="#__codelineno-60-48">48</a></span>
<span class="normal"><a href="#__codelineno-60-49">49</a></span>
<span class="normal"><a href="#__codelineno-60-50">50</a></span>
<span class="normal"><a href="#__codelineno-60-51">51</a></span>
<span class="normal"><a href="#__codelineno-60-52">52</a></span>
<span class="normal"><a href="#__codelineno-60-53">53</a></span>
<span class="normal"><a href="#__codelineno-60-54">54</a></span>
<span class="normal"><a href="#__codelineno-60-55">55</a></span>
<span class="normal"><a href="#__codelineno-60-56">56</a></span>
<span class="normal"><a href="#__codelineno-60-57">57</a></span>
<span class="normal"><a href="#__codelineno-60-58">58</a></span>
<span class="normal"><a href="#__codelineno-60-59">59</a></span>
<span class="normal"><a href="#__codelineno-60-60">60</a></span>
<span class="normal"><a href="#__codelineno-60-61">61</a></span>
<span class="normal"><a href="#__codelineno-60-62">62</a></span>
<span class="normal"><a href="#__codelineno-60-63">63</a></span>
<span class="normal"><a href="#__codelineno-60-64">64</a></span>
<span class="normal"><a href="#__codelineno-60-65">65</a></span>
<span class="normal"><a href="#__codelineno-60-66">66</a></span>
<span class="normal"><a href="#__codelineno-60-67">67</a></span>
<span class="normal"><a href="#__codelineno-60-68">68</a></span>
<span class="normal"><a href="#__codelineno-60-69">69</a></span>
<span class="normal"><a href="#__codelineno-60-70">70</a></span>
<span class="normal"><a href="#__codelineno-60-71">71</a></span>
<span class="normal"><a href="#__codelineno-60-72">72</a></span>
<span class="normal"><a href="#__codelineno-60-73">73</a></span>
<span class="normal"><a href="#__codelineno-60-74">74</a></span>
<span class="normal"><a href="#__codelineno-60-75">75</a></span>
<span class="normal"><a href="#__codelineno-60-76">76</a></span>
<span class="normal"><a href="#__codelineno-60-77">77</a></span>
<span class="normal"><a href="#__codelineno-60-78">78</a></span>
<span class="normal"><a href="#__codelineno-60-79">79</a></span>
<span class="normal"><a href="#__codelineno-60-80">80</a></span>
<span class="normal"><a href="#__codelineno-60-81">81</a></span>
<span class="normal"><a href="#__codelineno-60-82">82</a></span>
<span class="normal"><a href="#__codelineno-60-83">83</a></span>
<span class="normal"><a href="#__codelineno-60-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="k">program</span><span class="w"> </span><span class="n">solve_ode_sys</span><span class="o">;</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2"></a>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4"></a>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5"></a><span class="k">uses</span>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span><span class="w">  </span><span class="c1">// Includes necessary types for operations with numlib.</span>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7"></a><span class="w">  </span><span class="n">ode</span><span class="o">;</span><span class="w">  </span><span class="c1">// Provides the ODE solver used in the program.</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8"></a>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9"></a><span class="k">const</span>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10"></a><span class="w">  </span><span class="n">ae</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-5</span><span class="o">;</span><span class="w">  </span><span class="c1">// Absolute error tolerance for the ODE solver.</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11"></a>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12"></a><span class="w">  </span><span class="c1">// This procedure defines the system of differential equations to solve.</span>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13"></a><span class="w">  </span><span class="c1">// It takes the independent variable 'x' and the current values 'y' and computes the derivatives 'f(x,y)'.</span>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14"></a><span class="w">  </span><span class="k">procedure</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">y</span><span class="o">,</span><span class="w"> </span><span class="n">fxy</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15"></a><span class="w">  </span><span class="k">var</span>
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16"></a><span class="w">    </span><span class="c1">// These arrays represent the system of equations.</span>
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17"></a><span class="w">    </span><span class="n">_y</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">y</span><span class="o">;</span>
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18"></a><span class="w">    </span><span class="c1">// Current y values (dependent variables).</span>
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19"></a><span class="w">    </span><span class="n">_fxy</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="k">absolute</span><span class="w"> </span><span class="n">fxy</span><span class="o">;</span><span class="w">    </span><span class="c1">// Corresponding derivatives (dy/dx).</span>
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21"></a><span class="w">    </span><span class="c1">// First equation of the system: dy1/dx = 2*x*y1 + y2</span>
</span><span id="__span-60-22"><a id="__codelineno-60-22" name="__codelineno-60-22"></a><span class="w">    </span><span class="n">_fxy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-60-23"><a id="__codelineno-60-23" name="__codelineno-60-23"></a><span class="w">    </span><span class="c1">// Second equation of the system: dy2/dx = -y1 + 2*x*y2</span>
</span><span id="__span-60-24"><a id="__codelineno-60-24" name="__codelineno-60-24"></a><span class="w">    </span><span class="n">_fxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="n">_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-60-25"><a id="__codelineno-60-25" name="__codelineno-60-25"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-60-26"><a id="__codelineno-60-26" name="__codelineno-60-26"></a>
</span><span id="__span-60-27"><a id="__codelineno-60-27" name="__codelineno-60-27"></a><span class="w">  </span><span class="c1">// This function returns the exact solution for y1 at a given 'x'.</span>
</span><span id="__span-60-28"><a id="__codelineno-60-28" name="__codelineno-60-28"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="nf">exact1</span><span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-60-29"><a id="__codelineno-60-29" name="__codelineno-60-29"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-60-30"><a id="__codelineno-60-30" name="__codelineno-60-30"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// Exact solution for y1 = exp(x^2) * sin(x)</span>
</span><span id="__span-60-31"><a id="__codelineno-60-31" name="__codelineno-60-31"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-60-32"><a id="__codelineno-60-32" name="__codelineno-60-32"></a>
</span><span id="__span-60-33"><a id="__codelineno-60-33" name="__codelineno-60-33"></a><span class="w">  </span><span class="c1">// This function returns the exact solution for y2 at a given 'x'.</span>
</span><span id="__span-60-34"><a id="__codelineno-60-34" name="__codelineno-60-34"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="nf">exact2</span><span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-60-35"><a id="__codelineno-60-35" name="__codelineno-60-35"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-60-36"><a id="__codelineno-60-36" name="__codelineno-60-36"></a><span class="w">    </span><span class="bp">Result</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">;</span><span class="w">  </span><span class="c1">// Exact solution for y2 = exp(x^2) * cos(x)</span>
</span><span id="__span-60-37"><a id="__codelineno-60-37" name="__codelineno-60-37"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-60-38"><a id="__codelineno-60-38" name="__codelineno-60-38"></a>
</span><span id="__span-60-39"><a id="__codelineno-60-39" name="__codelineno-60-39"></a><span class="k">var</span>
</span><span id="__span-60-40"><a id="__codelineno-60-40" name="__codelineno-60-40"></a><span class="w">  </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="c1">// 'a' and 'b' are the interval bounds, 'd' is the step size.</span>
</span><span id="__span-60-41"><a id="__codelineno-60-41" name="__codelineno-60-41"></a><span class="w">  </span><span class="n">ya</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w">  </span><span class="c1">// Arrays to hold y values at 'a' and 'b'.</span>
</span><span id="__span-60-42"><a id="__codelineno-60-42" name="__codelineno-60-42"></a><span class="w">  </span><span class="n">term</span><span class="o">,</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-60-43"><a id="__codelineno-60-43" name="__codelineno-60-43"></a><span class="w">  </span><span class="c1">// 'term' stores the error code, 'i' is the loop index, 'n' is the number of steps.</span>
</span><span id="__span-60-44"><a id="__codelineno-60-44" name="__codelineno-60-44"></a>
</span><span id="__span-60-45"><a id="__codelineno-60-45" name="__codelineno-60-45"></a><span class="k">begin</span>
</span><span id="__span-60-46"><a id="__codelineno-60-46" name="__codelineno-60-46"></a><span class="w">  </span><span class="c1">// Set initial values.</span>
</span><span id="__span-60-47"><a id="__codelineno-60-47" name="__codelineno-60-47"></a><span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span><span class="w">        </span><span class="c1">// Start point for x.</span>
</span><span id="__span-60-48"><a id="__codelineno-60-48" name="__codelineno-60-48"></a><span class="w">  </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.1</span><span class="o">;</span><span class="w">        </span><span class="c1">// Initial end point for x.</span>
</span><span id="__span-60-49"><a id="__codelineno-60-49" name="__codelineno-60-49"></a><span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="o">;</span><span class="w">      </span><span class="c1">// Step size (difference between 'a' and 'b').</span>
</span><span id="__span-60-50"><a id="__codelineno-60-50" name="__codelineno-60-50"></a><span class="w">  </span><span class="n">ya</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.0</span><span class="o">;</span><span class="w">    </span><span class="c1">// Initial condition for y1 (y1(0) = 0).</span>
</span><span id="__span-60-51"><a id="__codelineno-60-51" name="__codelineno-60-51"></a><span class="w">  </span><span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">1.0</span><span class="o">;</span><span class="w">    </span><span class="c1">// Initial condition for y2 (y2(0) = 1).</span>
</span><span id="__span-60-52"><a id="__codelineno-60-52" name="__codelineno-60-52"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">10</span><span class="o">;</span><span class="w">         </span><span class="c1">// Number of steps.</span>
</span><span id="__span-60-53"><a id="__codelineno-60-53" name="__codelineno-60-53"></a>
</span><span id="__span-60-54"><a id="__codelineno-60-54" name="__codelineno-60-54"></a><span class="w">  </span><span class="c1">// Print table headers for output.</span>
</span><span id="__span-60-55"><a id="__codelineno-60-55" name="__codelineno-60-55"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'x'</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'y[1]'</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'y[2]'</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'exact[1]'</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'exact[2]'</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">,</span><span class="w"> </span><span class="s">'error code'</span><span class="o">:</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-60-56"><a id="__codelineno-60-56" name="__codelineno-60-56"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="o">;</span>
</span><span id="__span-60-57"><a id="__codelineno-60-57" name="__codelineno-60-57"></a>
</span><span id="__span-60-58"><a id="__codelineno-60-58" name="__codelineno-60-58"></a><span class="w">  </span><span class="c1">// Output the initial conditions at x = 0.</span>
</span><span id="__span-60-59"><a id="__codelineno-60-59" name="__codelineno-60-59"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">exact1</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">exact2</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="s">'-'</span><span class="o">:</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-60-60"><a id="__codelineno-60-60" name="__codelineno-60-60"></a>
</span><span id="__span-60-61"><a id="__codelineno-60-61" name="__codelineno-60-61"></a><span class="w">  </span><span class="c1">// Loop through 'n' steps to solve the system over each interval.</span>
</span><span id="__span-60-62"><a id="__codelineno-60-62" name="__codelineno-60-62"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-60-63"><a id="__codelineno-60-63" name="__codelineno-60-63"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-60-64"><a id="__codelineno-60-64" name="__codelineno-60-64"></a><span class="w">    </span><span class="c1">// Call the ODE solver (odeiv2) to compute yb at x = b.</span>
</span><span id="__span-60-65"><a id="__codelineno-60-65" name="__codelineno-60-65"></a><span class="w">    </span><span class="c1">// 'f' is the function defining the system of ODEs, 'a' is the start point,</span>
</span><span id="__span-60-66"><a id="__codelineno-60-66" name="__codelineno-60-66"></a><span class="w">    </span><span class="c1">// 'ya[1]' are the initial y-values, 'b' is the end point,</span>
</span><span id="__span-60-67"><a id="__codelineno-60-67" name="__codelineno-60-67"></a><span class="w">    </span><span class="c1">// 'yb[1]' will store the computed y-values at 'b',</span>
</span><span id="__span-60-68"><a id="__codelineno-60-68" name="__codelineno-60-68"></a><span class="w">    </span><span class="c1">// '2' indicates the system size (two equations), 'ae' is the accuracy, and 'term' stores the error code.</span>
</span><span id="__span-60-69"><a id="__codelineno-60-69" name="__codelineno-60-69"></a><span class="hll"><span class="w">    </span><span class="n">odeiv2</span><span class="p">(</span><span class="o">@</span><span class="n">f</span><span class="o">,</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">ya</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="n">ae</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-60-70"><a id="__codelineno-60-70" name="__codelineno-60-70"></a>
</span><span id="__span-60-71"><a id="__codelineno-60-71" name="__codelineno-60-71"></a><span class="w">    </span><span class="c1">// Output the results at each step: x = b, y1(b), y2(b), exact solutions, and error code.</span>
</span><span id="__span-60-72"><a id="__codelineno-60-72" name="__codelineno-60-72"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">yb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">exact1</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">exact2</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-60-73"><a id="__codelineno-60-73" name="__codelineno-60-73"></a>
</span><span id="__span-60-74"><a id="__codelineno-60-74" name="__codelineno-60-74"></a><span class="w">    </span><span class="c1">// Update the values for the next iteration.</span>
</span><span id="__span-60-75"><a id="__codelineno-60-75" name="__codelineno-60-75"></a><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="o">;</span><span class="w">         </span><span class="c1">// Move to the next interval starting from the current 'b'.</span>
</span><span id="__span-60-76"><a id="__codelineno-60-76" name="__codelineno-60-76"></a><span class="w">    </span><span class="n">ya</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">yb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">;</span><span class="w"> </span><span class="c1">// Set ya to the computed yb for the next step.</span>
</span><span id="__span-60-77"><a id="__codelineno-60-77" name="__codelineno-60-77"></a><span class="w">    </span><span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">yb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">;</span>
</span><span id="__span-60-78"><a id="__codelineno-60-78" name="__codelineno-60-78"></a><span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="o">;</span><span class="w">     </span><span class="c1">// Increment 'b' by the step size 'd'.</span>
</span><span id="__span-60-79"><a id="__codelineno-60-79" name="__codelineno-60-79"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-60-80"><a id="__codelineno-60-80" name="__codelineno-60-80"></a>
</span><span id="__span-60-81"><a id="__codelineno-60-81" name="__codelineno-60-81"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-60-82"><a id="__codelineno-60-82" name="__codelineno-60-82"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-60-83"><a id="__codelineno-60-83" name="__codelineno-60-83"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-60-84"><a id="__codelineno-60-84" name="__codelineno-60-84"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>           x        y[1]        y[2]    exact[1]    exact[2]       error code
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>     0.00000     0.00000     1.00000     0.00000     1.00000                -
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>     0.10000     0.10084     1.00500     0.10084     1.00500                1
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>     0.20000     0.20678     1.02006     0.20678     1.02006                1
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>     0.30000     0.32335     1.04530     0.32335     1.04530                1
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>     0.40000     0.45699     1.08088     0.45699     1.08088                1
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>     0.50000     0.61559     1.12684     0.61559     1.12684                1
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>     0.60000     0.80932     1.18298     0.80932     1.18298                1
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>     0.70000     1.05157     1.24846     1.05157     1.24846                1
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>     0.80000     1.36045     1.32129     1.36045     1.32129                1
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>     0.90000     1.76085     1.39732     1.76085     1.39732                1
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>     1.00000     2.28736     1.46869     2.28736     1.46869                1
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>Press enter to quit
</span></code></pre></div>
<h2 id="unit-ipf-interpolation-and-fitting">Unit <code>ipf</code> - Interpolation and fitting<a class="headerlink" href="#unit-ipf-interpolation-and-fitting" title="Permanent link">¶</a></h2>
<p>The unit <code>ipf</code> contains routines for:</p>
<ul>
<li><strong>Fitting</strong> a set of data points with a polynomial.</li>
<li><strong>Interpolating or fitting</strong> a set of data points with a natural cubic spline. A spline is a piecewise function of polynomials with a high degree of smoothness at the connection points (called "knots"). In the case of a natural cubic spline, the polynomials are of degree 3, and their second derivatives are zero at the first and last knots.</li>
</ul>
<p><strong>Definitions</strong></p>
<ul>
<li><strong>Fitting</strong>: Finding an approximating smooth function such that deviations from the data points are minimized.</li>
<li><strong>Interpolation</strong>: Determining a function that passes exactly through the data points.</li>
</ul>
<p><strong>Use of Polynomials or Splines</strong></p>
<p>Polynomials or splines are recommended unless the data follows a known function but with some unknown parameters. For example, if the data is modeled by the function   <span class="arithmatex">\( f(x) = a + b e^{-c x} \)</span>, fitting to that form may be better.</p>
<p>If the data contains <strong>measurement errors</strong>, fitting with a low-degree polynomial (e.g., degree ≤ 5) is usually a good first approach. If the data’s shape is complex, consider fitting with a spline. </p>
<p>If the data has <strong>no measurement noise</strong>, it’s often best to interpolate using a spline.</p>
<h3 id="fitting-with-a-polynomial">Fitting with a Polynomial<a class="headerlink" href="#fitting-with-a-polynomial" title="Permanent link">¶</a></h3>
<p>You can fit a polynomial to your data using the <code>ipfpol</code> routine. This routine takes a set of data points <span class="arithmatex">\((x_i, y_i)\)</span> and calculates a polynomial of the form:</p>
<div class="arithmatex">\[ p(x) = b_0 + b_1 x + \dots + b_n x^n \]</div>
<p>The coefficients <span class="arithmatex">\( b_0, \dots, b_n \)</span> are adjusted to minimize the sum of squared deviations from the data points, using the least squares fitting method:</p>
<div class="arithmatex">\[ \sum_{i=1}^m (p(x_i) - y_i)^2 \]</div>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">ipfpol</span><span class="p">(</span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>m</code>: Number of data points (must be <span class="arithmatex">\( m \geq 1 \)</span>).</li>
<li><code>n</code>: Degree of the polynomial (must be <span class="arithmatex">\( n &gt; 0 \)</span>).</li>
<li><code>x</code>: Array containing the <span class="arithmatex">\( x \)</span>-values of the data points.</li>
<li><code>y</code>: Array containing the <span class="arithmatex">\( y \)</span>-values of the data points.</li>
<li><code>b</code>: Array to store the calculated polynomial coefficients.</li>
<li><code>term</code>: Error code.</li>
<li><code>1</code>: Success.</li>
<li><code>3</code>: Input error (e.g., <span class="arithmatex">\( n &lt; 0 \)</span> or <span class="arithmatex">\( m &lt; 1 \)</span>).</li>
</ul>
<p>Once the coefficients are determined, you can calculate the value of <span class="arithmatex">\( p(x) \)</span> using the <code>spepol</code> procedure from the <code>spe</code> unit.</p>
<p><strong>Example: Fitting a Degree 2 Polynomial</strong></p>
<p>Fit a polynomial of degree 2 to these data points:</p>
<div class="arithmatex">\[
\displaystyle{ 
  \begin{array}{ccc}
    \hline
    i &amp; x_i &amp; y_i \\
    \hline
    1 &amp; 0.00 &amp; 1.26 \\
    2 &amp; 0.08 &amp; 1.37 \\
    3 &amp; 0.22 &amp; 1.72 \\
    4 &amp; 0.33 &amp; 2.08 \\
    5 &amp; 0.46 &amp; 2.31 \\
    6 &amp; 0.52 &amp; 2.64 \\
    7 &amp; 0.67 &amp; 3.12 \\
    8 &amp; 0.81 &amp; 3.48
  \end{array}
 }
 \]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-63-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-63-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-63-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-63-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-63-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-63-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-63-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-63-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-63-10">10</a></span>
<span class="normal"><a href="#__codelineno-63-11">11</a></span>
<span class="normal"><a href="#__codelineno-63-12">12</a></span>
<span class="normal"><a href="#__codelineno-63-13">13</a></span>
<span class="normal"><a href="#__codelineno-63-14">14</a></span>
<span class="normal"><a href="#__codelineno-63-15">15</a></span>
<span class="normal"><a href="#__codelineno-63-16">16</a></span>
<span class="normal"><a href="#__codelineno-63-17">17</a></span>
<span class="normal"><a href="#__codelineno-63-18">18</a></span>
<span class="normal"><a href="#__codelineno-63-19">19</a></span>
<span class="normal"><a href="#__codelineno-63-20">20</a></span>
<span class="normal"><a href="#__codelineno-63-21">21</a></span>
<span class="normal"><a href="#__codelineno-63-22">22</a></span>
<span class="normal"><a href="#__codelineno-63-23">23</a></span>
<span class="normal"><a href="#__codelineno-63-24">24</a></span>
<span class="normal"><a href="#__codelineno-63-25">25</a></span>
<span class="normal"><a href="#__codelineno-63-26">26</a></span>
<span class="normal"><a href="#__codelineno-63-27">27</a></span>
<span class="normal"><a href="#__codelineno-63-28">28</a></span>
<span class="normal"><a href="#__codelineno-63-29">29</a></span>
<span class="normal"><a href="#__codelineno-63-30">30</a></span>
<span class="normal"><a href="#__codelineno-63-31">31</a></span>
<span class="normal"><a href="#__codelineno-63-32">32</a></span>
<span class="normal"><a href="#__codelineno-63-33">33</a></span>
<span class="normal"><a href="#__codelineno-63-34">34</a></span>
<span class="normal"><a href="#__codelineno-63-35">35</a></span>
<span class="normal"><a href="#__codelineno-63-36">36</a></span>
<span class="normal"><a href="#__codelineno-63-37">37</a></span>
<span class="normal"><a href="#__codelineno-63-38">38</a></span>
<span class="normal"><a href="#__codelineno-63-39">39</a></span>
<span class="normal"><a href="#__codelineno-63-40">40</a></span>
<span class="normal"><a href="#__codelineno-63-41">41</a></span>
<span class="normal"><a href="#__codelineno-63-42">42</a></span>
<span class="normal"><a href="#__codelineno-63-43">43</a></span>
<span class="normal"><a href="#__codelineno-63-44">44</a></span>
<span class="normal"><a href="#__codelineno-63-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="k">program</span><span class="w"> </span><span class="n">polynomial_fit</span><span class="o">;</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2"></a>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4"></a>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5"></a><span class="k">uses</span>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6"></a><span class="w">  </span><span class="n">SysUtils</span><span class="o">,</span><span class="w"> </span><span class="n">typ</span><span class="o">,</span><span class="w"> </span><span class="n">ipf</span><span class="o">,</span><span class="w"> </span><span class="n">spe</span><span class="o">;</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7"></a>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8"></a><span class="k">const</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9"></a><span class="w">  </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="o">;</span><span class="w">  </span><span class="c1">// Number of data points</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">;</span><span class="w">  </span><span class="c1">// Polynomial degree</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11"></a>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12"></a><span class="k">var</span>
</span><span id="__span-63-13"><a id="__codelineno-63-13" name="__codelineno-63-13"></a><span class="w">  </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">m</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">,</span><span class="w"> </span><span class="mf">0.08</span><span class="o">,</span><span class="w"> </span><span class="mf">0.22</span><span class="o">,</span><span class="w"> </span><span class="mf">0.33</span><span class="o">,</span><span class="w"> </span><span class="mf">0.46</span><span class="o">,</span><span class="w"> </span><span class="mf">0.52</span><span class="o">,</span><span class="w"> </span><span class="mf">0.67</span><span class="o">,</span><span class="w"> </span><span class="mf">0.81</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-14"><a id="__codelineno-63-14" name="__codelineno-63-14"></a><span class="w">  </span><span class="n">y</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">m</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.26</span><span class="o">,</span><span class="w"> </span><span class="mf">1.37</span><span class="o">,</span><span class="w"> </span><span class="mf">1.72</span><span class="o">,</span><span class="w"> </span><span class="mf">2.08</span><span class="o">,</span><span class="w"> </span><span class="mf">2.31</span><span class="o">,</span><span class="w"> </span><span class="mf">2.64</span><span class="o">,</span><span class="w"> </span><span class="mf">3.12</span><span class="o">,</span><span class="w"> </span><span class="mf">3.48</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-15"><a id="__codelineno-63-15" name="__codelineno-63-15"></a><span class="w">  </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-63-16"><a id="__codelineno-63-16" name="__codelineno-63-16"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">Integer</span><span class="o">;</span>
</span><span id="__span-63-17"><a id="__codelineno-63-17" name="__codelineno-63-17"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-63-18"><a id="__codelineno-63-18" name="__codelineno-63-18"></a><span class="w">  </span><span class="n">xint</span><span class="o">,</span><span class="w"> </span><span class="n">yint</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-63-19"><a id="__codelineno-63-19" name="__codelineno-63-19"></a><span class="k">begin</span>
</span><span id="__span-63-20"><a id="__codelineno-63-20" name="__codelineno-63-20"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Fitting a polynomial of degree 2: p(x) = b[0] + b[1] x + b[2] x^2'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-21"><a id="__codelineno-63-21" name="__codelineno-63-21"></a>
</span><span id="__span-63-22"><a id="__codelineno-63-22" name="__codelineno-63-22"></a><span class="w">  </span><span class="c1">// Print data points</span>
</span><span id="__span-63-23"><a id="__codelineno-63-23" name="__codelineno-63-23"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Data points'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-24"><a id="__codelineno-63-24" name="__codelineno-63-24"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'i'</span><span class="o">:</span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="s">'x_i'</span><span class="o">:</span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="s">'y_i'</span><span class="o">:</span><span class="mi">10</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-25"><a id="__codelineno-63-25" name="__codelineno-63-25"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-63-26"><a id="__codelineno-63-26" name="__codelineno-63-26"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">i</span><span class="o">:</span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">2</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-27"><a id="__codelineno-63-27" name="__codelineno-63-27"></a>
</span><span id="__span-63-28"><a id="__codelineno-63-28" name="__codelineno-63-28"></a><span class="w">  </span><span class="c1">// Fit polynomial</span>
</span><span id="__span-63-29"><a id="__codelineno-63-29" name="__codelineno-63-29"></a><span class="hll"><span class="w">  </span><span class="n">ipfpol</span><span class="p">(</span><span class="n">m</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-63-30"><a id="__codelineno-63-30" name="__codelineno-63-30"></a>
</span><span id="__span-63-31"><a id="__codelineno-63-31" name="__codelineno-63-31"></a><span class="w">  </span><span class="c1">// Display coefficients</span>
</span><span id="__span-63-32"><a id="__codelineno-63-32" name="__codelineno-63-32"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Fitted coefficients b = '</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">6</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">6</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-33"><a id="__codelineno-63-33" name="__codelineno-63-33"></a>
</span><span id="__span-63-34"><a id="__codelineno-63-34" name="__codelineno-63-34"></a><span class="w">  </span><span class="c1">// Interpolation</span>
</span><span id="__span-63-35"><a id="__codelineno-63-35" name="__codelineno-63-35"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Interpolated values:'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-36"><a id="__codelineno-63-36" name="__codelineno-63-36"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-63-37"><a id="__codelineno-63-37" name="__codelineno-63-37"></a><span class="w">    </span><span class="n">xint</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="o">;</span>
</span><span id="__span-63-38"><a id="__codelineno-63-38" name="__codelineno-63-38"></a><span class="w">    </span><span class="n">yint</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">spepol</span><span class="p">(</span><span class="n">xint</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-39"><a id="__codelineno-63-39" name="__codelineno-63-39"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">xint</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="n">yint</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span><span class="mi">2</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-40"><a id="__codelineno-63-40" name="__codelineno-63-40"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-63-41"><a id="__codelineno-63-41" name="__codelineno-63-41"></a>
</span><span id="__span-63-42"><a id="__codelineno-63-42" name="__codelineno-63-42"></a><span class="w">  </span><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-63-43"><a id="__codelineno-63-43" name="__codelineno-63-43"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-63-44"><a id="__codelineno-63-44" name="__codelineno-63-44"></a><span class="w">  </span><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-63-45"><a id="__codelineno-63-45" name="__codelineno-63-45"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>Fitting a polynomial of degree 2: p(x) = b[0] + b[1] x + b[2] x^2
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>Data points
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>         i       x_i       y_i
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>         1      0.00      1.26
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>         2      0.08      1.37
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>         3      0.22      1.72
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>         4      0.33      2.08
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>         5      0.46      2.31
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>         6      0.52      2.64
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>         7      0.67      3.12
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>         8      0.81      3.48
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a>Fitted coefficients b =   1.222195  2.224385  0.759178
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a>Interpolated values:
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>      0.20      1.70
</span><span id="__span-64-15"><a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a>      0.40      2.23
</span><span id="__span-64-16"><a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a>      0.60      2.83
</span><span id="__span-64-17"><a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a>      0.80      3.49
</span><span id="__span-64-18"><a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a>      1.00      4.21
</span><span id="__span-64-19"><a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a>Press enter to quit
</span></code></pre></div>
<h3 id="interpolation-with-a-natural-cubic-spline">Interpolation with a Natural Cubic Spline<a class="headerlink" href="#interpolation-with-a-natural-cubic-spline" title="Permanent link">¶</a></h3>
<p>To interpolate data with a cubic spline, use the <code>ipfisn</code> routine. This calculates the spline’s second derivatives. Once these are known, you can calculate the spline value at any point using the <code>ipfspn</code> procedure.</p>
<div class="language-pascal highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="k">procedure</span><span class="w"> </span><span class="nf">ipfisn</span><span class="p">(</span><span class="n">n</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="o">,</span><span class="w"> </span><span class="n">d2s</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="p">)</span><span class="o">;</span>
</span></code></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><code>n</code>: Number of data points minus one.</li>
<li><code>x</code>, <code>y</code>: Arrays containing the data points' <span class="arithmatex">\( x \)</span>- and <span class="arithmatex">\( y \)</span>-values.</li>
<li><code>d2s</code>: Array to store the second derivatives at each point (except at the endpoints, where it's set to 0).</li>
<li><code>term</code>: Error code.</li>
<li><code>1</code>: Success.</li>
<li><code>2</code>: Error in calculating second derivatives.</li>
<li><code>3</code>: Invalid input parameters (e.g., <span class="arithmatex">\( n \leq 1 \)</span>).</li>
</ul>
<p>Once the second derivatives are determined, you can use <code>ipfspn</code> to evaluate the spline at any point.</p>
<p><strong>Example: Natural Cubic Spline Interpolation</strong></p>
<p>Interpolate a natural cubic spline through the following data points:</p>
<div class="arithmatex">\[
\displaystyle{ 
  \begin{array}{ccc}
    \hline
    i &amp; x_i &amp; y_i \\
    \hline
    0 &amp; 0.00 &amp; 0.980 \\
    1 &amp; 0.09 &amp; 0.927 \\
    2 &amp; 0.22 &amp; 0.732 \\
    3 &amp; 0.34 &amp; 0.542 \\
    4 &amp; 0.47 &amp; 0.385 \\
    5 &amp; 0.58 &amp; 0.292 \\
    6 &amp; 0.65 &amp; 0.248 \\
    7 &amp; 0.80 &amp; 0.179 \\
    8 &amp; 0.93 &amp; 0.139
  \end{array}
 }
\]</div>
<div class="language-pascal highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-66-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-66-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-66-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-66-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-66-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-66-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-66-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-66-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-66-10">10</a></span>
<span class="normal"><a href="#__codelineno-66-11">11</a></span>
<span class="normal"><a href="#__codelineno-66-12">12</a></span>
<span class="normal"><a href="#__codelineno-66-13">13</a></span>
<span class="normal"><a href="#__codelineno-66-14">14</a></span>
<span class="normal"><a href="#__codelineno-66-15">15</a></span>
<span class="normal"><a href="#__codelineno-66-16">16</a></span>
<span class="normal"><a href="#__codelineno-66-17">17</a></span>
<span class="normal"><a href="#__codelineno-66-18">18</a></span>
<span class="normal"><a href="#__codelineno-66-19">19</a></span>
<span class="normal"><a href="#__codelineno-66-20">20</a></span>
<span class="normal"><a href="#__codelineno-66-21">21</a></span>
<span class="normal"><a href="#__codelineno-66-22">22</a></span>
<span class="normal"><a href="#__codelineno-66-23">23</a></span>
<span class="normal"><a href="#__codelineno-66-24">24</a></span>
<span class="normal"><a href="#__codelineno-66-25">25</a></span>
<span class="normal"><a href="#__codelineno-66-26">26</a></span>
<span class="normal"><a href="#__codelineno-66-27">27</a></span>
<span class="normal"><a href="#__codelineno-66-28">28</a></span>
<span class="normal"><a href="#__codelineno-66-29">29</a></span>
<span class="normal"><a href="#__codelineno-66-30">30</a></span>
<span class="normal"><a href="#__codelineno-66-31">31</a></span>
<span class="normal"><a href="#__codelineno-66-32">32</a></span>
<span class="normal"><a href="#__codelineno-66-33">33</a></span>
<span class="normal"><a href="#__codelineno-66-34">34</a></span>
<span class="normal"><a href="#__codelineno-66-35">35</a></span>
<span class="normal"><a href="#__codelineno-66-36">36</a></span>
<span class="normal"><a href="#__codelineno-66-37">37</a></span>
<span class="normal"><a href="#__codelineno-66-38">38</a></span>
<span class="normal"><a href="#__codelineno-66-39">39</a></span>
<span class="normal"><a href="#__codelineno-66-40">40</a></span>
<span class="normal"><a href="#__codelineno-66-41">41</a></span>
<span class="normal"><a href="#__codelineno-66-42">42</a></span>
<span class="normal"><a href="#__codelineno-66-43">43</a></span>
<span class="normal"><a href="#__codelineno-66-44">44</a></span>
<span class="normal"><a href="#__codelineno-66-45">45</a></span>
<span class="normal"><a href="#__codelineno-66-46">46</a></span>
<span class="normal"><a href="#__codelineno-66-47">47</a></span>
<span class="normal"><a href="#__codelineno-66-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="k">program</span><span class="w"> </span><span class="n">spline_interpolation</span><span class="o">;</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2"></a>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="cm">{$mode objfpc}{$H+}{$J-}</span>
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4"></a>
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5"></a><span class="k">uses</span>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6"></a><span class="w">  </span><span class="n">typ</span><span class="o">,</span>
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7"></a><span class="w">  </span><span class="n">ipf</span><span class="o">;</span>
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8"></a>
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9"></a><span class="k">const</span>
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10"></a><span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="o">;</span>
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11"></a>
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12"></a><span class="k">var</span>
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13"></a><span class="w">  </span><span class="n">x</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">,</span><span class="w"> </span><span class="mf">0.09</span><span class="o">,</span><span class="w"> </span><span class="mf">0.22</span><span class="o">,</span><span class="w"> </span><span class="mf">0.34</span><span class="o">,</span><span class="w"> </span><span class="mf">0.47</span><span class="o">,</span><span class="w"> </span><span class="mf">0.58</span><span class="o">,</span><span class="w"> </span><span class="mf">0.65</span><span class="o">,</span><span class="w"> </span><span class="mf">0.80</span><span class="o">,</span><span class="w"> </span><span class="mf">0.93</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14"></a><span class="w">  </span><span class="n">y</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">0.990</span><span class="o">,</span><span class="w"> </span><span class="mf">0.927</span><span class="o">,</span><span class="w"> </span><span class="mf">0.734</span><span class="o">,</span><span class="w"> </span><span class="mf">0.542</span><span class="o">,</span><span class="w"> </span><span class="mf">0.388</span><span class="o">,</span><span class="w"> </span><span class="mf">0.292</span><span class="o">,</span><span class="w"> </span><span class="mf">0.248</span><span class="o">,</span><span class="w"> </span><span class="mf">0.179</span><span class="o">,</span><span class="w"> </span><span class="mf">0.139</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-15"><a id="__codelineno-66-15" name="__codelineno-66-15"></a><span class="w">  </span><span class="n">d2s</span><span class="o">:</span><span class="w"> </span><span class="k">array</span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-66-16"><a id="__codelineno-66-16" name="__codelineno-66-16"></a><span class="w">  </span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="kt">integer</span><span class="o">;</span>
</span><span id="__span-66-17"><a id="__codelineno-66-17" name="__codelineno-66-17"></a><span class="w">  </span><span class="n">term</span><span class="o">:</span><span class="w"> </span><span class="n">ArbInt</span><span class="o">;</span>
</span><span id="__span-66-18"><a id="__codelineno-66-18" name="__codelineno-66-18"></a><span class="w">  </span><span class="n">xint</span><span class="o">,</span><span class="w"> </span><span class="n">yint</span><span class="o">:</span><span class="w"> </span><span class="n">ArbFloat</span><span class="o">;</span>
</span><span id="__span-66-19"><a id="__codelineno-66-19" name="__codelineno-66-19"></a><span class="k">begin</span>
</span><span id="__span-66-20"><a id="__codelineno-66-20" name="__codelineno-66-20"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Cubic spline interpolation'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-21"><a id="__codelineno-66-21" name="__codelineno-66-21"></a>
</span><span id="__span-66-22"><a id="__codelineno-66-22" name="__codelineno-66-22"></a><span class="w">  </span><span class="c1">// Print data points</span>
</span><span id="__span-66-23"><a id="__codelineno-66-23" name="__codelineno-66-23"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Data points'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-24"><a id="__codelineno-66-24" name="__codelineno-66-24"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'i'</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="s">'x_i'</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="s">'y_i'</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-25"><a id="__codelineno-66-25" name="__codelineno-66-25"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-66-26"><a id="__codelineno-66-26" name="__codelineno-66-26"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">i</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-27"><a id="__codelineno-66-27" name="__codelineno-66-27"></a>
</span><span id="__span-66-28"><a id="__codelineno-66-28" name="__codelineno-66-28"></a><span class="w">  </span><span class="c1">// Calculate spline parameters</span>
</span><span id="__span-66-29"><a id="__codelineno-66-29" name="__codelineno-66-29"></a><span class="hll"><span class="w">  </span><span class="n">ipfisn</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">d2s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span></span><span id="__span-66-30"><a id="__codelineno-66-30" name="__codelineno-66-30"></a>
</span><span id="__span-66-31"><a id="__codelineno-66-31" name="__codelineno-66-31"></a><span class="w">  </span><span class="c1">// Display second derivatives</span>
</span><span id="__span-66-32"><a id="__codelineno-66-32" name="__codelineno-66-32"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Second derivatives'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-33"><a id="__codelineno-66-33" name="__codelineno-66-33"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-66-34"><a id="__codelineno-66-34" name="__codelineno-66-34"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">d2s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-35"><a id="__codelineno-66-35" name="__codelineno-66-35"></a>
</span><span id="__span-66-36"><a id="__codelineno-66-36" name="__codelineno-66-36"></a><span class="w">  </span><span class="c1">// Interpolation</span>
</span><span id="__span-66-37"><a id="__codelineno-66-37" name="__codelineno-66-37"></a><span class="w">  </span><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Interpolated values'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-38"><a id="__codelineno-66-38" name="__codelineno-66-38"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-66-39"><a id="__codelineno-66-39" name="__codelineno-66-39"></a><span class="w">  </span><span class="k">begin</span>
</span><span id="__span-66-40"><a id="__codelineno-66-40" name="__codelineno-66-40"></a><span class="w">    </span><span class="n">xint</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mf">0.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="o">;</span>
</span><span id="__span-66-41"><a id="__codelineno-66-41" name="__codelineno-66-41"></a><span class="w">    </span><span class="n">yint</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">ipfspn</span><span class="p">(</span><span class="n">n</span><span class="o">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">d2s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="w"> </span><span class="n">xint</span><span class="o">,</span><span class="w"> </span><span class="n">term</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-42"><a id="__codelineno-66-42" name="__codelineno-66-42"></a><span class="w">    </span><span class="nb">WriteLn</span><span class="p">(</span><span class="n">xint</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="n">yint</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-43"><a id="__codelineno-66-43" name="__codelineno-66-43"></a><span class="w">  </span><span class="k">end</span><span class="o">;</span>
</span><span id="__span-66-44"><a id="__codelineno-66-44" name="__codelineno-66-44"></a>
</span><span id="__span-66-45"><a id="__codelineno-66-45" name="__codelineno-66-45"></a><span class="c1">// Pause to allow user to see results before exiting the program</span>
</span><span id="__span-66-46"><a id="__codelineno-66-46" name="__codelineno-66-46"></a><span class="nb">WriteLn</span><span class="p">(</span><span class="s">'Press enter to quit'</span><span class="p">)</span><span class="o">;</span>
</span><span id="__span-66-47"><a id="__codelineno-66-47" name="__codelineno-66-47"></a><span class="nb">ReadLn</span><span class="o">;</span>
</span><span id="__span-66-48"><a id="__codelineno-66-48" name="__codelineno-66-48"></a><span class="k">end</span><span class="o">.</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p><strong>Output</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>Cubic spline interpolation
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>Data points
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>         i       x_i       y_i
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>         0      0.00     0.990
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>         1      0.09     0.927
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a>         2      0.22     0.734
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>         3      0.34     0.542
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a>         4      0.47     0.388
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a>         5      0.58     0.292
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a>         6      0.65     0.248
</span><span id="__span-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a>         7      0.80     0.179
</span><span id="__span-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a>         8      0.93     0.139
</span><span id="__span-67-13"><a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a>Second derivatives
</span><span id="__span-67-14"><a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a>-10.810021
</span><span id="__span-67-15"><a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a>  0.374744
</span><span id="__span-67-16"><a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a>  4.380190
</span><span id="__span-67-17"><a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a>  1.978794
</span><span id="__span-67-18"><a id="__codelineno-67-18" name="__codelineno-67-18" href="#__codelineno-67-18"></a>  3.200753
</span><span id="__span-67-19"><a id="__codelineno-67-19" name="__codelineno-67-19" href="#__codelineno-67-19"></a>  1.357095
</span><span id="__span-67-20"><a id="__codelineno-67-20" name="__codelineno-67-20" href="#__codelineno-67-20"></a>  1.268361
</span><span id="__span-67-21"><a id="__codelineno-67-21" name="__codelineno-67-21" href="#__codelineno-67-21"></a>Interpolated values
</span><span id="__span-67-22"><a id="__codelineno-67-22" name="__codelineno-67-22" href="#__codelineno-67-22"></a>      0.20      0.77
</span><span id="__span-67-23"><a id="__codelineno-67-23" name="__codelineno-67-23" href="#__codelineno-67-23"></a>      0.40      0.46
</span><span id="__span-67-24"><a id="__codelineno-67-24" name="__codelineno-67-24" href="#__codelineno-67-24"></a>      0.60      0.28
</span><span id="__span-67-25"><a id="__codelineno-67-25" name="__codelineno-67-25" href="#__codelineno-67-25"></a>      0.80      0.18
</span><span id="__span-67-26"><a id="__codelineno-67-26" name="__codelineno-67-26" href="#__codelineno-67-26"></a>      1.00      0.12
</span><span id="__span-67-27"><a id="__codelineno-67-27" name="__codelineno-67-27" href="#__codelineno-67-27"></a>Press enter to quit
</span></code></pre></div>
<h2 id="unit-spe-special-functions">Unit <code>spe</code> - Special functions<a class="headerlink" href="#unit-spe-special-functions" title="Permanent link">¶</a></h2>
<p>Coming soon.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.path", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../js/open_in_new_tab.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>